This file is a merged representation of the entire codebase, combined into a single document by Repomix.

# File Summary

## Purpose
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

## File Format
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  a. A header with the file path (## File: path/to/file)
  b. The full contents of the file in a code block

## Usage Guidelines
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.

## Notes
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)

# Directory Structure
```
.gitignore
CHANGELOG.md
eslint.config.mjs
lib/supabase.ts
LICENSE
next.config.ts
package.json
postcss.config.mjs
public/.nojekyll
public/file.svg
public/globe.svg
public/next.svg
public/vercel.svg
public/window.svg
README.md
src/app/admin/calendar/_components/CalendarSidebarWrapper.tsx
src/app/admin/calendar/layout.tsx
src/app/admin/calendar/page.tsx
src/app/admin/grid/page.tsx
src/app/admin/layout.tsx
src/app/admin/page.tsx
src/app/admin/projects/[id]/page.tsx
src/app/admin/projects/new/page.tsx
src/app/admin/projects/page.tsx
src/app/admin/settings/page.tsx
src/app/admin/staff/page.tsx
src/app/ca-nhan/page.tsx
src/app/dich-vu/page.tsx
src/app/du-an/[slug]/page.tsx
src/app/du-an/[slug]/ProjectClientPage.tsx
src/app/error.tsx
src/app/favicon.ico
src/app/gioi-thieu/page.tsx
src/app/globals.css
src/app/layout.tsx
src/app/loading.tsx
src/app/login/page.tsx
src/app/not-found.tsx
src/app/page.tsx
src/app/providers.tsx
src/app/styles/BtsSection.module.css
src/app/styles/DichVu.module.css
src/app/styles/ProjectArticle.module.css
src/app/thoi-trang/page.tsx
src/app/thuong-mai/page.tsx
src/assets/about/about.webp
src/assets/about/avatar.webp
src/assets/about/carousel_01_2020.webp
src/assets/about/carousel_02_2022.webp
src/assets/about/carousel_03_2024.webp
src/assets/about/carousel_04_2025.webp
src/assets/project/ca-nhan/Personal_01_thumnails.webp
src/assets/project/ca-nhan/Personal_02_02.webp
src/assets/project/ca-nhan/Personal_02_03.webp
src/assets/project/ca-nhan/Personal_02_04.webp
src/assets/project/ca-nhan/Personal_02_05.webp
src/assets/project/ca-nhan/Personal_02_06.webp
src/assets/project/ca-nhan/Personal_02_07.webp
src/assets/project/ca-nhan/Personal_02_08.webp
src/assets/project/ca-nhan/Personal_02_09.webp
src/assets/project/ca-nhan/Personal_02_thumnails.webp
src/assets/project/thoi-trang/Fashion_01_thumnails.webp
src/assets/project/thoi-trang/Fashion_02_thumnails.webp
src/assets/project/thoi-trang/Fashion_03_thumnails.webp
src/assets/project/thuong-mai/Commercial_01_thumnails.webp
src/assets/project/thuong-mai/Commercial_02_01.webp
src/assets/project/thuong-mai/Commercial_02_02.webp
src/assets/project/thuong-mai/Commercial_02_03.webp
src/assets/project/thuong-mai/Commercial_02_thumnails.webp
src/assets/section_01/hero-background.webp
src/assets/section_04/bts_01.jpg
src/assets/section_04/bts_02.jpg
src/assets/section_04/bts_03.jpg
src/assets/section_04/bts_04.jpg
src/assets/section_04/bts_05.jpg
src/assets/section_04/bts_06.jpg
src/assets/service/section_01/room_A.webp
src/assets/service/section_01/room_B.webp
src/assets/service/section_01/room_C.webp
src/assets/service/section_01/room_D.webp
src/assets/service/section_02/aputure-amaran-300c.webp
src/assets/service/section_02/devices.webp
src/assets/service/section_02/GODOX-DP600III-V.webp
src/assets/service/section_02/GODOX-GD-DP400II-V.webp
src/assets/service/section_02/GODOX-QR-P120.webp
src/assets/service/section_02/GODOX-QR-P150T.webp
src/assets/service/section_02/GODOX-QR-P60T.webp
src/assets/service/section_02/GODOX-QR-P90.webp
src/assets/service/section_02/GODOX-QS-1200.webp
src/assets/service/section_02/GODOX-QS-400.webp
src/assets/service/section_02/GODOX-QS-800.webp
src/assets/service/section_02/GODOX-QT400IIIM.webp
src/assets/service/section_02/GODOX-QT600II.webp
src/components/AboutMilestonesSection.tsx
src/components/AboutPhilosophySection.tsx
src/components/admin/calendar/BookingCalendar.tsx
src/components/admin/calendar/BookingCreateModal.tsx
src/components/admin/calendar/BookingDetailModal.tsx
src/components/admin/calendar/CalendarSidebar.tsx
src/components/admin/calendar/CustomToolbar.tsx
src/components/admin/calendar/NavCalendarWidget.tsx
src/components/admin/CreateStaffModal.tsx
src/components/admin/DashboardActions.tsx
src/components/admin/DashboardCalendar.tsx
src/components/admin/DashboardFilter.tsx
src/components/admin/DeleteProjectButton.tsx
src/components/admin/GrowthChart.tsx
src/components/admin/PortfolioGridEditor.tsx
src/components/admin/ProjectForm.tsx
src/components/admin/ProjectTable.tsx
src/components/admin/SettingsForm.tsx
src/components/admin/SortableProjectItem.tsx
src/components/admin/StaffPageHeader.tsx
src/components/admin/StaffTable.tsx
src/components/admin/TodaySchedule.tsx
src/components/AnimatedProfileImage.tsx
src/components/BrandScroller.tsx
src/components/BtsSection.tsx
src/components/ContactSection.tsx
src/components/Container.tsx
src/components/Footer.tsx
src/components/Header.tsx
src/components/HeroSection.tsx
src/components/HomePageContent.tsx
src/components/LayoutWrapper.tsx
src/components/PhilosophyBackground.tsx
src/components/PortfolioSection.tsx
src/components/progressive-carousel.tsx
src/components/project-grid.tsx
src/components/ProjectMasonryGrid.tsx
src/components/ProjectNavigation.tsx
src/components/ProjectShowcase.tsx
src/components/scroll-text-marque.tsx
src/components/ScrollingText.tsx
src/components/ScrollToTopButton.tsx
src/components/Spinner.tsx
src/components/ThemeToggle.tsx
src/components/ui/ConfirmModal.tsx
src/components/ui/ModalPortal.tsx
src/components/ui/SelectBox.tsx
src/context/CalendarContext.tsx
src/data/bts.ts
src/data/projects-master-data.ts
src/fonts/cameliya-regular.ttf
src/lib/actions.ts
src/lib/actions/booking-details.ts
src/lib/actions/bookings.ts
src/lib/actions/customers.ts
src/lib/actions/settings.ts
src/lib/actions/stats.ts
src/lib/actions/studio.ts
src/lib/actions/users.ts
src/lib/constants.ts
src/lib/image-utils.ts
src/lib/seed-helpers.ts
src/lib/supabase/client.ts
src/lib/supabase/server.ts
src/lib/utils.ts
src/middleware.ts
src/types/grid-project.ts
src/types/supabase.ts
tailwind.config.ts
tsconfig.json
```

# Files

## File: CHANGELOG.md
```markdown
# Changelog

M·ªçi thay ƒë·ªïi quan tr·ªçng c·ªßa d·ª± √°n s·∫Ω ƒë∆∞·ª£c ghi l·∫°i t·∫°i ƒë√¢y.

## [1.0.0] - 2025-11-17

### üéâ Initial Release
Phi√™n b·∫£n ch√≠nh th·ª©c ƒë·∫ßu ti√™n c·ªßa Website Portfolio.

### ‚ú® T√≠nh nƒÉng m·ªõi
- **Trang ch·ªß:** Ho√†n thi·ªán Hero Section, Showcase, Portfolio Grid.
- **Trang D·ªãch v·ª•:** B·∫£ng gi√°, Thi·∫øt b·ªã, Quy ƒë·ªãnh, v√† ph·∫ßn H·∫≠u tr∆∞·ªùng (BTS).
- **Trang Gi·ªõi thi·ªáu:** C√¢u chuy·ªán th∆∞∆°ng hi·ªáu v√† C·ªôt m·ªëc ph√°t tri·ªÉn.
- **Trang D·ª± √°n:** - 3 chuy√™n m·ª•c: Th·ªùi trang, Th∆∞∆°ng m·∫°i, C√° nh√¢n.
  - Trang chi ti·∫øt d·ª± √°n v·ªõi n·ªôi dung ƒë·ªông (Article Body).
- **H·ªá th·ªëng:**
  - Dark/Light Mode.
  - Responsive ho√†n ch·ªânh (Mobile/Tablet/Desktop).
  - SEO Metadata ƒë·ªông cho t·ª´ng d·ª± √°n.

### üîß K·ªπ thu·∫≠t
- C·∫•u h√¨nh `next.config.ts` cho GitHub Pages (basePath, output export).
- Thi·∫øt l·∫≠p quy tr√¨nh deploy t·ª± ƒë·ªông qua `npm run deploy`.
- T·ªëi ∆∞u h√≥a `sizes` cho h√¨nh ·∫£nh Next.js.

### üöß Backlog (D·ª± ki·∫øn ph√°t tri·ªÉn sau)
- Trang Magazine (T·∫°p ch√≠).
```

## File: eslint.config.mjs
```javascript
import { dirname } from "path";
import { fileURLToPath } from "url";
import { FlatCompat } from "@eslint/eslintrc";

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

const compat = new FlatCompat({
  baseDirectory: __dirname,
});

const eslintConfig = [
  ...compat.extends("next/core-web-vitals", "next/typescript"),
  {
    ignores: [
      "node_modules/**",
      ".next/**",
      "out/**",
      "build/**",
      "next-env.d.ts",
    ],
  },
];

export default eslintConfig;
```

## File: lib/supabase.ts
```typescript
// src/lib/supabase.ts
import { createClient } from '@supabase/supabase-js';

// L·∫•y bi·∫øn m√¥i tr∆∞·ªùng v√† ki·ªÉm tra xem c√≥ t·ªìn t·∫°i kh√¥ng
const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

if (!supabaseUrl || !supabaseKey) {
  throw new Error('Missing Supabase environment variables');
}

export const supabase = createClient(supabaseUrl, supabaseKey);
```

## File: LICENSE
```
MIT License

Copyright (c) 2025 Tr·∫ßn H·∫£i ƒêƒÉng

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

## File: postcss.config.mjs
```javascript
const config = {
  plugins: ["@tailwindcss/postcss"],
};

export default config;
```

## File: public/.nojekyll
```

```

## File: public/file.svg
```xml
<svg fill="none" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.5 13.5V5.41a1 1 0 0 0-.3-.7L9.8.29A1 1 0 0 0 9.08 0H1.5v13.5A2.5 2.5 0 0 0 4 16h8a2.5 2.5 0 0 0 2.5-2.5m-1.5 0v-7H8v-5H3v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1M9.5 5V2.12L12.38 5zM5.13 5h-.62v1.25h2.12V5zm-.62 3h7.12v1.25H4.5zm.62 3h-.62v1.25h7.12V11z" clip-rule="evenodd" fill="#666" fill-rule="evenodd"/></svg>
```

## File: public/globe.svg
```xml
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><g clip-path="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.27 14.1a6.5 6.5 0 0 0 3.67-3.45q-1.24.21-2.7.34-.31 1.83-.97 3.1M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.48-1.52a7 7 0 0 1-.96 0H7.5a4 4 0 0 1-.84-1.32q-.38-.89-.63-2.08a40 40 0 0 0 3.92 0q-.25 1.2-.63 2.08a4 4 0 0 1-.84 1.31zm2.94-4.76q1.66-.15 2.95-.43a7 7 0 0 0 0-2.58q-1.3-.27-2.95-.43a18 18 0 0 1 0 3.44m-1.27-3.54a17 17 0 0 1 0 3.64 39 39 0 0 1-4.3 0 17 17 0 0 1 0-3.64 39 39 0 0 1 4.3 0m1.1-1.17q1.45.13 2.69.34a6.5 6.5 0 0 0-3.67-3.44q.65 1.26.98 3.1M8.48 1.5l.01.02q.41.37.84 1.31.38.89.63 2.08a40 40 0 0 0-3.92 0q.25-1.2.63-2.08a4 4 0 0 1 .85-1.32 7 7 0 0 1 .96 0m-2.75.4a6.5 6.5 0 0 0-3.67 3.44 29 29 0 0 1 2.7-.34q.31-1.83.97-3.1M4.58 6.28q-1.66.16-2.95.43a7 7 0 0 0 0 2.58q1.3.27 2.95.43a18 18 0 0 1 0-3.44m.17 4.71q-1.45-.12-2.69-.34a6.5 6.5 0 0 0 3.67 3.44q-.65-1.27-.98-3.1" fill="#666"/></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h16v16H0z"/></clipPath></defs></svg>
```

## File: public/next.svg
```xml
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 394 80"><path fill="#000" d="M262 0h68.5v12.7h-27.2v66.6h-13.6V12.7H262V0ZM149 0v12.7H94v20.4h44.3v12.6H94v21h55v12.6H80.5V0h68.7zm34.3 0h-17.8l63.8 79.4h17.9l-32-39.7 32-39.6h-17.9l-23 28.6-23-28.6zm18.3 56.7-9-11-27.1 33.7h17.8l18.3-22.7z"/><path fill="#000" d="M81 79.3 17 0H0v79.3h13.6V17l50.2 62.3H81Zm252.6-.4c-1 0-1.8-.4-2.5-1s-1.1-1.6-1.1-2.6.3-1.8 1-2.5 1.6-1 2.6-1 1.8.3 2.5 1a3.4 3.4 0 0 1 .6 4.3 3.7 3.7 0 0 1-3 1.8zm23.2-33.5h6v23.3c0 2.1-.4 4-1.3 5.5a9.1 9.1 0 0 1-3.8 3.5c-1.6.8-3.5 1.3-5.7 1.3-2 0-3.7-.4-5.3-1s-2.8-1.8-3.7-3.2c-.9-1.3-1.4-3-1.4-5h6c.1.8.3 1.6.7 2.2s1 1.2 1.6 1.5c.7.4 1.5.5 2.4.5 1 0 1.8-.2 2.4-.6a4 4 0 0 0 1.6-1.8c.3-.8.5-1.8.5-3V45.5zm30.9 9.1a4.4 4.4 0 0 0-2-3.3 7.5 7.5 0 0 0-4.3-1.1c-1.3 0-2.4.2-3.3.5-.9.4-1.6 1-2 1.6a3.5 3.5 0 0 0-.3 4c.3.5.7.9 1.3 1.2l1.8 1 2 .5 3.2.8c1.3.3 2.5.7 3.7 1.2a13 13 0 0 1 3.2 1.8 8.1 8.1 0 0 1 3 6.5c0 2-.5 3.7-1.5 5.1a10 10 0 0 1-4.4 3.5c-1.8.8-4.1 1.2-6.8 1.2-2.6 0-4.9-.4-6.8-1.2-2-.8-3.4-2-4.5-3.5a10 10 0 0 1-1.7-5.6h6a5 5 0 0 0 3.5 4.6c1 .4 2.2.6 3.4.6 1.3 0 2.5-.2 3.5-.6 1-.4 1.8-1 2.4-1.7a4 4 0 0 0 .8-2.4c0-.9-.2-1.6-.7-2.2a11 11 0 0 0-2.1-1.4l-3.2-1-3.8-1c-2.8-.7-5-1.7-6.6-3.2a7.2 7.2 0 0 1-2.4-5.7 8 8 0 0 1 1.7-5 10 10 0 0 1 4.3-3.5c2-.8 4-1.2 6.4-1.2 2.3 0 4.4.4 6.2 1.2 1.8.8 3.2 2 4.3 3.4 1 1.4 1.5 3 1.5 5h-5.8z"/></svg>
```

## File: public/vercel.svg
```xml
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1155 1000"><path d="m577.3 0 577.4 1000H0z" fill="#fff"/></svg>
```

## File: public/window.svg
```xml
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.5 2.5h13v10a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1zM0 1h16v11.5a2.5 2.5 0 0 1-2.5 2.5h-11A2.5 2.5 0 0 1 0 12.5zm3.75 4.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5M7 4.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m1.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5" fill="#666"/></svg>
```

## File: src/app/admin/calendar/_components/CalendarSidebarWrapper.tsx
```typescript
'use client'
import CalendarSidebar from '@/components/admin/calendar/CalendarSidebar'

// ƒê·ªãnh nghƒ©a Type t·ªëi thi·ªÉu m√† Sidebar c·∫ßn
interface RoomBasic {
  room_id: number;
  name: string | null;
  code: string | null;
  // Cho ph√©p nh·∫≠n th√™m c√°c tr∆∞·ªùng th·ª´a kh√°c (nh∆∞ branch_id...) m√† kh√¥ng b√°o l·ªói
  [key: string]: unknown; 
}

// Thay any[] b·∫±ng RoomBasic[]
export default function CalendarSidebarWrapper({ rooms }: { rooms: RoomBasic[] }) {
  return (
    <CalendarSidebar 
      // √âp ki·ªÉu rooms v·ªÅ d·∫°ng Sidebar c·∫ßn (n·∫øu CalendarSidebarProps b√™n trong ch·∫∑t ch·∫Ω h∆°n)
      // Nh∆∞ng th∆∞·ªùng th√¨ RoomBasic[] l√† ƒë·ªß an to√†n r·ªìi.
      rooms={rooms.map(r => ({
          room_id: r.room_id,
          name: r.name || 'Kh√¥ng t√™n', // X·ª≠ l√Ω null t·∫°i ƒë√¢y
          code: r.code || 'NO-CODE'
      }))} 
      onCreateClick={() => {
        const title = prompt("T·∫°o booking nhanh:");
        if(title) alert("ƒê√£ t·∫°o: " + title);
      }} 
    />
  )
}
```

## File: src/app/loading.tsx
```typescript
// src/app/loading.tsx
import { Loader2 } from "lucide-react";

export default function Loading() {
  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center bg-[var(--background)]">
      <div className="flex flex-col items-center gap-4">
        <Loader2 className="h-10 w-10 animate-spin text-[var(--foreground)]" />
        <p className="text-sm text-[var(--sub-text)] font-medium tracking-widest uppercase animate-pulse">
          Loading Oni Studio...
        </p>
      </div>
    </div>
  );
}
```

## File: src/app/styles/BtsSection.module.css
```css
/* src/styles/BtsSection.module.css */

.btsSection {
  position: relative; /* Quan tr·ªçng ƒë·ªÉ .stickyImageWrapper ho·∫°t ƒë·ªông */
  background-color: var(--background);
  color: var(--foreground);
}

/* --- 1. PH·∫¶N ·∫¢NH N·ªÄN STICKY --- */

.stickyImageWrapper {
  position: sticky;
  top: 0;
  height: 100vh; /* ·∫¢nh n·ªÅn chi·∫øm 100% chi·ªÅu cao viewport */
  width: 100%;
  /* z-index: 0; (m·∫∑c ƒë·ªãnh) */
}

.imageContainer {
  position: absolute;
  inset: 0;
  opacity: 0;
  transition: opacity 1s cubic-bezier(0.4, 0, 0.2, 1);
}

.imageActive {
  opacity: 1;
}

/* L·ªõp ph·ªß m·ªù t·ªëi (gradient) ƒë·ªÉ ch·ªØ d·ªÖ ƒë·ªçc h∆°n */
.imageOverlay {
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to top,
    rgba(0, 0, 0, 1) 0%,
    rgba(0, 0, 0, 0.5) 40%,
    transparent 100%
  );
}


/* --- 2. PH·∫¶N N·ªòI DUNG CU·ªòN (OVERLAY) --- */

/* Ti√™u ƒë·ªÅ section (n·∫±m ·ªü tr√™n c√πng) */
.sectionHeader {
  /* ƒê·∫∑t t∆∞∆°ng ƒë·ªëi ƒë·ªÉ ƒë√® l√™n tr√™n ·∫£nh */
  position: relative; 
  z-index: 2;
  text-align: center;
  /* ƒê·∫©y ti√™u ƒë·ªÅ xu·ªëng 1 ch√∫t */
  padding-top: 20vh;
  padding-bottom: 20vh;
  /* Ch·ªØ tr·∫Øng cho d·ªÖ ƒë·ªçc */
  color: #ffffff;
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
}

.sectionTitle {
  font-size: 2.25rem; /* text-3xl */
  font-weight: 300; /* font-light */
}

.sectionSubtitle {
  font-size: 1.125rem; /* text-lg */
  opacity: 0.9;
  margin-top: 0.5rem;
}

@media (min-width: 768px) {
  .sectionTitle {
    font-size: 3rem; /* md:text-5xl */
  }
  .sectionSubtitle {
    font-size: 1.25rem; /* md:text-xl */
  }
}

/* C·ªôt ch·ª©a c√°c "c·∫£nh" text */
.textColumn {
  position: relative;
  z-index: 2; /* ƒê·∫£m b·∫£o text cu·ªôn TR√äN ·∫£nh */
  width: 100%;
}

/* --- N·ªôi dung t·ª´ng "C·∫£nh" (Scene) --- */
.scene {
  /* M·ªói scene cao 100vh ƒë·ªÉ kh·ªõp v·ªõi 1 ·∫£nh */
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center; /* CƒÉn gi·ªØa n·ªôi dung theo chi·ªÅu d·ªçc */
  color: #ffffff; /* Ch·ªØ tr·∫Øng */
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.7);
}

.sceneContent {
  /* CƒÉn l·ªÅ tr√°i (ho·∫∑c gi·ªØa) cho n·ªôi dung text */
  text-align: left;
  max-width: 800px; /* Gi·ªõi h·∫°n chi·ªÅu r·ªông kh·ªëi text */
  padding: 1rem 1.5rem;

  opacity: 0.3; /* M·ªù ƒëi khi kh√¥ng active */
  transform: translateY(20px);
  transition: opacity 0.5s ease-out, transform 0.5s ease-out;
}

@media (min-width: 768px) {
  .sceneContent {
    /* Tr√™n desktop, ƒë·∫©y kh·ªëi text sang b√™n tr√°i */
    margin-left: 10%; 
  }
}

.sceneActive {
  opacity: 1;
  transform: translateY(0);
}

.sceneCategory {
  font-size: 0.875rem; /* text-sm */
  text-transform: uppercase;
  letter-spacing: 0.1em;
  opacity: 0.8;
}

.sceneTitle {
  font-size: 2.25rem; /* text-2xl */
  font-weight: 300; /* font-light */
  margin: 0.5rem 0 1rem 0;
}

@media (min-width: 768px) {
  .sceneTitle {
    font-size: 3rem; /* md:text-3xl */
  }
}

.sceneDescription {
  font-size: 1rem;
  line-height: 1.7;
  opacity: 0.9;
  margin-bottom: 1.5rem;
}

.sceneLink {
  color: #ffffff;
  font-weight: 500;
  display: inline-block;
  transition: transform 0.3s ease;
  border-bottom: 1px solid rgba(255, 255, 255, 0.5);
  padding-bottom: 2px;
}
.sceneLink:hover {
  transform: translateX(4px);
  border-bottom-color: #ffffff;
}
```

## File: src/app/styles/DichVu.module.css
```css
/* B·ªë c·ª•c 2 c·ªôt tr√™n Desktop */
.stickyLayout {
  display: flex;
  flex-direction: row;
  gap: 4rem; /* Kho·∫£ng c√°ch gi·ªØa 2 c·ªôt */
}

/* C·ªôt 1: Menu */
.stickyNav {
  /* C·ªôt menu chi·∫øm 1/3 (kho·∫£ng 30%) */
  flex-basis: 33.33%; 
  max-width: 300px; /* Gi·ªõi h·∫°n chi·ªÅu r·ªông t·ªëi ƒëa */
  
  /* Ph·∫ßn quan tr·ªçng: D√≠nh l·∫°i */
  position: sticky;
  
  /* D√≠nh c√°ch top (ch·ª´a ch·ªó cho Header c·ªßa b·∫°n) */
  top: 120px; 
  
  /* T·ª± cƒÉn ch·ªânh chi·ªÅu cao */
  align-self: flex-start; 
}

.stickyNav ul {
  list-style: none;
  padding: 0;
  margin: 0;
  display: flex;
  flex-direction: column;
  gap: 1.25rem; /* Kho·∫£ng c√°ch gi·ªØa c√°c m·ª•c menu */
}

.stickyNav a {
  text-decoration: none;
  font-size: 1.1rem; /* 17.6px */
  font-weight: 500;
  color: var(--foreground);
  opacity: 0.6; /* M√†u ch·ªØ m·ªù m·∫∑c ƒë·ªãnh */
  transition: all 0.2s ease-in-out;
}

.stickyNav a:hover {
  opacity: 0.8; /* S√°ng h∆°n khi hover */
}

/* ƒê√¢y l√† class Active khi cu·ªôn t·ªõi */
.stickyNav a.active {
  color: var(--foreground);
  opacity: 1; /* R√µ n√©t */
  font-weight: 700;
  border-left: 3px solid var(--foreground);
  padding-left: 10px;
}

/* C·ªôt 2: N·ªôi dung */
.contentColumn {
  /* C·ªôt n·ªôi dung chi·∫øm ph·∫ßn c√≤n l·∫°i */
  flex: 1;
  min-width: 0; /* S·ª≠a l·ªói flexbox overflow */
}

/* M·ªói Section n·ªôi dung */
.sceneContent {
  /* Th√™m kho·∫£ng c√°ch l·ªõn gi·ªØa c√°c section */
  margin-bottom: 4rem; /* 64px */
  padding-bottom: 4rem; /* 64px */
  border-bottom: 1px solid var(--foreground);
}
.sceneContent:last-child {
  border-bottom: none;
  margin-bottom: 0;
  padding-bottom: 0;
}

/* Ti√™u ƒë·ªÅ c·ªßa m·ªói Section */
.contentTitle {
  font-size: 2.25rem; /* 36px (to h∆°n, r√µ r√†ng h∆°n) */
  font-weight: 600;
  margin-bottom: 2rem; /* 32px */
}

/* CSS cho √¥ m√†u ph√¥ng n·ªÅn */
.colorSwatch {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  border: 1px solid var(--foreground);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

/* --- Responsive cho Di ƒê·ªông (md: 768px) --- */
@media (max-width: 768px) {
  /* X·∫øp ch·ªìng 2 c·ªôt */
  .stickyLayout {
    flex-direction: column;
    gap: 2rem;
  }

  .stickyNav {
    position: relative;
    top: 0;
    flex-basis: auto;
    width: 100%;
    max-width: 100%;
    
    /* Chuy·ªÉn th√†nh h√†ng ngang cho g·ªçn */
    border-bottom: 1px solid var(--foreground);
    padding-bottom: 1rem;
  }
  
  .stickyNav ul {
    flex-direction: row; /* H√†ng ngang */
    gap: 1.5rem;
    overflow-x: auto; /* Cho ph√©p cu·ªôn ngang n·∫øu kh√¥ng ƒë·ªß ch·ªó */
  }

  /* Link tr√™n di ƒë·ªông */
  .stickyNav a {
    white-space: nowrap; /* Kh√¥ng cho ch·ªØ xu·ªëng h√†ng */
  }

  .stickyNav a.active {
    transform: none; /* B·ªè hi·ªáu ·ª©ng translate */
    border-left: none;
    padding-left: 0;
  }

  .contentColumn {
    flex-basis: auto;
    width: 100%;
  }

  .contentTitle {
    font-size: 1.875rem; /* 30px tr√™n mobile */
  }
}
```

## File: src/components/admin/calendar/BookingDetailModal.tsx
```typescript
// src/components/admin/calendar/BookingDetailModal.tsx
'use client';

import React, { useState, useEffect, useCallback } from 'react';
import { Check, Trash2, Plus, DollarSign, User, FileText, RotateCcw, Loader2, Camera, Coffee, AlertCircle, LogIn, LogOut } from 'lucide-react';
import { toast } from 'sonner';
import ModalPortal from '@/components/ui/ModalPortal';
import { getBookingDetails, addBookingService, removeBookingService, checkInCustomer, checkOutCustomer, confirmPayment, finalizeBooking } from '@/lib/actions/booking-details';
import { ServiceItem } from '@/lib/actions/studio';
import { format } from 'date-fns';
import { calculateBilling, fmtMoney, formatDuration } from '@/lib/utils';

interface BookingDetailModalProps {
  isOpen: boolean;
  onClose: () => void;
  bookingId: number | null;
  servicesList: ServiceItem[];
}

interface BookingItemDetail {
    booking_item_id: number;
    room_id: number;
    start_dt: string;
    end_dt: string;
    price_snapshot: number;
    rooms: {
        name: string | null;
        code: string | null;
    } | null;
}

interface BookingServiceDetail {
    booking_service_id: number;
    quantity: number;
    unit_price_snapshot: number;
    computed_amount: number;
    type: string;
    services: {
        name: string;
        unit: string;
        price: number;
        category: string;
    } | null;
}

interface BookingDetail {
    booking_id: number;
    status: string;
    deposit_amount: number;
    check_in_at?: string;
    check_out_at?: string;
    customers: {
        full_name: string | null;
        phone: string | null;
    } | null;
    booking_items: BookingItemDetail[];       
    booking_services: BookingServiceDetail[]; 
}

// ƒê·ªãnh nghƒ©a ki·ªÉu d·ªØ li·ªáu cho BillingInfo
interface FeeDetail {
    isBillable: boolean;
    minutes: number;
    billableHours: number;
    amount: number;
    message: string;
}

interface BillingInfo {
    totalSurcharge: number;
    earlyFee: FeeDetail;
    otFee: FeeDetail;
    surchargeMessages?: string[];
}

// Gi√° tr·ªã m·∫∑c ƒë·ªãnh ƒë·ªÉ tr√°nh l·ªói undefined
const DEFAULT_FEE: FeeDetail = {
    isBillable: false,
    minutes: 0,
    billableHours: 0,
    amount: 0,
    message: ''
};

const DEFAULT_BILLING: BillingInfo = {
    totalSurcharge: 0,
    earlyFee: DEFAULT_FEE,
    otFee: DEFAULT_FEE
};

export default function BookingDetailModal({ isOpen, onClose, bookingId, servicesList }: BookingDetailModalProps) {
  const [booking, setBooking] = useState<BookingDetail | null>(null);
  const [loading, setLoading] = useState(false);
  
  // State Tabs
  const [activeTab, setActiveTab] = useState<'equipment' | 'fnb' | 'surcharge'>('equipment');
  const [isAddingService, setIsAddingService] = useState(false);
  const [selectedServiceId, setSelectedServiceId] = useState<string>('');
  const [qty, setQty] = useState(1);
  const [otPrice] = useState(300000); // Gi√° OT m·∫∑c ƒë·ªãnh

  const fetchDetails = useCallback(async () => {
    if (!bookingId) return;
    setLoading(true);
    const res = await getBookingDetails(bookingId);
    if (res.success) {
        setBooking(res.data as unknown as BookingDetail);
    } else {
        toast.error(res.error);
    }
    setLoading(false);
  }, [bookingId]);

  useEffect(() => {
    if (isOpen && bookingId) {
      fetchDetails();
    } else {
        setBooking(null);
    }
  }, [isOpen, bookingId, fetchDetails]);

  // --- ACTIONS ---
  const handleCheckIn = async () => {
      if (!booking || !booking.booking_items || booking.booking_items.length === 0) return;
      const roomId = booking.booking_items[0].room_id; 
      const bookedStart = booking.booking_items[0].start_dt;
      
      const res = await checkInCustomer(booking.booking_id, roomId, bookedStart);
      if(res.success) { toast.success("Checked-in th√†nh c√¥ng!"); fetchDetails(); }
      else toast.error(res.error);
  }

  const handleCheckOut = async () => {
      if (!booking) return;
      const res = await checkOutCustomer(booking.booking_id);
      if(res.success) { toast.success("ƒê√£ d·ª´ng gi·ªù (Check-out)!"); fetchDetails(); }
      else toast.error(res.error);
  }

  const handlePayment = async (totalToPay: number) => {
      if (!booking) return;
      if(!confirm(`X√°c nh·∫≠n kh√°ch ƒë√£ thanh to√°n ${fmtMoney(totalToPay)}?`)) return;

      const res = await confirmPayment(booking.booking_id, totalToPay);
      if(res.success) { toast.success("Thanh to√°n th√†nh c√¥ng!"); fetchDetails(); }
      else toast.error(res.error);
  }

  const handleFinalize = async () => {
      if (!booking) return;
      const res = await finalizeBooking(booking.booking_id);
      if(res.success) { toast.success("ƒê∆°n h√†ng ƒë√£ ƒë√≥ng!"); fetchDetails(); onClose(); }
      else toast.error(res.error);
  }

  const handleAddService = async () => {
     if (!selectedServiceId || !booking) return;
     const service = servicesList.find(s => s.service_id === Number(selectedServiceId));
     if (!service) return;

     const res = await addBookingService(booking.booking_id, service.service_id, qty, service.price);
     if (res.success) {
         toast.success("ƒê√£ th√™m d·ªãch v·ª•");
         setIsAddingService(false);
         fetchDetails();
     } else {
         toast.error(res.error);
     }
  };

  const handleRemoveService = async (id: number) => {
      const res = await removeBookingService(id);
      if (res.success) {
          toast.success("ƒê√£ x√≥a");
          fetchDetails();
      }
  };

  // --- LOGIC T√çNH TO√ÅN ---
  // 1. L·∫•y th√¥ng tin OT/Checkin s·ªõm t·ª´ utils
  const billingInfo: BillingInfo = booking && booking.booking_items.length > 0 ? calculateBilling(
    new Date(booking.booking_items[0].start_dt),
    new Date(booking.booking_items[0].end_dt),
    booking.check_in_at ? new Date(booking.check_in_at) : null,
    booking.check_out_at ? new Date(booking.check_out_at) : null,
    otPrice, 
    { earlyGrace: 40, otFree: 60 }
  ) : DEFAULT_BILLING;

  // 2. T·ªïng h·ª£p ti·ªÅn
  const calculateTotal = () => {
     if (!booking) return 0;
     const roomTotal = booking.booking_items?.reduce((sum, item) => sum + (item.price_snapshot || 0), 0) || 0;
     const serviceTotal = booking.booking_services?.reduce((sum, s) => sum + (s.computed_amount || 0), 0) || 0;
     const surchargeTotal = billingInfo.totalSurcharge || 0;

     return roomTotal + serviceTotal + surchargeTotal;
  };

  const dropdownServices = servicesList.filter(s => s.category === activeTab);
  
  const totalAmount = calculateTotal();
  const deposit = booking?.deposit_amount || 0;
  const remaining = totalAmount - deposit;

  // T·∫°o m·∫£ng th√¥ng b√°o surcharge ƒë·ªÉ hi·ªÉn th·ªã
  const surchargeMessages = [];
  if (billingInfo.earlyFee.message) surchargeMessages.push(billingInfo.earlyFee.message);
  if (billingInfo.otFee.message) surchargeMessages.push(billingInfo.otFee.message);

  if (!isOpen) return null;

  return (
    <ModalPortal isOpen={isOpen} onClose={onClose} title={`Chi ti·∫øt ƒë∆°n #${bookingId}`} className="max-w-4xl">
       {loading || !booking ? (
           <div className="p-10 flex justify-center items-center">
               <Loader2 className="animate-spin" />
           </div>
       ) : (
           <div className="flex flex-col md:flex-row h-[80vh] md:h-auto">
               
               {/* C·ªòT TR√ÅI */}
               <div className="flex-1 p-6 overflow-y-auto bg-[var(--admin-bg)]/50 space-y-6">
                   
                   {/* 1. HEADER INFO & STATUS TAG */}
                   <div className="flex justify-between items-start">
                       <div>
                           <div className="flex items-center gap-2">
                                <h2 className="text-lg font-bold text-[var(--admin-fg)]">{booking.customers?.full_name}</h2>
                                <button 
                                   onClick={fetchDetails}
                                   className="p-1.5 hover:bg-gray-200 rounded-full text-gray-500 transition-colors cursor-pointer"
                                   title="L√†m m·ªõi d·ªØ li·ªáu"
                                >
                                   <RotateCcw size={14} />
                                </button>
                           </div>
                           <div className="text-sm text-[var(--admin-sub)] flex items-center gap-1"><User size={14}/> {booking.customers?.phone}</div>
                       </div>
                       <div className="text-right">
                            <span className={`px-2 py-1 rounded text-xs font-bold uppercase ${
                                booking.status === 'checked_in' ? 'bg-green-100 text-green-700' : 
                                booking.status === 'checked_out' ? 'bg-red-100 text-red-700' :
                                booking.status === 'pending' ? 'bg-yellow-100 text-yellow-700' :
                                booking.status === 'confirmed' ? 'bg-blue-100 text-blue-700' :
                                booking.status === 'paid' ? 'bg-purple-100 text-purple-700' :
                                booking.status === 'completed' ? 'bg-gray-200 text-gray-600' : 'bg-blue-100 text-blue-700'
                            }`}>
                                {booking.status === 'checked_in' ? 'Kh√°ch ƒëang ·ªü Stu' :
                                 booking.status === 'checked_out' ? 'Kh√°ch ƒë√£ r·ªùi Stu' :
                                 booking.status === 'paid' ? 'ƒê√£ thanh to√°n' :
                                 booking.status === 'confirmed' ? 'ƒê√£ x√°c nh·∫≠n' :
                                 booking.status}
                            </span>
                       </div>
                   </div>

                   {/* 2. TIMELINE */}
                   <div className="bg-[var(--admin-card)] p-4 rounded-xl border border-[var(--admin-border)] shadow-sm">
                        <div className="grid grid-cols-2 gap-6 mb-2">
                            <div className="space-y-4 border-r border-[var(--admin-border)] pr-4">
                                {booking.booking_items.map(item => (
                                    <div key={item.booking_item_id}>
                                        <div className="font-bold text-sm text-[var(--admin-fg)] mb-1">{item.rooms?.name}</div>
                                        <div className="flex justify-between text-xs">
                                            <div>
                                                <div className="text-[10px] text-[var(--admin-sub)] uppercase">Gi·ªù ƒë·∫∑t l·ªãch</div>
                                                <div className="font-bold">{format(new Date(item.start_dt), 'HH:mm')}</div>
                                            </div>
                                            <div>
                                                <div className="text-[10px] text-[var(--admin-sub)] uppercase">Gi·ªù k·∫øt l·ªãch</div>
                                                <div className="font-bold">{format(new Date(item.end_dt), 'HH:mm')}</div>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                            <div className="space-y-4">
                                <div className="flex justify-between text-xs">
                                    <div>
                                        <div className="text-[10px] text-[var(--admin-sub)] uppercase flex items-center gap-1"><LogIn size={10}/> Check-in</div>
                                        <div className={`font-bold ${booking.check_in_at ? 'text-green-600' : 'text-gray-400'}`}>
                                            {booking.check_in_at ? format(new Date(booking.check_in_at), 'HH:mm') : '--:--'}
                                        </div>
                                    </div>
                                    <div>
                                        <div className="text-[10px] text-[var(--admin-sub)] uppercase flex items-center gap-1"><LogOut size={10}/> Check-out</div>
                                        <div className={`font-bold ${booking.check_out_at ? 'text-blue-600' : 'text-gray-400'}`}>
                                            {booking.check_out_at ? format(new Date(booking.check_out_at), 'HH:mm') : '--:--'}
                                        </div>
                                    </div>
                                </div>
                                {surchargeMessages.length > 0 && (
                                    <div className="bg-[var(--admin-card)] mt-3 text-xs text-[var(--admin-primary)]">
                                        {surchargeMessages.map((msg, idx) => (
                                            <div key={idx}>‚Ä¢ {msg}</div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        </div>
                   </div>

                   {/* 3. D·ªäCH V·ª§ (TABS) */}
                   <div className="bg-[var(--admin-card)] rounded-xl border border-[var(--admin-border)] shadow-sm overflow-hidden">
                       <div className="flex border-b border-[var(--admin-border)]">
                           <button onClick={() => setActiveTab('equipment')} className={`flex-1 py-3 text-xs font-bold uppercase flex justify-center gap-2 cursor-pointer ${activeTab === 'equipment' ? 'bg-[var(--admin-bg)] text-[var(--admin-primary)] border-b-2 border-[var(--admin-primary)]' : 'text-[var(--admin-sub)]'}`}>
                               <Camera size={14}/> Thi·∫øt b·ªã
                           </button>
                           <button onClick={() => setActiveTab('fnb')} className={`flex-1 py-3 text-xs font-bold uppercase flex justify-center gap-2 cursor-pointer ${activeTab === 'fnb' ? 'bg-[var(--admin-bg)] text-[var(--admin-primary)] border-b-2 border-[var(--admin-primary)]' : 'text-[var(--admin-sub)]'}`}>
                               <Coffee size={14}/> F&B
                           </button>
                           <button onClick={() => setActiveTab('surcharge')} className={`flex-1 py-3 text-xs font-bold uppercase flex justify-center gap-2 cursor-pointer ${activeTab === 'surcharge' ? 'bg-[var(--admin-bg)] text-[var(--admin-primary)] border-b-2 border-[var(--admin-primary)]' : 'text-[var(--admin-sub)]'}`}>
                               <AlertCircle size={14}/> Ph·ª• ph√≠
                           </button>
                       </div>

                       <div className="p-4">
                           <div className="flex justify-between items-center mb-3">
                               <div className="text-xs font-bold text-[var(--admin-sub)] uppercase">Danh s√°ch {activeTab}</div>
                               {booking.status !== 'completed' && booking.status !== 'paid' && (
                                   <button onClick={() => setIsAddingService(!isAddingService)} className="text-[10px] bg-[var(--admin-primary)]/10 text-[var(--admin-primary)] px-2 py-1 rounded font-bold flex items-center gap-1 cursor-pointer hover:bg-[var(--admin-primary)]/20 transition-colors">
                                       <Plus size={12}/> {isAddingService ? 'ƒê√≥ng' : 'Th√™m'}
                                   </button>
                               )}
                           </div>

                           {isAddingService && (
                               <div className="bg-[var(--admin-bg)] p-3 rounded border border-[var(--admin-border)] mb-3 animate-fade-in-up">
                                   <div className="flex gap-2 mb-2">
                                       <select className="flex-1 p-1 text-sm border rounded bg-[var(--admin-card)]" 
                                               value={selectedServiceId} onChange={e => setSelectedServiceId(e.target.value)}>
                                           <option value="">-- Ch·ªçn d·ªãch v·ª• --</option>
                                           {dropdownServices.map((s) => (
                                               <option key={s.service_id} value={s.service_id}>{s.name} - {fmtMoney(s.price)}</option>
                                           ))}
                                       </select>
                                       <input type="number" value={qty} onChange={e => setQty(Number(e.target.value))} className="w-12 text-center border rounded bg-[var(--admin-card)] text-sm"/>
                                   </div>
                                   <div className="flex justify-end gap-2">
                                       <button onClick={handleAddService} className="text-xs bg-[var(--admin-fg)] text-[var(--admin-bg)] px-3 py-1 rounded font-bold">L∆∞u</button>
                                   </div>
                               </div>
                           )}

                           <div className="space-y-2 max-h-40 overflow-y-auto table-scrollbar">
                               {booking.booking_services
                                   ?.filter(s => s.services?.category === activeTab)
                                   .map((s) => (
                                   <div key={s.booking_service_id} className="flex justify-between items-center p-2 border-b border-[var(--admin-border)] last:border-0">
                                       <div>
                                           <div className="text-sm font-medium">{s.services?.name}</div>
                                           <div className="text-xs text-[var(--admin-sub)]">{s.quantity} x {fmtMoney(s.unit_price_snapshot || 0)}</div>
                                       </div>
                                       <div className="flex items-center gap-3">
                                           <span className="text-sm font-mono">{fmtMoney(s.computed_amount || 0)}</span>
                                           {booking.status !== 'completed' && booking.status !== 'paid' && (
                                                <button onClick={() => handleRemoveService(s.booking_service_id)} className="text-[var(--admin-sub)] hover:text-red-500">
                                                    <Trash2 size={14}/>
                                                </button>
                                           )}
                                       </div>
                                   </div>
                               ))}
                           </div>
                       </div>
                   </div>
               </div>

               {/* C·ªòT PH·∫¢I: BILL & ACTIONS */}
               <div className="w-full md:w-96 bg-[var(--admin-card)] border-l border-[var(--admin-border)] p-6 flex flex-col justify-between shadow-xl z-10">
                   <div>
                       <div className="flex items-center gap-2 mb-6 pb-4 border-b border-[var(--admin-border)]">
                           <FileText size={20} className="text-[var(--admin-primary)]"/>
                           <h3 className="font-bold text-[var(--admin-fg)] uppercase tracking-widest">H√≥a ƒê∆°n</h3>
                       </div>

                       <div className="bg-[var(--admin-bg)]/30 p-4 rounded-xl border border-[var(--admin-border)] space-y-3 font-mono text-sm">
                            
                            {/* 1. TI·ªÄN PH√íNG & D·ªäCH V·ª§ (C·ªê ƒê·ªäNH) */}
                            <div className="space-y-2">
                                <div className="flex justify-between items-center">
                                    <span className="text-[var(--admin-sub)] font-medium">Ti·ªÅn ph√≤ng</span>
                                    <span className="font-bold text-[var(--admin-fg)]">
                                        {fmtMoney(booking.booking_items?.reduce((a, b) => a + (b.price_snapshot || 0), 0) || 0)}
                                    </span>
                                </div>
                                <div className="flex justify-between items-center">
                                    <span className="text-[var(--admin-sub)] font-medium">D·ªãch v·ª•</span>
                                    <span className="font-bold text-[var(--admin-fg)]">
                                        {fmtMoney(booking.booking_services?.reduce((a, b) => a + (b.computed_amount || 0), 0) || 0)}
                                    </span>
                                </div>
                            </div>

                            {/* 2. PH·ª§ PH√ç TH·ªúI GIAN (CHECK-IN/OUT) */}
                            {(booking.check_in_at || booking.check_out_at) && (
                                <div className="border-t border-dashed border-[var(--admin-border)] pt-2 space-y-2">
                                    
                                    {/* Check-in S·ªõm */}
                                    {booking.check_in_at && (
                                        <div className={`rounded-lg p-2 text-xs bg ${billingInfo.earlyFee.isBillable ? 'border border-orange-100' : 'bg-transparent'}`}>
                                            <div className="flex justify-between items-center mb-1">
                                                <div className="flex items-center gap-1.5 text-[var(--admin-sub)]">
                                                    <LogIn size={12} className="text-[var(--admin-fg)]"/>
                                                    <span className="text-[var(--admin-fg)]">V√†o: <strong className="text-[var(--admin-fg)]">{format(new Date(booking.check_in_at), 'HH:mm')}</strong></span>
                                                </div>
                                                {/* Tag tr·∫°ng th√°i */}
                                                {billingInfo.earlyFee.minutes > 0 && (
                                                    <span className={`px-1.5 py-0.5 rounded text-[10px] font-bold uppercase ${billingInfo.earlyFee.isBillable ? 'bg-orange-100 text-orange-700' : 'bg-green-100 text-green-700'}`}>
                                                        {billingInfo.earlyFee.isBillable ? 'Ph·ª• thu' : 'Mi·ªÖn ph√≠'}
                                                    </span>
                                                )}
                                            </div>

                                            {/* D√≤ng t√≠nh ti·ªÅn Check-in s·ªõm */}
                                            {billingInfo.earlyFee.isBillable && (
                                                <div className="flex justify-between items-start pl-4">
                                                    <div className="flex flex-col">
                                                        <span className="text-orange-700 font-medium">+ Check-in s·ªõm {formatDuration(billingInfo.earlyFee.minutes)}</span>
                                                        <span className="text-[10px] text-orange-600/70">
                                                            ({formatDuration(billingInfo.earlyFee.billableHours * 60)} x {fmtMoney(otPrice)})
                                                        </span>
                                                    </div>
                                                    <span className="font-bold text-orange-700">{fmtMoney(billingInfo.earlyFee.amount)}</span>
                                                </div>
                                            )}
                                        </div>
                                    )}

                                    {/* OT (Check-out Tr·ªÖ) */}
                                    {booking.check_out_at && (
                                        <div className={`rounded-lg p-2 text-xs ${billingInfo.otFee.isBillable ? 'border border-red-100' : 'bg-transparent'}`}>
                                            <div className="flex justify-between items-center mb-1">
                                                <div className="flex items-center gap-1.5 text-[var(--admin-sub)]">
                                                    <LogOut size={12} className="text-[var(--admin-fg)]"/>
                                                    <span className="text-[var(--admin-fg)]">Ra: <strong className="text-[var(--admin-fg)]">{format(new Date(booking.check_out_at), 'HH:mm')}</strong></span>
                                                </div>
                                                {/* Tag tr·∫°ng th√°i */}
                                                {billingInfo.otFee.minutes > 0 && (
                                                    <span className={`px-1.5 py-0.5 rounded text-[10px] font-bold uppercase ${billingInfo.otFee.isBillable ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'}`}>
                                                        {billingInfo.otFee.isBillable ? 'Ph·ª• thu' : 'Mi·ªÖn ph√≠'}
                                                    </span>
                                                )}
                                            </div>

                                            {/* D√≤ng t√≠nh ti·ªÅn OT */}
                                            {billingInfo.otFee.isBillable && (
                                                <div className="flex justify-between items-start pl-4">
                                                    <div className="flex flex-col">
                                                        <span className="text-red-700 font-medium">+ OT {formatDuration(billingInfo.otFee.minutes)}</span>
                                                        <span className="text-[10px] text-red-600/70">
                                                            ({formatDuration(billingInfo.otFee.billableHours * 60)} x {fmtMoney(otPrice)})
                                                        </span>
                                                    </div>
                                                    <span className="font-bold text-red-700">{fmtMoney(billingInfo.otFee.amount)}</span>
                                                </div>
                                            )}
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* 3. ƒê√É C·ªåC & T·ªîNG K·∫æT */}
                            <div className="border-t border-[var(--admin-border)] pt-3 space-y-3">
                                <div className="flex justify-between items-center text-green-600 text-xs font-medium">
                                    {fmtMoney(deposit) !== '0 VNƒê' && (
                                        <>
                                            <span>ƒê√£ c·ªçc tr∆∞·ªõc</span>
                                            <span>- {fmtMoney(deposit)}</span>
                                        </>
                                    )} else (
                                         <>
                                            <span>Ch∆∞a c·ªçc</span>
                                        </>
                                    )
                                </div>

                                <div className="flex justify-between items-center bg-[var(--admin-primary)]/5 p-3 rounded-lg border border-[var(--admin-primary)]/20">
                                    <span className="text-base font-bold text-[var(--admin-primary)] uppercase tracking-tight">C·∫ßn thanh to√°n</span>
                                    <span className="text-xl font-extrabold text-[var(--admin-primary)]">
                                        {fmtMoney(remaining)}
                                    </span>
                                </div>
                            </div>
                        </div>
                   </div>

                   {/* ACTIONS BUTTONS */}
                   <div className="space-y-3 mt-8">
                       {/* 1. CHECK-IN */}
                       {booking.status === 'confirmed' && (
                           <button onClick={handleCheckIn} className="w-full py-4 bg-green-600 text-white rounded-xl 
                           font-bold shadow-lg shadow-green-200 hover:bg-green-700 transition-all flex justify-center items-center gap-2 cursor-pointer">
                               <LogIn size={20}/> CHECK-IN KH√ÅCH
                           </button>
                       )}

                       {/* 2. CHECK-OUT */}
                       {booking.status === 'checked_in' && (
                           <button onClick={handleCheckOut} className="w-full py-4 text-white rounded-xl 
                           font-bold shadow-lg transition-all flex justify-center items-center gap-2 cursor-pointer">
                               <LogOut size={20}/> KH√ÅCH R·ªúI (D·ª™NG GI·ªú)
                           </button>
                       )}

                       {/* 3. THANH TO√ÅN */}
                       {booking.status === 'checked_out' && (
                           <div className="space-y-2">
                               <button onClick={() => handlePayment(remaining)} className="w-full py-4 bg-[var(--admin-primary)] text-white rounded-xl font-bold 
                               shadow-lg hover:opacity-90 flex justify-center items-center gap-2 cursor-pointer">
                                   <DollarSign size={20}/> X√ÅC NH·∫¨N ƒê√É THU TI·ªÄN
                               </button>
                           </div>
                       )}

                       {/* 4. HO√ÄN T·∫§T */}
                       {booking.status === 'paid' && (
                           <div className="space-y-2">
                               <div className="text-center text-xs text-blue-600 font-medium bg-blue-50 p-2 rounded">
                                   ƒê√£ thanh to√°n. Ki·ªÉm tra ph√≤ng v√† ƒë√≥ng ƒë∆°n.
                               </div>
                               <button onClick={handleFinalize} className="w-full py-3 border border-gray-300 bg-white text-gray-700 rounded-xl 
                               font-bold hover:bg-gray-50 flex justify-center items-center gap-2 cursor-pointer">
                                   <Check size={20}/> HO√ÄN T·∫§T ƒê∆†N
                               </button>
                           </div>
                       )}

                       {booking.status === 'completed' && (
                           <div className="bg-gray-100 text-gray-500 text-center py-3 rounded-xl font-bold text-sm border border-gray-200">
                               ƒê∆†N ƒê√É HO√ÄN T·∫§T
                           </div>
                       )}

                        {booking.status !== 'completed' && (
                            <button onClick={onClose} className="w-full py-3 text-[var(--admin-sub)] hover:bg-[var(--admin-hover)] 
                            rounded-xl font-medium transition-colors cursor-pointer">
                                ƒê√≥ng
                            </button>
                        )}
                   </div>
               </div>
           </div>
       )}
    </ModalPortal>
  );
}
```

## File: src/components/admin/calendar/CalendarSidebar.tsx
```typescript
'use client'


interface Room {
  room_id: number;
  name: string;
  code: string;
}

interface CalendarSidebarProps {
  rooms: Room[];
  onCreateClick: () => void;
}

export default function CalendarSidebar({ rooms, onCreateClick }: CalendarSidebarProps) {
  // Mockup Mini Calendar (Ch·ªâ giao di·ªán)
  const days = Array.from({ length: 35 }, (_, i) => i + 1)

  return (
    <aside className="w-[256px] flex-shrink-0 flex flex-col gap-6 pr-4 border-r border-[var(--admin-border)] bg-[var(--admin-bg)] h-full overflow-y-auto pt-4 pl-2">
      
      {/* 1. N√∫t T·∫†O (FAB Style) */}
      <div>
        <button 
          onClick={onCreateClick}
          className="flex items-center gap-3 bg-[var(--admin-card)] text-[var(--admin-fg)] px-5 py-3 rounded-full shadow-md hover:shadow-lg transition-all border border-[var(--admin-border)]"
        >
          <svg width="24" height="24" viewBox="0 0 24 24" className="fill-current text-[var(--admin-primary)]">
            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
          </svg>
          <span className="font-medium">T·∫°o l·ªãch h·∫πn</span>
        </button>
      </div>

      {/* 2. Mini Calendar (Mockup) */}
      <div className="px-2">
        <div className="flex justify-between mb-4 text-sm font-semibold text-[var(--admin-fg)]">
          <span>Th√°ng 12 2025</span>
          <div className="flex gap-2">
            <button className="hover:bg-[var(--admin-hover)] rounded-full p-1">‚Äπ</button>
            <button className="hover:bg-[var(--admin-hover)] rounded-full p-1">‚Ä∫</button>
          </div>
        </div>
        <div className="grid grid-cols-7 text-center text-xs gap-y-3 text-[var(--admin-sub)]">
          <span>T2</span><span>T3</span><span>T4</span><span>T5</span><span>T6</span><span>T7</span><span>CN</span>
          {days.map(d => (
            <span key={d} className={`
              cursor-pointer h-7 w-7 flex items-center justify-center rounded-full hover:bg-[var(--admin-hover)]
              ${d === 1 ? 'bg-[var(--admin-primary)] text-white' : ''}
            `}>
              {d > 31 ? d - 31 : d}
            </span>
          ))}
        </div>
      </div>

      {/* 3. L·ªãch c·ªßa t√¥i (Filters) */}
      <div className="px-2">
        <h3 className="text-xs font-medium text-[var(--admin-sub)] uppercase mb-3 flex justify-between">
          Ph√≤ng Studio
          <button className="hover:bg-[var(--admin-hover)] p-1 rounded">
             ^
          </button>
        </h3>
        <ul className="space-y-2">
          {rooms.map(room => (
            <li key={room.room_id} className="flex items-center gap-2">
              <input 
                type="checkbox" 
                defaultChecked 
                className="w-4 h-4 rounded text-[var(--admin-primary)] focus:ring-0 cursor-pointer"
                style={{ accentColor: 'var(--admin-primary)' }}
              />
              <span className="text-sm text-[var(--admin-fg)] truncate">{room.name}</span>
            </li>
          ))}
          {/* Hardcode th√™m m·ª•c D·ªçn d·∫πp */}
          <li className="flex items-center gap-2">
              <input 
                type="checkbox" 
                defaultChecked 
                className="w-4 h-4 rounded cursor-pointer"
                style={{ accentColor: '#7f8c8d' }}
              />
              <span className="text-sm text-[var(--admin-fg)]">üßπ L·ªãch D·ªçn d·∫πp</span>
            </li>
        </ul>
      </div>
    </aside>
  )
}
```

## File: src/components/admin/calendar/CustomToolbar.tsx
```typescript
'use client'

import { ToolbarProps, View, Views } from 'react-big-calendar'
import { ChevronLeft, ChevronRight, ChevronDown } from 'lucide-react'
import { CalendarEvent } from './BookingCalendar'
import { useState, useRef, useEffect } from 'react'
import moment from 'moment'

export default function CustomToolbar({ 
  label, 
  date,
  onNavigate, 
  onView, 
  view, 
}: ToolbarProps<CalendarEvent, object>) {

  const [isViewMenuOpen, setIsViewMenuOpen] = useState(false)
  const menuRef = useRef<HTMLDivElement>(null)

  // ƒê√≥ng menu khi click ra ngo√†i
  useEffect(() => {
    function handleClickOutside(event: MouseEvent) {
      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {
        setIsViewMenuOpen(false)
      }
    }
    document.addEventListener("mousedown", handleClickOutside)
    return () => document.removeEventListener("mousedown", handleClickOutside)
  }, [])

  const navigate = (action: 'PREV' | 'NEXT' | 'TODAY') => {
    onNavigate(action)
  }

  const handleViewChange = (v: View) => {
    onView(v)
    setIsViewMenuOpen(false)
  }

  // Label Mapping
  const viewLabels: Record<string, string> = {
    month: 'Th√°ng',
    week: 'Tu·∫ßn',
    day: 'Ng√†y',
    agenda: 'L·ªãch bi·ªÉu'
  }

  const getCustomLabel = () => {
    switch (view) {
      case 'day':
        // Format: 04 Th√°ng 12 2025
        return moment(date).format('DD [Th√°ng] MM, YYYY'); 
      case 'month':
        // Format: Th√°ng 12 2025
        return moment(date).format('[Th√°ng] MM, YYYY');
      case 'week':
        // View tu·∫ßn th√¨ d√πng label m·∫∑c ƒë·ªãnh c·ªßa th∆∞ vi·ªán (x·ª≠ l√Ω kho·∫£ng ng√†y 01-07) s·∫Ω t·ªët h∆°n
        return label; 
      default:
        return label;
    }
  }
  return (
    <div className="flex items-center justify-between px-4 py-3 
    border-b border-[var(--admin-border)] bg-[var(--admin-card)]">
      
      {/* LEFT: Logo/Title & Navigation */}
      <div className="flex items-center gap-6">
        {/* N√∫t H√¥m nay */}
        <button
          onClick={() => navigate('TODAY')}
          className="px-4 py-2 text-sm font-medium 
          border border-[var(--admin-border)] rounded hover:bg-[var(--admin-hover)] 
          transition-colors text-[var(--admin-fg)] cursor-pointer"
        >
          H√¥m nay
        </button>

        {/* Navigation Arrows */}
        <div className="flex items-center gap-1 text-[var(--admin-fg)]">
          <button 
            onClick={() => navigate('PREV')}
            className="p-2 rounded-full hover:bg-[var(--admin-hover)] transition-colors"
            title="Tr∆∞·ªõc"
          >
            <ChevronLeft size={20} />
          </button>
          <button 
            onClick={() => navigate('NEXT')}
            className="p-2 rounded-full hover:bg-[var(--admin-hover)] transition-colors"
            title="Sau"
          >
            <ChevronRight size={20} />
          </button>
        </div>

        {/* Label (Th√°ng 12, 2025) */}
        <h2 className="text-xl font-normal text-[var(--admin-fg)] min-w-[150px]">
          {getCustomLabel()}
        </h2>
      </div>

      {/* RIGHT: View Switcher & Settings */}
      <div className="flex items-center gap-3">
        {/* Search & Settings Icons (Mockup UI) */}
        {/* <div className="flex items-center gap-2 text-[var(--admin-sub)] mr-2">
            <button className="p-2 hover:bg-[var(--admin-hover)] rounded-full"><span className="sr-only">Search</span>üîç</button>
            <button className="p-2 hover:bg-[var(--admin-hover)] rounded-full"><span className="sr-only">Settings</span>‚öôÔ∏è</button>
        </div> */}

        {/* View Dropdown */}
        <div className="relative" ref={menuRef}>
          <button 
            onClick={() => setIsViewMenuOpen(!isViewMenuOpen)}
            className="flex items-center gap-2 px-3 py-2 text-sm font-medium border border-[var(--admin-border)] rounded hover:bg-[var(--admin-hover)] transition-colors text-[var(--admin-fg)] bg-[var(--admin-card)] min-w-[100px] justify-between"
          >
            <span>{viewLabels[view] || view}</span>
            <ChevronDown size={14} className="opacity-70" />
          </button>

          {isViewMenuOpen && (
            <div className="absolute right-0 top-full mt-1 w-40 bg-[var(--admin-card)] border border-[var(--admin-border)] rounded shadow-lg z-50 py-1">
              {[Views.DAY, Views.WEEK, Views.MONTH, Views.AGENDA].map((v) => (
                <button
                  key={v}
                  onClick={() => handleViewChange(v)}
                  className={`w-full text-left px-4 py-2 text-sm hover:bg-[var(--admin-hover)] flex items-center justify-between
                    ${view === v ? 'bg-[var(--admin-primary)]/10 text-[var(--admin-primary)]' : 'text-[var(--admin-fg)]'}
                  `}
                >
                   {viewLabels[v]}
                   {view === v && <span>‚úì</span>}
                </button>
              ))}
            </div>
          )}
        </div>
      </div>
    </div>
  )
}
```

## File: src/components/admin/CreateStaffModal.tsx
```typescript
// src/components/admin/CreateStaffModal.tsx
'use client';

import React, { useState } from 'react';
import { Loader2, Mail, User, Lock, Shield } from 'lucide-react';
import { toast } from 'sonner';
import { createStaffAccount } from '@/lib/actions';
// Import ModalPortal m·ªõi
import ModalPortal from '@/components/ui/ModalPortal';

interface CreateStaffModalProps {
  isOpen: boolean;
  onClose: () => void;
}

export default function CreateStaffModal({ isOpen, onClose }: CreateStaffModalProps) {
  const [isLoading, setIsLoading] = useState(false);
  const [formData, setFormData] = useState({
    fullName: '',
    email: '',
    password: '123@123',
    role: 'Staff'
  });

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsLoading(true);
    
    try {
      const res = await createStaffAccount(formData);
      if (res.success) {
        toast.success('T·∫°o t√†i kho·∫£n nh√¢n vi√™n th√†nh c√¥ng!');
        setFormData({ fullName: '', email: '', password: '', role: 'Staff' }); 
        onClose(); 
      } else {
        toast.error(`L·ªói: ${res.error}`);
      }
    } catch (error) {
        const message = error instanceof Error ? error.message : 'C√≥ l·ªói x·∫£y ra.';
        toast.error(message);
    } finally {
      setIsLoading(false);
    }
  };

  // D√πng ModalPortal bao b·ªçc Form
  return (
    <ModalPortal 
      isOpen={isOpen} 
      onClose={isLoading ? () => {} : onClose} 
      title="Th√™m Nh√¢n vi√™n M·ªõi"
      className="max-w-md" // Ch·ªânh ƒë·ªô r·ªông ·ªü ƒë√¢y
    >
      <form onSubmit={handleSubmit} className="p-6 space-y-5">
          
          {/* Input H·ªç t√™n */}
          <div>
            <label className="block text-xs font-bold text-[var(--admin-sub)] uppercase mb-1.5">H·ªç v√† T√™n</label>
            <div className="relative group">
                <User className="absolute left-3 top-2.5 text-[var(--admin-sub)] group-focus-within:text-[var(--admin-primary)] transition-colors" size={18} />
                <input required className="w-full pl-10 p-2.5 rounded-lg bg-[var(--admin-bg)] border border-[var(--admin-border)] text-[var(--admin-fg)] focus:ring-2 focus:ring-[var(--admin-primary)]/20 focus:border-[var(--admin-primary)] outline-none transition-all" 
                    value={formData.fullName} onChange={e => setFormData({...formData, fullName: e.target.value})} placeholder="VD: Nguy·ªÖn VƒÉn A"
                />
            </div>
          </div>

          {/* Input Email */}
          <div>
            <label className="block text-xs font-bold text-[var(--admin-sub)] uppercase mb-1.5">Email ƒêƒÉng nh·∫≠p</label>
            <div className="relative group">
                <Mail className="absolute left-3 top-2.5 text-[var(--admin-sub)] group-focus-within:text-[var(--admin-primary)] transition-colors" size={18} />
                <input required type="email" className="w-full pl-10 p-2.5 rounded-lg bg-[var(--admin-bg)] border border-[var(--admin-border)] text-[var(--admin-fg)] focus:ring-2 focus:ring-[var(--admin-primary)]/20 focus:border-[var(--admin-primary)] outline-none transition-all" 
                    value={formData.email} onChange={e => setFormData({...formData, email: e.target.value})} placeholder="nhanvien@onistudio.com"
                />
            </div>
          </div>

          {/* Input Password */}
          <div>
            <label className="block text-xs font-bold text-[var(--admin-sub)] uppercase mb-1.5">M·∫≠t kh·∫©u m·∫∑c ƒë·ªãnh</label>
            <div className="relative group">
                <Lock className="absolute left-3 top-2.5 text-[var(--admin-sub)] group-focus-within:text-[var(--admin-primary)] transition-colors" size={18} />
                <input required type="text" className="w-full pl-10 p-2.5 rounded-lg bg-[var(--admin-bg)] border border-[var(--admin-border)] text-[var(--admin-fg)] focus:ring-2 focus:ring-[var(--admin-primary)]/20 focus:border-[var(--admin-primary)] outline-none font-mono transition-all" 
                    value={formData.password} onChange={e => setFormData({...formData, password: e.target.value})} placeholder="T·ªëi thi·ªÉu 6 k√Ω t·ª±" minLength={6}
                />
            </div>
            <p className="text-[10px] text-[var(--admin-sub)] mt-1.5 ml-1">* Nh√¢n vi√™n c√≥ th·ªÉ ƒë·ªïi m·∫≠t kh·∫©u sau.</p>
          </div>

          {/* Input Role */}
          <div>
            <label className="block text-xs font-bold text-[var(--admin-sub)] uppercase mb-1.5">Vai tr√≤</label>
            <div className="relative group">
                <Shield className="absolute left-3 top-2.5 text-[var(--admin-sub)] group-focus-within:text-[var(--admin-primary)] transition-colors" size={18} />
                <select className="w-full pl-10 p-2.5 rounded-lg bg-[var(--admin-bg)] border border-[var(--admin-border)] text-[var(--admin-fg)] focus:ring-2 focus:ring-[var(--admin-primary)]/20 focus:border-[var(--admin-primary)] outline-none appearance-none cursor-pointer transition-all"
                    value={formData.role} onChange={e => setFormData({...formData, role: e.target.value})}
                >
                    <option value="Staff">Staff (Nh√¢n vi√™n)</option>
                    <option value="Admin">Admin (Qu·∫£n tr·ªã vi√™n)</option>
                </select>
            </div>
          </div>

          {/* Button Submit */}
          <div className="pt-4">
            <button type="submit" disabled={isLoading} className="w-full py-3 bg-[var(--admin-primary)] text-white rounded-lg font-bold hover:opacity-90 transition-all shadow-lg shadow-indigo-500/30 flex justify-center items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed">
                {isLoading ? <Loader2 className="animate-spin" size={20} /> : 'T·∫°o T√†i Kho·∫£n'}
            </button>
          </div>

      </form>
    </ModalPortal>
  );
}
```

## File: src/components/admin/GrowthChart.tsx
```typescript
// src/components/admin/GrowthChart.tsx
'use client';

import { 
  AreaChart, 
  Area, 
  XAxis, 
  YAxis, 
  CartesianGrid, 
  Tooltip, 
  ResponsiveContainer 
} from 'recharts';
import { MonthlyStat } from '@/lib/actions';

export default function GrowthChart({ data }: { data: MonthlyStat[] }) {
  return (
    <div className="w-full h-[350px] mt-4">
      <ResponsiveContainer width="100%" height="100%">
        <AreaChart data={data} margin={{ top: 10, right: 30, left: 0, bottom: 0 }}>
          <defs>
            {/* Gradient m√†u t√≠m ƒë·∫πp m·∫Øt */}
            <linearGradient id="colorTotal" x1="0" y1="0" x2="0" y2="1">
              <stop offset="5%" stopColor="var(--admin-primary)" stopOpacity={0.3}/>
              <stop offset="95%" stopColor="var(--admin-primary)" stopOpacity={0}/>
            </linearGradient>
          </defs>
          
          <XAxis 
            dataKey="name" 
            stroke="var(--admin-sub)" 
            fontSize={12} 
            tickLine={false} 
            axisLine={false}
          />
          <YAxis 
            stroke="var(--admin-sub)" 
            fontSize={12} 
            tickLine={false} 
            axisLine={false} 
            allowDecimals={false} // Ch·ªâ hi·ªán s·ªë nguy√™n
          />
          
          <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="var(--admin-border)" />
          
          <Tooltip 
            contentStyle={{ 
              backgroundColor: 'var(--admin-card)', 
              borderColor: 'var(--admin-border)', 
              borderRadius: '8px',
              color: 'var(--admin-fg)'
            }}
            itemStyle={{ color: 'var(--admin-primary)' }}
          />
          
          <Area 
            type="monotone" 
            dataKey="total" 
            stroke="var(--admin-primary)" 
            fillOpacity={1} 
            fill="url(#colorTotal)" 
            strokeWidth={3}
          />
        </AreaChart>
      </ResponsiveContainer>
    </div>
  );
}
```

## File: src/components/admin/SortableProjectItem.tsx
```typescript
// src/components/admin/SortableProjectItem.tsx
'use client';

import { useSortable } from '@dnd-kit/sortable';
import { CSS } from '@dnd-kit/utilities';

interface SortableItemProps {
  id: number;
  children: React.ReactNode;
  colSpan: number; // C·∫ßn nh·∫≠n v√†o ƒë·ªÉ set style grid
  rowSpan: number;
}

export function SortableProjectItem({ id, children, colSpan, rowSpan }: SortableItemProps) {
  const {
    attributes,
    listeners,
    setNodeRef,
    transform,
    transition,
    isDragging
  } = useSortable({ id: id });

  const style = {
    transform: CSS.Transform.toString(transform),
    transition,
    gridColumn: `span ${colSpan}`,
    gridRow: `span ${rowSpan}`,
    zIndex: isDragging ? 50 : 'auto', // Khi k√©o th√¨ n·ªïi l√™n tr√™n
    opacity: isDragging ? 0.5 : 1,    // Khi k√©o th√¨ m·ªù ƒëi ch√∫t
  };

  return (
    <div ref={setNodeRef} style={style} {...attributes} {...listeners} className="h-full relative group">
      {children}
    </div>
  );
}
```

## File: src/components/admin/TodaySchedule.tsx
```typescript
'use client';

import { format } from 'date-fns';
import { Calendar, MapPin, User, ArrowRight } from 'lucide-react';
import Link from 'next/link';

interface ScheduleItem {
  booking_item_id: number;
  start_dt: string;
  end_dt: string;
  rooms: { 
    name: string | null; 
    code: string | null; // <-- QUAN TR·ªåNG: Cho ph√©p null
  } | null;
  bookings: {
    status: string | null;
    customers: { full_name: string | null; phone: string | null } | null;
  } | null;
}

export default function TodaySchedule({ bookings }: { bookings: ScheduleItem[] }) {
  if (bookings.length === 0) {
    return (
      <div className="h-full flex flex-col items-center justify-center text-[var(--admin-sub)] opacity-70 min-h-[300px]">
        <Calendar size={48} strokeWidth={1} className="mb-2" />
        <p>H√¥m nay kh√¥ng c√≥ l·ªãch ch·ª•p n√†o.</p>
        <Link 
            href="/admin/calendar" 
            className="mt-4 text-sm text-[var(--admin-primary)] hover:underline flex items-center gap-1"
        >
            T·∫°o booking ngay <ArrowRight size={14} />
        </Link>
      </div>
    );
  }

  return (
    <div className="space-y-4">
      {bookings.map((item) => {
        const startDate = new Date(item.start_dt);
        const endDate = new Date(item.end_dt);
        const status = item.bookings?.status || 'pending';
        
        // M√†u s·∫Øc tr·∫°ng th√°i
        let statusColor = 'bg-gray-100 text-gray-600';
        if (status === 'confirmed') statusColor = 'bg-blue-100 text-blue-600';
        if (status === 'completed') statusColor = 'bg-green-100 text-green-600';
        if (status === 'cancelled') statusColor = 'bg-red-100 text-red-600';

        return (
          <div key={item.booking_item_id} className="flex gap-4 p-3 rounded-xl border border-[var(--admin-border)] bg-[var(--admin-bg)] hover:border-[var(--admin-primary)] transition-colors group">
            
            {/* C·ªôt gi·ªù */}
            <div className="flex flex-col items-center justify-center w-16 p-2 bg-[var(--admin-card)] rounded-lg border border-[var(--admin-border)] shrink-0">
              <span className="text-lg font-bold text-[var(--admin-fg)] leading-none">
                {format(startDate, 'HH:mm')}
              </span>
              <span className="text-[10px] text-[var(--admin-sub)] mt-1">
                ƒë·∫øn {format(endDate, 'HH:mm')}
              </span>
            </div>

            {/* Th√¥ng tin ch√≠nh */}
            <div className="flex-1 min-w-0">
              <div className="flex justify-between items-start">
                <h4 className="font-bold text-[var(--admin-fg)] truncate">
                  {item.bookings?.customers?.full_name || 'Kh√°ch v√£ng lai'}
                </h4>
                <span className={`text-[10px] px-2 py-0.5 rounded-full font-bold uppercase tracking-wider ${statusColor}`}>
                  {status}
                </span>
              </div>
              
              <div className="mt-1 space-y-1">
                <div className="flex items-center gap-2 text-xs text-[var(--admin-sub)]">
                  <MapPin size={12} /> 
                  <span className="font-medium text-[var(--admin-fg)]">
                    {item.rooms?.name || item.rooms?.code || 'Ch∆∞a x·∫øp ph√≤ng'}
                  </span>
                </div>
                {item.bookings?.customers?.phone && (
                    <div className="flex items-center gap-2 text-xs text-[var(--admin-sub)]">
                    <User size={12} /> {item.bookings.customers.phone}
                    </div>
                )}
              </div>
            </div>
          </div>
        );
      })}
      
      <div className="pt-2 text-center">
        <Link href="/admin/calendar" className="text-xs text-[var(--admin-sub)] hover:text-[var(--admin-primary)] hover:underline">
            Xem to√†n b·ªô l·ªãch tr√¨nh &rarr;
        </Link>
      </div>
    </div>
  );
}
```

## File: src/components/progressive-carousel.tsx
```typescript
'use client';

import React, {
  createContext,
  useContext,
  useState,
  useEffect,
  useRef,
  ReactNode,
  FC,
  useCallback, // 1. S·ª¨A L·ªñI: Import th√™m useCallback
} from 'react';
import { motion, AnimatePresence } from 'framer-motion'; // 2. S·ª¨A L·ªñI: Import ƒë√∫ng t·ª´ 'framer-motion'
import { cn } from '@/lib/utils'; // Gi·ªØ nguy√™n code c≈© c·ªßa b·∫°n

// Define the type for the context value
interface ProgressSliderContextType {
  active: string;
  progress: number;
  handleButtonClick: (value: string) => void;
  vertical: boolean;
}

// ... (C√°c interface ProgressSliderProps, SliderContentProps... gi·ªØ nguy√™n) ...
interface ProgressSliderProps {
  children: ReactNode;
  duration?: number;
  fastDuration?: number;
  vertical?: boolean;
  activeSlider: string;
  className?: string;
}

interface SliderContentProps {
  children: ReactNode;
  className?: string;
}

interface SliderWrapperProps {
  children: ReactNode;
  value: string;
  className?: string;
}

interface ProgressBarProps {
  children: ReactNode;
  className?: string;
}

interface SliderBtnProps {
  children: ReactNode;
  value: string;
  className?: string;
  progressBarClass?: string;
}

// Create the context with an undefined initial value
const ProgressSliderContext = createContext<
  ProgressSliderContextType | undefined
>(undefined);

export const useProgressSliderContext = (): ProgressSliderContextType => {
  const context = useContext(ProgressSliderContext);
  if (!context) {
    throw new Error(
      'useProgressSliderContext must be used within a ProgressSlider'
    );
  }
  return context;
};

export const ProgressSlider: FC<ProgressSliderProps> = ({
  children,
  duration = 5000,
  fastDuration = 400,
  vertical = false,
  activeSlider,
  className,
}) => {
  const [active, setActive] = useState<string>(activeSlider);
  const [progress, setProgress] = useState<number>(0);
  const [isFastForward, setIsFastForward] = useState<boolean>(false);
  const frame = useRef<number>(0);
  const firstFrameTime = useRef<number>(performance.now());
  const targetValue = useRef<string | null>(null);
  const [sliderValues, setSliderValues] = useState<string[]>([]);

  useEffect(() => {
    // 3. S·ª¨A L·ªñI 'unknown': Th√™m type c·ª• th·ªÉ
    const getChildren = React.Children.toArray(children).find(
      (child) => (child as React.ReactElement).type === SliderContent
    ) as React.ReactElement<SliderContentProps> | undefined; // Th√™m type cho props

    if (getChildren) {
      const values = React.Children.toArray(getChildren.props.children).map(
        (child) =>
          (child as React.ReactElement<SliderWrapperProps>).props.value // Th√™m type cho props
      );
      setSliderValues(values);
    }
  }, [children]);

  // 4. S·ª¨A L·ªñI 'missing dependency' V√Ä L·ªñI "ƒê·ª®NG":
  // B·ªçc 'animate' trong 'useCallback'
  const animate = useCallback(
    (now: number) => {
      const currentDuration = isFastForward ? fastDuration : duration;
      const elapsedTime = now - firstFrameTime.current;
      const timeFraction = elapsedTime / currentDuration;

      if (timeFraction <= 1) {
        // D√πng functional update ƒë·ªÉ tr√°nh 'progress' b·ªã stale
        setProgress((prevProgress) =>
          isFastForward
            ? prevProgress + (100 - prevProgress) * timeFraction
            : timeFraction * 100
        );
        frame.current = requestAnimationFrame(animate);
      } else {
        if (isFastForward) {
          setIsFastForward(false); // D√πng setter
          if (targetValue.current !== null) {
            setActive(targetValue.current); // D√πng setter
            targetValue.current = null;
          }
        } else {
          // Move to the next slide
          const currentIndex = sliderValues.indexOf(active);
          const nextIndex = (currentIndex + 1) % sliderValues.length;
          setActive(sliderValues[nextIndex]); // D√πng setter
        }
        setProgress(0); // D√πng setter
        firstFrameTime.current = performance.now();
      }
    },
    [
      isFastForward,
      fastDuration,
      duration,
      sliderValues,
      active,
      // C√°c h√†m setter (setActive, setProgress...) l√† ·ªïn ƒë·ªãnh, kh√¥ng c·∫ßn ƒë∆∞a v√†o
    ]
  );

  useEffect(() => {
    if (sliderValues.length > 0) {
      firstFrameTime.current = performance.now();
      frame.current = requestAnimationFrame(animate);
    }
    return () => {
      cancelAnimationFrame(frame.current);
    };
  }, [sliderValues, active, isFastForward, animate]); // Th√™m 'animate' v√†o ƒë√¢y

  const handleButtonClick = (value: string) => {
    if (value !== active) {
      const elapsedTime = performance.now() - firstFrameTime.current;
      const currentProgress = (elapsedTime / duration) * 100;
      setProgress(currentProgress);
      targetValue.current = value;
      setIsFastForward(true);
      firstFrameTime.current = performance.now();
    }
  };

  return (
    <ProgressSliderContext.Provider
      value={{ active, progress, handleButtonClick, vertical }}
    >
      <div className={cn('relative', className)}>{children}</div>
    </ProgressSliderContext.Provider>
  );
};

export const SliderContent: FC<SliderContentProps> = ({
  children,
  className,
}) => {
  return <div className={cn('', className)}>{children}</div>;
};

export const SliderWrapper: FC<SliderWrapperProps> = ({
  children,
  value,
  className,
}) => {
  const { active } = useProgressSliderContext();

  return (
    <AnimatePresence mode="popLayout">
      {active === value && (
        <motion.div
          key={value}
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          exit={{ opacity: 0 }}
          className={cn('', className)}
        >
          {children}
        </motion.div>
      )}
    </AnimatePresence>
  );
};

export const SliderBtnGroup: FC<ProgressBarProps> = ({
  children,
  className,
}) => {
  return <div className={cn('', className)}>{children}</div>;
};

export const SliderBtn: FC<SliderBtnProps> = ({
  children,
  value,
  className,
  progressBarClass,
}) => {
  const { active, progress, handleButtonClick, vertical } =
    useProgressSliderContext();

  return (
    <button
      className={cn(
        `relative ${active === value ? 'opacity-100' : 'opacity-50'}`,
        className
      )}
      onClick={() => handleButtonClick(value)}
    >
      {children}
      <div
        className="absolute inset-0 overflow-hidden -z-10 max-h-full max-w-full "
        role="progressbar"
        aria-valuenow={active === value ? progress : 0}
      >
        <span
          className={cn('absolute left-0 ', progressBarClass)}
          style={{
            [vertical ? 'height' : 'width']:
              active === value ? `${progress}%` : '0%',
          }}
        />
      </div>
    </button>
  );
};
```

## File: src/components/ProjectMasonryGrid.tsx
```typescript
// src/components/ProjectMasonryGrid.tsx
'use client';

import Image from 'next/image';
import Link from 'next/link';
import { ArrowUpRight } from 'lucide-react';
import { ProjectData } from '@/data/projects-master-data';

// ƒê·ªãnh nghƒ©a 3 ki·ªÉu Layout
type LayoutVariant = 'flat' | 'staggered' | 'cascade';

interface GridProps {
  projects: ProjectData[];
  variant?: LayoutVariant; // Prop m·ªõi ƒë·ªÉ ch·ªçn ki·ªÉu
}

const distributeProjects = (items: ProjectData[], cols: number) => {
  const columns: ProjectData[][] = Array.from({ length: cols }, () => []);
  items.forEach((item, i) => {
    columns[i % cols].push(item);
  });
  return columns;
};

export default function ProjectMasonryGrid({ projects, variant = 'staggered' }: GridProps) {
  const mobileProjects = projects;
  const tabletCols = distributeProjects(projects, 2);
  const desktopCols = distributeProjects(projects, 3);

  // --- LOGIC T√çNH TO√ÅN KHO·∫¢NG C√ÅCH (PADDING TOP) ---
  
  // 1. Ki·ªÉu 'flat' (Th∆∞∆°ng m·∫°i): Th·∫≥ng t·∫Øp, kh√¥ng l·ªách
  const getFlatPadding = () => 'pt-0';

  // 2. Ki·ªÉu 'staggered' (Th·ªùi trang): L·ªách c·ªôt gi·ªØa (So le)
  const getStaggeredPadding = (colIndex: number, totalCols: number) => {
    // N·∫øu 3 c·ªôt -> C·ªôt gi·ªØa (index 1) l·ªách xu·ªëng 36px
    if (totalCols === 3 && colIndex === 1) return 'pt-[36px]';
    // N·∫øu 2 c·ªôt -> C·ªôt ph·∫£i (index 1) l·ªách xu·ªëng 36px
    if (totalCols === 2 && colIndex === 1) return 'pt-[36px]';
    return 'pt-0';
  };

  // 3. Ki·ªÉu 'cascade' (C√° nh√¢n): B·∫≠c thang (0 -> 40 -> 80px)
  const getCascadePadding = (colIndex: number) => {
    // C·ªôt 1: 0px, C·ªôt 2: 40px, C·ªôt 3: 80px
    if (colIndex === 0) return 'pt-0';
    if (colIndex === 1) return 'pt-[40px]';
    if (colIndex === 2) return 'pt-[80px]';
    return 'pt-0';
  };

  // H√†m ch·ªçn style d·ª±a tr√™n variant
  const getPaddingClass = (colIndex: number, totalCols: number) => {
    if (variant === 'flat') return getFlatPadding();
    if (variant === 'cascade') return getCascadePadding(colIndex);
    return getStaggeredPadding(colIndex, totalCols);
  };

  // --- END LOGIC ---

  const ProjectCard = ({ project, priority = false }: { project: ProjectData, priority?: boolean }) => (
    <Link 
      href={`/du-an/${project.slug}`}
      className="relative block overflow-hidden bg-gray-100 dark:bg-neutral-900 group mb-6 transition-all duration-300 hover:shadow-xl"
    >
      {project.isFeatured && (
        <div className="absolute top-3 right-3 z-20 bg-[var(--foreground)] text-[var(--background)] text-[10px] font-bold uppercase px-2 py-1 rounded shadow-sm">
          N·ªïi b·∫≠t
        </div>
      )}
      <Image
        src={typeof project.image === 'string' ? project.image : project.image.src}
        alt={project.title}
        width={0} height={0} sizes="(max-width: 768px) 100vw, 33vw"
        className="w-full h-auto block transition-transform duration-700 group-hover:scale-105"
        unoptimized
        priority={priority}
      />
      <div className="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-6">
        <div className="transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300">
          <span className="text-xs font-medium text-white/80 uppercase tracking-wider mb-2 block">{project.year}</span>
          <div className="flex justify-between items-center">
            <h3 className="text-xl font-bold text-white line-clamp-2">{project.title}</h3>
            <div className="bg-white/20 p-2 rounded-full backdrop-blur-sm shrink-0 ml-2"><ArrowUpRight className="text-white w-5 h-5" /></div>
          </div>
        </div>
      </div>
    </Link>
  );

  return (
    <div>
        {/* MOBILE (1 C·ªôt - Lu√¥n th·∫≥ng) */}
        <div className="block md:hidden space-y-6">
          {mobileProjects.map((p, index) => <ProjectCard key={p.id} project={p} priority={index < 2}/>)}
        </div>

        {/* TABLET (2 C·ªôt) */}
        <div className="hidden md:grid lg:hidden grid-cols-2 gap-6 items-start">
          {tabletCols.map((colProjects, colIndex) => (
            <div key={colIndex} className={`flex flex-col ${getPaddingClass(colIndex, 2)}`}>
              {colProjects.map((p, index) => <ProjectCard key={p.id} project={p} priority={index === 0} />)}
            </div>
          ))}
        </div>

        {/* DESKTOP (3 C·ªôt) */}
        <div className="hidden lg:grid grid-cols-3 gap-6 items-start">
          {desktopCols.map((colProjects, colIndex) => (
            <div key={colIndex} className={`flex flex-col ${getPaddingClass(colIndex, 3)}`}>
              {colProjects.map((p, index) => <ProjectCard key={p.id} project={p} priority={index === 0} />)}
            </div>
          ))}
        </div>
    </div>
  );
}
```

## File: src/components/scroll-text-marque.tsx
```typescript
// src/components/ui/scroll-text-marque.tsx
'use client';

import React from 'react';
import {
  motion,
  useAnimationFrame,
  useMotionValue,
  useTransform,
  wrap,
} from 'framer-motion';
import { cn } from '@/lib/utils'; // Gi·∫£ ƒë·ªãnh b·∫°n ƒë√£ c√≥ file n√†y

interface ScrollBaseAnimationProps {
  children: React.ReactNode;
  baseVelocity: number;
  className?: string;
  delay?: number; // Prop 'delay' t·ª´ v√≠ d·ª• c·ªßa b·∫°n
}

export default function ScrollBaseAnimation({
  children,
  baseVelocity = 100, // T·ªëc ƒë·ªô m·∫∑c ƒë·ªãnh
  className,
}: ScrollBaseAnimationProps) {
  // useMotionValue ƒë·ªÉ l∆∞u gi√° tr·ªã 'x'
  const baseX = useMotionValue(0);

  // useAnimationFrame l√† m·ªôt v√≤ng l·∫∑p (loop) ƒë∆∞·ª£c t·ªëi ∆∞u h√≥a
  // N√≥ ch·∫°y li√™n t·ª•c, c·∫≠p nh·∫≠t gi√° tr·ªã 'x'
  useAnimationFrame((time, delta) => {
    // T√≠nh to√°n qu√£ng ƒë∆∞·ªùng di chuy·ªÉn d·ª±a tr√™n velocity
    // (delta l√† th·ªùi gian k·ªÉ t·ª´ frame cu·ªëi, ~16ms)
    
    // S·ª¨A L·ªñI: ƒê·ªïi 'let' th√†nh 'const' v√¨ n√≥ kh√¥ng bao gi·ªù ƒë∆∞·ª£c g√°n l·∫°i
    const moveBy = baseVelocity * (delta / 1000);
    
    // 'wrap' l√† m·ªôt h√†m c·ªßa Framer Motion gi√∫p l·∫∑p l·∫°i gi√° tr·ªã
    // Khi 'x' ƒë·∫°t -50%, n√≥ s·∫Ω reset v·ªÅ 0, t·∫°o v√≤ng l·∫∑p v√¥ t·∫≠n
    baseX.set(wrap(0, -50, baseX.get() + moveBy));
  });

  // Chuy·ªÉn gi√° tr·ªã s·ªë (v√≠ d·ª•: -10) th√†nh ƒë∆°n v·ªã CSS (v√≠ d·ª•: "-10%")
  const x = useTransform(baseX, (v) => `${v}%`);

  return (
    // 'overflow-hidden' l√† b·∫Øt bu·ªôc ƒë·ªÉ "c·∫Øt" ph·∫ßn text b·ªã ·∫©n
    <div
      className="relative w-full overflow-hidden whitespace-nowrap"
    >
      {/* 'motion.div' s·∫Ω di chuy·ªÉn theo gi√° tr·ªã 'x' */}
      <motion.div
        className={cn('flex', className)} // √Åp d·ª•ng className (font-bold, etc.) ·ªü ƒë√¢y
        style={{ x }}
      >
        {/* Ch√∫ng ta l·∫∑p l·∫°i n·ªôi dung 4 l·∫ßn ƒë·ªÉ ƒë·∫£m b·∫£o
          lu√¥n l·∫•p ƒë·∫ßy m√†n h√¨nh, t·∫°o hi·ªáu ·ª©ng li·ªÅn m·∫°ch
        */}
        <span className="inline-block mr-8">{children}</span>
        <span className="inline-block mr-8">{children}</span>
        <span className="inline-block mr-8">{children}</span>
        <span className="inline-block mr-8">{children}</span>
      </motion.div>
    </div>
  );
}
```

## File: src/components/Spinner.tsx
```typescript
// src/components/Spinner.tsx

/**
 * M·ªôt component spinner ƒë∆°n gi·∫£n d√πng Tailwind.
 */
export default function Spinner() {
  return (
    <div className="loader">
      <span className="sr-only">ƒêang t·∫£i...</span>
    </div>
  );
}
```

## File: src/components/ui/ModalPortal.tsx
```typescript
// src/components/ui/ModalPortal.tsx
'use client';

import { useEffect, useState } from 'react';
import { createPortal } from 'react-dom';
import { X } from 'lucide-react';

interface ModalPortalProps {
  isOpen: boolean;
  onClose: () => void;
  children: React.ReactNode;
  title?: string;
  className?: string; // ƒê·ªÉ custom width t√πy √Ω (sm, md, lg, xl)
}

export default function ModalPortal({ 
  isOpen, 
  onClose, 
  children, 
  title,
  className = "max-w-md" // M·∫∑c ƒë·ªãnh ƒë·ªô r·ªông
}: ModalPortalProps) {
  const [mounted, setMounted] = useState(false);

  useEffect(() => {
    setMounted(true);
    // Kh√≥a cu·ªôn trang khi m·ªü Modal
    if (isOpen) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = 'unset';
    }
    return () => {
      document.body.style.overflow = 'unset';
    };
  }, [isOpen]);

  // Ch·ªâ render khi ƒë√£ mount client-side v√† isOpen = true
  if (!mounted || !isOpen) return null;

  // D√πng createPortal ƒë·ªÉ ƒë·∫©y Modal ra t·∫≠n body
  return createPortal(
    <div className="fixed inset-0 z-[9999] flex items-center justify-center p-4 sm:p-6">
      
      {/* 1. Backdrop (N·ªÅn t·ªëi m·ªù to√†n m√†n h√¨nh) */}
      <div 
        className="fixed inset-0 bg-black/70 backdrop-blur-sm transition-opacity animate-fade-in" 
        onClick={onClose}
      />

      {/* 2. Modal Container (N·ªïi l√™n tr√™n c√πng) */}
      <div className={`relative w-full ${className} bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-2xl shadow-2xl flex flex-col overflow-hidden animate-zoom-in z-50`}>
        
        {/* Header (N·∫øu c√≥ title th√¨ hi·ªán, kh√¥ng th√¨ th√¥i) */}
        {title && (
          <div className="flex items-center justify-between p-6 border-b border-[var(--admin-border)] bg-[var(--admin-bg)]/50">
            <h3 className="text-lg font-bold text-[var(--admin-fg)]">{title}</h3>
            <button 
              onClick={onClose}
              className="text-[var(--admin-sub)] hover:text-[var(--admin-fg)] p-2 hover:bg-[var(--admin-hover)] rounded-full transition-colors"
            >
              <X size={20} />
            </button>
          </div>
        )}

        {/* N√∫t ƒë√≥ng nhanh n·∫øu kh√¥ng c√≥ header */}
        {!title && (
           <button 
            onClick={onClose}
            className="absolute top-4 right-4 p-2 text-[var(--admin-sub)] hover:text-[var(--admin-fg)] hover:bg-[var(--admin-hover)] rounded-full transition-colors z-10"
          >
            <X size={20} />
          </button>
        )}

        {/* Content */}
        <div>
          {children}
        </div>
      </div>
    </div>,
    document.body // G·∫Øn v√†o body
  );
}
```

## File: src/context/CalendarContext.tsx
```typescript
'use client';

import React, { createContext, useContext, useState, ReactNode } from 'react';

interface CalendarContextType {
  date: Date;
  setDate: (date: Date) => void;
  visibleRoomIds: number[];
  setVisibleRoomIds: (ids: number[]) => void;
  toggleRoomVisibility: (roomId: number) => void;
  isCreateModalOpen: boolean;
  setCreateModalOpen: (isOpen: boolean) => void;
}

const CalendarContext = createContext<CalendarContextType | undefined>(undefined);

export function CalendarProvider({ children }: { children: ReactNode }) {
  const [date, setDate] = useState(new Date());
  // M·∫∑c ƒë·ªãnh l√† m·∫£ng r·ªóng (s·∫Ω ƒë∆∞·ª£c component con check v√† fill all n·∫øu r·ªóng l·∫ßn ƒë·∫ßu)
  const [visibleRoomIds, setVisibleRoomIds] = useState<number[]>([]); 
  const [isCreateModalOpen, setCreateModalOpen] = useState(false);

  const toggleRoomVisibility = (roomId: number) => {
    setVisibleRoomIds(prev => {
      if (prev.includes(roomId)) {
        return prev.filter(id => id !== roomId);
      } else {
        return [...prev, roomId];
      }
    });
  };

  return (
    <CalendarContext.Provider value={{
      date,
      setDate,
      visibleRoomIds,
      setVisibleRoomIds,
      toggleRoomVisibility,
      isCreateModalOpen,
      setCreateModalOpen,
    }}>
      {children}
    </CalendarContext.Provider>
  );
}

export function useCalendar() {
  const context = useContext(CalendarContext);
  if (context === undefined) {
    throw new Error('useCalendar must be used within a CalendarProvider');
  }
  return context;
}
```

## File: src/data/bts.ts
```typescript
import type { StaticImageData } from 'next/image'; // Import ki·ªÉu n√†y
import btsImage1 from '../assets/section_04/bts_01.jpg'; 
import btsImage2 from '../assets/section_04/bts_02.jpg'; 
import btsImage3 from '../assets/section_04/bts_03.jpg'; 
import btsImage4 from '../assets/section_04/bts_04.jpg'; 
import btsImage5 from '../assets/section_04/bts_05.jpg'; 
import btsImage6 from '../assets/section_04/bts_06.jpg'; 

export interface BTS {
  title: string;
  imageUrl: StaticImageData | string;
  description: string;
  client?: string; // client c√≥ th·ªÉ kh√¥ng b·∫Øt bu·ªôc
  year?: string;
  location?: string;
}
const projects: BTS[] = 
[
{
    title: 'S·ª± Th·ª©c T·ªânh C·ªßa V·ªá N·ªØ',
    imageUrl: btsImage1, 
    description: 'ƒê√¢y l√† m·ªôt concept "V·ªá N·ªØ t√°i sinh" ƒë·∫ßy tham v·ªçng, th·ª±c hi·ªán 100% trong studio. Th·ª≠ th√°ch l·ªõn nh·∫•t l√† ph·∫£i "th·ªïi h·ªìn" v√†o m·ªôt b·ªëi c·∫£nh ho√†n to√†n nh√¢n t·∫°o, k·∫øt h·ª£p ph√¥ng n·ªÅn in kh·ªï l·ªõn v·ªõi m√¥ h√¨nh v·ªè s√≤ ƒëi√™u kh·∫Øc. C√°i kh√≥ nh·∫•t l√† l√†m ch·ªß chuy·ªÉn ƒë·ªông: m·ªôt chi·∫øc qu·∫°t c√¥ng su·∫•t l·ªõn (th·∫•y ·ªü ti·ªÅn c·∫£nh) ƒë∆∞·ª£c d√πng li√™n t·ª•c ƒë·ªÉ t·∫°o hi·ªáu ·ª©ng t√≥c v√† t√† v√°y bay l∆∞·ª£n. Ekip ƒë√£ ph·∫£i "ƒë√≥ng bƒÉng" kho·∫£nh kh·∫Øc ƒë√≥, trong khi chuy√™n gia (nh∆∞ trong ·∫£nh) li√™n t·ª•c tinh ch·ªânh t·ª´ng chi ti·∫øt nh·ªè ƒë·ªÉ ƒë·∫°t ƒë·ªô ho√†n h·∫£o nh·∫•t.',
    client: 'T·∫°p ch√≠ Harper\'s Bazaar',
    year: '2024',
    location: 'Oni Studio, TP.HCM',
  },
  {
    title: 'Chuy·ªÉn ƒê·ªông T·ªëi Gi·∫£n',
    imageUrl: btsImage2, 
    description: 'Concept l√† m·ªôt b·ªô lookbook th·ªùi trang t·ªëi gi·∫£n. Th·ª≠ th√°ch l·ªõn nh·∫•t v·ªõi ph√¥ng n·ªÅn x√°m tr∆°n l√† l√†m sao ƒë·ªÉ ch·ªß th·ªÉ v√† trang ph·ª•c kh√¥ng b·ªã "ph·∫≥ng" hay nh√†m ch√°n. √Ånh s√°ng ch√≠nh l√† ch√¨a kh√≥a. Ch√∫ng t√¥i d√πng m·ªôt set-up 3 ƒë√®n: m·ªôt key-light l·ªõn (b√™n tr√°i) ƒë·ªÉ t·∫°o kh·ªëi, m·ªôt fill-light nh·∫π (b√™n ph·∫£i, nh∆∞ tr·ª£ l√Ω ƒëang gi·ªØ) ƒë·ªÉ l√†m m·ªÅm b√≥ng ƒë·ªï. M·∫•u ch·ªët l√† m·ªôt ƒë√®n rim-light (ƒë√®n vi·ªÅn) t·ª´ ph√≠a sau ƒë·ªÉ t√°ch ng∆∞·ªùi m·∫´u kh·ªèi n·ªÅn, l√†m n·ªïi b·∫≠t chi ti·∫øt l√¥ng v≈© tr√™n tay √°o. C·∫£ ekip ƒë√£ l√†m vi·ªác li√™n t·ª•c ƒë·ªÉ t√¨m ra nh·ªØng d√°ng pose s·∫Øc s·∫£o nh·∫•t.',
    client: 'Zara Studio Lookbook',
    year: '2024',
    location: 'Oni Studio, TP.HCM',
  },
  {
    title: 'Chi·∫øn Binh C∆° Kh√≠',
    imageUrl: btsImage3,
    description: 'Th·ª≠ th√°ch l·ªõn nh·∫•t khi ch·ª•p s·∫£n ph·∫©m c∆° kh√≠, ƒë·∫∑c bi·ªát l√† m·ªôt chi·∫øc Harley, l√† ki·ªÉm so√°t s·ª± ph·∫£n chi·∫øu. B·ªÅ m·∫∑t chrome v√† s∆°n b√≥ng lo√°ng nh∆∞ m·ªôt t·∫•m g∆∞∆°ng. Ch√∫ng t√¥i ph·∫£i di chuy·ªÉn xe v√†o studio m·ªôt c√°ch c·∫©n th·∫≠n v√† set up nhi·ªÅu ngu·ªìn s√°ng khu·∫øch t√°n l·ªõn (nh∆∞ softbox trong ·∫£nh) ƒë·ªÉ "v·∫Ω" n√™n nh·ªØng ƒë∆∞·ªùng highlight m·ªÅm m·∫°i, l√†m n·ªïi b·∫≠t ƒë∆∞·ªùng cong c·ªßa xe m√† kh√¥ng t·∫°o ra c√°c ƒëi·ªÉm ch√°y s√°ng g·∫Øt. C·∫£ ekip ƒë√£ ph·∫£i t·ªâ m·ªâ xoay ƒë√®n t·ª´ng ch√∫t m·ªôt ƒë·ªÉ ƒë·∫£m b·∫£o m·ªçi chi ti·∫øt t·ª´ ƒë·ªông c∆° ƒë·∫øn ·ªëng x·∫£ ƒë·ªÅu hi·ªán l√™n s·∫Øc n√©t.',
    client: 'Harley-Davidson Vietnam',
    year: '2023',
    location: 'Oni Studio, TP.HCM',
  },
  {
    title: 'Ph·ªèng V·∫•n "High-Key"',
    imageUrl: btsImage4,
    description: 'ƒê√¢y l√† m·ªôt bu·ªïi quay ph·ªèng v·∫•n/ talkshow v·ªõi set-up "high-key" (n·ªÅn tr·∫Øng s√°ng). C√°i kh√≥ c·ªßa k·ªπ thu·∫≠t n√†y l√† ph·∫£i chi·∫øu s√°ng ph√¥ng n·ªÅn tr·∫Øng ph√≠a sau th·∫≠t ƒë·ªÅu v√† ch√°y s√°ng h∆°n ch·ªß th·ªÉ, trong khi v·∫´n ph·∫£i gi·ªØ chi ti·∫øt v√† √°nh s√°ng ƒë·∫πp tr√™n nh√¢n v·∫≠t. Nh∆∞ trong ·∫£nh, ekip ƒëang tinh ch·ªânh nhi·ªÅu ngu·ªìn s√°ng: m·ªôt softbox (key-light) cho ch·ªß th·ªÉ v√† c√°c ƒë√®n kh√°c cho n·ªÅn. Ch√∫ng t√¥i c≈©ng s·ª≠ d·ª•ng m·ªôt m√°y t·∫°o kh√≥i nh·∫π (b√™n ph·∫£i) ƒë·ªÉ t·∫°o kh√¥ng kh√≠, gi√∫p √°nh s√°ng c√≥ chi·ªÅu s√¢u h∆°n v√† kh√¥ng gian tr·∫Øng kh√¥ng b·ªã "b·∫±ng ph·∫≥ng".',
    client: 'Ch∆∞∆°ng tr√¨nh "Insight" - VTV',
    year: '2023',
    location: 'Oni Studio, TP.HCM',
  },
  {
    title: 'K·ªπ Thu·∫≠t "Ghost Mannequin"',
    imageUrl: btsImage5,
    description: 'ƒê√¢y l√† m·ªôt bu·ªïi ch·ª•p s·∫£n ph·∫©m e-commerce ƒë√≤i h·ªèi k·ªπ thu·∫≠t cao. M·ª•c ti√™u l√† l√†m chi·∫øc √°o "v√¥ h√¨nh" ng∆∞·ªùi m·∫∑c ƒë·ªÉ gi·ªØ nguy√™n phom d√°ng. Th·ª≠ th√°ch l√† ph·∫£i treo s·∫£n ph·∫©m b·∫±ng s·ª£i c∆∞·ªõc si√™u m·ªèng (nh∆∞ trong ·∫£nh) v√† ƒë·∫£m b·∫£o √°o kh√¥ng b·ªã xoay. √Ånh s√°ng ph·∫£i th·∫≠t ƒë·ªÅu ƒë·ªÉ th·ªÉ hi·ªán ƒë√∫ng ch·∫•t li·ªáu v·∫£i. Ch√∫ng t√¥i d√πng m·ªôt softbox parabol l·ªõn (b√™n ph·∫£i) l√†m ƒë√®n ch√≠nh v√† m·ªôt ƒë√®n ph·ª• t·ª´ tr√™n cao (g·∫Øn tr√™n boom) ƒë·ªÉ l√†m n·ªïi b·∫≠t chi ti·∫øt vai √°o, gi√∫p kh√¢u h·∫≠u k·ª≥ gh√©p ·∫£nh (ch·ª•p trong, ch·ª•p ngo√†i) d·ªÖ d√†ng h∆°n.',
    client: 'Uniqlo Vietnam',
    year: '2023',
    location: 'Oni Studio, TP.HCM',
  },
  {
    title: 'V·∫ª ƒê·∫πp Tinh Khi·∫øt',
    imageUrl: btsImage6,
    description: 'Ch·ª•p s·∫£n ph·∫©m m·ªπ ph·∫©m lu√¥n l√† m·ªôt th·ª≠ th√°ch v·ªÅ ki·ªÉm so√°t √°nh s√°ng. C√°i kh√≥ nh·∫•t l√† x·ª≠ l√Ω b·ªÅ m·∫∑t chai l·ªç b√≥ng, d·ªÖ b·ªã ph·∫£n chi·∫øu l·ªôn x·ªôn. Ch√∫ng t√¥i ƒë√£ ph·∫£i t·∫°o m·ªôt "l·ªÅu" √°nh s√°ng mini (h·ªôp tr·∫Øng ·ªü gi·ªØa) ƒë·ªÉ bao b·ªçc s·∫£n ph·∫©m. √Ånh s√°ng ƒë∆∞·ª£c set-up t·ªâ m·ªâ: m·ªôt softbox l·ªõn (b√™n tr√°i) cho √°nh s√°ng ch√≠nh, m·ªôt t·∫•m h·∫Øt s√°ng v√†ng (b√™n ph·∫£i) ƒë·ªÉ t·∫°o vi·ªÅn ·∫•m √°p cho s·∫£n ph·∫©m, v√† m·ªôt ƒë√®n top-light (tr√™n cao) ƒë·ªÉ l√†m n·ªïi b·∫≠t n·∫Øp chai. C·∫£ ekip (nh∆∞ b·∫°n th·∫•y) ƒëang theo d√µi tr·ª±c ti·∫øp qua m√°y t√≠nh (tethering) ƒë·ªÉ tinh ch·ªânh t·ª´ng milimet.',
    client: 'C·ªè M·ªÅm HomeLab',
    year: '2023',
    location: 'Oni Studio, TP.HCM',
  }
];

export default projects;
```

## File: src/lib/actions/booking-details.ts
```typescript
// src/lib/actions/booking-details.ts
'use server'

import { createClient } from '@/lib/supabase/server'
import { revalidatePath } from 'next/cache'

// 1. L·∫•y chi ti·∫øt Booking
export async function getBookingDetails(bookingId: number) {
  const supabase = await createClient();
  
  const { data, error } = await supabase
    .from('bookings')
    .select(`
      *,
      customers (*),
      booking_items (
        *, 
        rooms (name, code)
      ),
      booking_services (
        *, 
        services (name, price, unit, category)
      )
    `)
    .eq('booking_id', bookingId)
    .single();

  if (error) return { success: false, error: error.message };
  return { success: true, data };
}

// 2. Th√™m d·ªãch v·ª•
export async function addBookingService(bookingId: number, serviceId: number, quantity: number, price: number) {
  const supabase = await createClient();

  const { error } = await supabase.from('booking_services').insert({
    booking_id: bookingId,
    service_id: serviceId,
    quantity: quantity,
    unit_price_snapshot: price,
    computed_amount: quantity * price,
    type: 'surcharge' 
  });
  
  if (error) return { success: false, error: error.message };
  revalidatePath('/admin');
  return { success: true };
}

// 3. X√≥a d·ªãch v·ª•
export async function removeBookingService(bookingServiceId: number) {
  const supabase = await createClient();
  const { error } = await supabase.from('booking_services').delete().eq('booking_service_id', bookingServiceId);
  
  if (error) return { success: false, error: error.message };
  revalidatePath('/admin');
  return { success: true };
}

// ƒê·ªãnh nghƒ©a Type Status kh·ªõp v·ªõi DB (Logic c·ªßa App)
export type BookingStatus = 
  | "pending"       
  | "confirmed"     
  | "checked_in"    
  | "checked_out"   
  | "paid"          
  | "completed"     
  | "cancelled";    

// 4. CHECK-IN
export async function checkInCustomer(bookingId: number, roomId: number, bookedStart: string) {
  const supabase = await createClient();
  const now = new Date(); 

  const { data: settingData } = await supabase
    .from('settings')
    .select('value')
    .eq('key', 'EARLY_CHECKIN_GRACE_MINUTES')
    .single();
  const graceMinutes = Number(settingData?.value || 40);

  const bookedStartDate = new Date(bookedStart);
  const diffMinutes = (bookedStartDate.getTime() - now.getTime()) / 60000;

  if (diffMinutes > graceMinutes) {
      const { data: conflicts } = await supabase
        .from('booking_items')
        .select('booking_item_id')
        .eq('room_id', roomId)
        .neq('booking_id', bookingId) 
        .lt('start_dt', bookedStartDate.toISOString()) 
        .gt('end_dt', now.toISOString());

      if (conflicts && conflicts.length > 0) {
          return { success: false, error: "Kh√¥ng th·ªÉ check-in s·ªõm: ƒêang c√≥ kh√°ch kh√°c s·ª≠ d·ª•ng ph√≤ng." };
      }
  }

  const { error } = await supabase
    .from('bookings')
    .update({ 
        status: 'checked_in',
        check_in_at: now.toISOString()
    })
    .eq('booking_id', bookingId);

  if (error) return { success: false, error: error.message };
  revalidatePath('/admin');
  return { success: true };
}

// 5. CHECK-OUT (FIX L·ªñI TYPE ·ªû ƒê√ÇY)
export async function checkOutCustomer(bookingId: number) {
    const supabase = await createClient();
    const now = new Date();

    const { error } = await supabase
        .from('bookings')
        .update({ 
            status: 'checked_out', 
            check_out_at: now.toISOString() 
        })
        .eq('booking_id', bookingId);

    if (error) return { success: false, error: error.message };
    revalidatePath('/admin');
    return { success: true };
}

// 6. CONFIRM PAYMENT (FIX L·ªñI TYPE ·ªû ƒê√ÇY)
export async function confirmPayment(bookingId: number, totalActual: number) {
    const supabase = await createClient();

    const { error } = await supabase
        .from('bookings')
        .update({ 
            // FIX: √âp ki·ªÉu 'as any'
            status: 'paid', 
            total_actual: totalActual
        })
        .eq('booking_id', bookingId);

    if (error) return { success: false, error: error.message };
    revalidatePath('/admin');
    return { success: true };
}

// 7. FINALIZE
export async function finalizeBooking(bookingId: number) {
    const supabase = await createClient();

    const { error } = await supabase
        .from('bookings')
        .update({ 
            status: 'completed' 
        })
        .eq('booking_id', bookingId);

    if (error) return { success: false, error: error.message };
    revalidatePath('/admin');
    return { success: true };
}

// 8. UPDATE STATUS CHUNG (FIX L·ªñI TYPE ·ªû ƒê√ÇY)
export async function updateBookingStatus(bookingId: number, status: string, totalActual?: number) {
  const supabase = await createClient();
  
  const payload: { status: BookingStatus; total_actual?: number } = { 
    status: status as BookingStatus 
  };
  if (totalActual !== undefined) payload.total_actual = totalActual;
  
  // FIX: √âp ki·ªÉu payload 'as any' ƒë·ªÉ Supabase client ch·∫•p nh·∫≠n status m·ªõi
  const { error } = await supabase.from('bookings').update(payload).eq('booking_id', bookingId);
  
  if (error) return { success: false, error: error.message };
  revalidatePath('/admin');
  return { success: true };
}
```

## File: src/lib/actions/customers.ts
```typescript
'use server'

import { createClient } from '@/lib/supabase/server'
import { revalidatePath } from 'next/cache'
import { Database } from '@/types/supabase'

export type CustomerRow = Database['public']['Tables']['customers']['Row']

// ==============================================================================
// 1. L·∫§Y DANH S√ÅCH & T√åM KI·∫æM
// ==============================================================================

export async function getCustomers(query: string = '', limit: number = 20) {
  const supabase = await createClient()

  let dbQuery = supabase
    .from('customers')
    .select('*')
    .eq('is_active', true)
    .order('created_at', { ascending: false })
    .limit(limit)

  // T√¨m ki·∫øm theo T√™n ho·∫∑c SƒêT
  if (query) {
    dbQuery = dbQuery.or(`full_name.ilike.%${query}%,phone.ilike.%${query}%`)
  }

  const { data, error } = await dbQuery

  if (error) {
    console.error('Error fetching customers:', error)
    return []
  }
  return data
}

export async function getCustomerById(id: number) {
  const supabase = await createClient()
  
  const { data, error } = await supabase
    .from('customers')
    .select('*')
    .eq('customer_id', id)
    .single()

  if (error) return null
  return data
}

// ==============================================================================
// 2. T·∫†O & C·∫¨P NH·∫¨T
// ==============================================================================

export async function createCustomer(formData: FormData) {
  const supabase = await createClient()

  const rawData = {
    full_name: formData.get('full_name') as string,
    phone: formData.get('phone') as string,
    email: formData.get('email') as string || null,
    cccd: formData.get('cccd') as string || null,
    company_name: formData.get('company_name') as string || null,
    tax_code: formData.get('tax_code') as string || null,
    address: formData.get('address') as string || null,
    customer_type: formData.get('customer_type') as 'regular' | 'vip' | 'corporate' || 'regular',
    discount_rate: Number(formData.get('discount_rate') || 0),
    note: formData.get('note') as string || null
  }

  const { data, error } = await supabase
    .from('customers')
    .insert(rawData)
    .select()
    .single()

  if (error) {
    // X·ª≠ l√Ω l·ªói tr√πng SƒêT th√¢n thi·ªán h∆°n
    if (error.code === '23505') { // M√£ l·ªói Unique Violation c·ªßa Postgres
      return { success: false, error: 'S·ªë ƒëi·ªán tho·∫°i n√†y ƒë√£ t·ªìn t·∫°i trong h·ªá th·ªëng.' }
    }
    return { success: false, error: error.message }
  }

  revalidatePath('/admin/customers')
  return { success: true, data }
}

export async function updateCustomer(customerId: number, formData: FormData) {
  const supabase = await createClient()

  const rawData = {
    full_name: formData.get('full_name') as string,
    phone: formData.get('phone') as string,
    email: formData.get('email') as string,
    cccd: formData.get('cccd') as string,
    company_name: formData.get('company_name') as string,
    tax_code: formData.get('tax_code') as string,
    address: formData.get('address') as string,
    customer_type: formData.get('customer_type') as 'regular' | 'vip' | 'corporate',
    discount_rate: Number(formData.get('discount_rate') || 0),
    note: formData.get('note') as string
  }

  const { error } = await supabase
    .from('customers')
    .update(rawData)
    .eq('customer_id', customerId)

  if (error) return { success: false, error: error.message }

  revalidatePath('/admin/customers')
  return { success: true }
}

// ==============================================================================
// 3. L·ªäCH S·ª¨ GIAO D·ªäCH (CRM)
// ==============================================================================

export async function getCustomerHistory(customerId: number) {
  const supabase = await createClient()
  
  // L·∫•y danh s√°ch booking c·ªßa kh√°ch n√†y
  const { data, error } = await supabase
    .from('bookings')
    .select(`
      *,
      users (full_name) 
    `)
    .eq('customer_id', customerId)
    .order('created_at', { ascending: false })

  if (error) return []
  return data
}
```

## File: src/lib/actions/settings.ts
```typescript
// src/lib/actions/settings.ts
'use server'

import { createClient } from '@/lib/supabase/server'
import { revalidatePath } from 'next/cache'

export interface SettingItem {
  key: string;
  value: string;
  description?: string;
}

// 1. L·∫•y danh s√°ch Settings
export async function getSettings() {
  const supabase = await createClient();
  try {
    const { data, error } = await supabase
      .from('settings')
      .select('*')
      .order('key');

    if (error) throw error;
    return data as SettingItem[];
  } catch (error: unknown) {
    console.error("Error fetching settings:", error);
    return [];
  }
}

// 2. L·∫•y gi√° tr·ªã Setting Cleanup
export async function getCleanupMinutes() {
  const supabase = await createClient()
  
  const { data, error } = await supabase
    .from('settings')
    .select('value')
    .eq('key', 'CLEANUP_GAP_MINUTES')
    .single()

  if (error || !data) return 60; 
  return Number(data.value) || 60;
}

// 3. C·∫≠p nh·∫≠t Setting Cleanup
export async function updateCleanupMinutes(minutes: number) {
  const supabase = await createClient()

  const { error } = await supabase
    .from('settings')
    .upsert({
      key: 'CLEANUP_GAP_MINUTES',
      value: minutes.toString(),
      description: 'Th·ªùi gian d·ªçn d·∫πp (ph√∫t)',
      updated_at: new Date().toISOString()
    })

  if (error) return { success: false, error: error.message }

  revalidatePath('/admin/settings')
  return { success: true }
}

// 4. C·∫≠p nh·∫≠t Nhi·ªÅu Settings (ƒê∆∞·ª£c chuy·ªÉn t·ª´ actions.ts sang & t·ªëi ∆∞u h√≥a)
export async function updateSettings(updates: { key: string; value: string }[]) {
  const supabase = await createClient();

  // 1. Check quy·ªÅn Admin (Gi·ªØ nguy√™n logic c≈©)
  const { data: { user } } = await supabase.auth.getUser();
  if (!user) return { success: false, error: 'Unauthorized' };

  const { data: profile } = await supabase
    .from('users')
    .select('role')
    .eq('auth_id', user.id)
    .single();

  if (profile?.role !== 'Admin') {
    return { success: false, error: 'Forbidden' };
  }

  // 2. THAY ƒê·ªîI: D√πng upsert thay v√¨ update
  try {
    const promises = updates.map(item => 
      supabase
        .from('settings')
        .upsert({ 
          key: item.key, // upsert c·∫ßn key ƒë·ªÉ bi·∫øt d√≤ng n√†o c·∫ßn s·ª≠a
          value: item.value,
          description: item.key === 'CLEANUP_GAP_MINUTES' ? 'Th·ªùi gian d·ªçn d·∫πp (ph√∫t)' : undefined, // Optional: gi·ªØ description kh√¥ng b·ªã null n·∫øu t·∫°o m·ªõi
          updated_at: new Date().toISOString()
        }, { onConflict: 'key' }) // Quan tr·ªçng: x√°c ƒë·ªãnh tr√πng l·∫∑p d·ª±a tr√™n c·ªôt 'key'
    );

    const results = await Promise.all(promises);

    // Ki·ªÉm tra xem c√≥ l·ªánh n√†o b·ªã l·ªói kh√¥ng
    const errors = results.filter(r => r.error).map(r => r.error?.message);
    if (errors.length > 0) {
        throw new Error(errors.join(', '));
    }

    revalidatePath('/', 'layout'); 
    return { success: true };
  } catch (error: unknown) {
    let message = 'L·ªói kh√¥ng x√°c ƒë·ªãnh';
    if (error instanceof Error) message = error.message;
    else if (typeof error === 'string') message = error;
    
    return { success: false, error: message };
  }
}
```

## File: src/lib/actions/stats.ts
```typescript
// src/lib/actions/stats.ts
'use server'

import { createClient } from '@/lib/supabase/server'

// ƒê·ªãnh nghƒ©a Type chung cho Chart
export interface MonthlyStat {
  name: string;
  total: number;
}
interface ChartSourceItem {
  start_dt?: string;    // C√≥ khi query b·∫£ng bookings
  created_at?: string;  // C√≥ khi query b·∫£ng projects
}
// Helper t√≠nh ng√†y b·∫Øt ƒë·∫ßu
function getStartDate(range: string) {
  const now = new Date();
  // Reset gi·ªù ƒë·ªÉ t√≠nh ch√≠nh x√°c m·ªëc 00:00
  now.setHours(0, 0, 0, 0); 
  
  if (range === 'today') {
    return now;
  }
  if (range === '7d') {
    const d = new Date(now);
    d.setDate(d.getDate() - 7);
    return d;
  }
  if (range === '30d') {
    const d = new Date(now);
    d.setDate(d.getDate() - 30);
    return d;
  }
  if (range === '90d') {
    const d = new Date(now);
    d.setDate(d.getDate() - 90);
    return d;
  }
  if (range === '12m') {
    const d = new Date(now);
    d.setFullYear(d.getFullYear() - 1);
    return d;
  }
  return new Date(0); // All time
}

export async function getDashboardStats(range: string = '30d') {
  const supabase = await createClient();
  try {
    const startDate = getStartDate(range).toISOString();
    
    // Range cho "H√¥m nay"
    const todayStart = new Date();
    todayStart.setHours(0, 0, 0, 0);
    const todayEnd = new Date();
    todayEnd.setHours(23, 59, 59, 999);

    const { count: totalProjects } = await supabase.from('projects').select('*', { count: 'exact', head: true });
    
    const { count: newProjects } = await supabase
      .from('projects')
      .select('*', { count: 'exact', head: true })
      .gte('created_at', startDate);

    const { count: totalStaff } = await supabase.from('users').select('*', { count: 'exact', head: true });

    const { count: todayBookings } = await supabase
      .from('booking_items')
      .select('*', { count: 'exact', head: true })
      .gte('start_dt', todayStart.toISOString())
      .lte('start_dt', todayEnd.toISOString());

    return {
      totalProjects: totalProjects || 0,
      newProjects: newProjects || 0,
      totalStaff: totalStaff || 0,
      todayBookings: todayBookings || 0
    };
  } catch (error) {
    console.error("L·ªói dashboard stats:", error);
    return { totalProjects: 0, newProjects: 0, totalStaff: 0, todayBookings: 0 };
  }
}

export async function getTodaySchedule() {
  const supabase = await createClient();
  try {
    const todayStart = new Date();
    todayStart.setHours(0, 0, 0, 0);
    const todayEnd = new Date();
    todayEnd.setHours(23, 59, 59, 999);

    const { data, error } = await supabase
      .from('booking_items')
      .select(`
        booking_item_id,
        start_dt,
        end_dt,
        rooms ( name, code ),
        bookings ( 
          status,
          customers ( full_name, phone )
        )
      `)
      .gte('start_dt', todayStart.toISOString())
      .lte('start_dt', todayEnd.toISOString())
      .order('start_dt', { ascending: true });

    if (error) throw error;
    return data || [];
  } catch (error) {
    console.error("L·ªói l·∫•y l·ªãch h√¥m nay:", error);
    return [];
  }
}

// --- H√ÄM N√ÄY ƒê√É ƒê∆Ø·ª¢C C·∫¨P NH·∫¨T ---
export async function getGrowthChartData(range: string = '30d', type: 'bookings' | 'projects' = 'bookings') {
    const supabase = await createClient();
    try {
        const startDate = getStartDate(range);
        let query;

        if (type === 'bookings') {
            query = supabase
                .from('booking_items')
                .select('start_dt')
                .gte('start_dt', startDate.toISOString())
                .order('start_dt', { ascending: true });
        } else {
            query = supabase
                .from('projects')
                .select('created_at')
                .gte('created_at', startDate.toISOString())
                .order('created_at', { ascending: true });
        }

        const { data, error } = await query;

        if (error || !data) {
            return [];
        }

        // 2. √âP KI·ªÇU T∆Ø·ªúNG MINH (FIX L·ªñI ANY)
        // Ch√∫ng ta cho TS bi·∫øt 'data' n√†y ch·∫Øc ch·∫Øn l√† m·∫£ng c√°c object c√≥ start_dt ho·∫∑c created_at
        const typedData = data as unknown as ChartSourceItem[];

        const isDaily = range === '7d' || range === '30d' || range === 'today';
        const statsMap = new Map<string, number>();

        // Gi·ªù 'item' s·∫Ω c√≥ ki·ªÉu ChartSourceItem, kh√¥ng c√≤n l√† any
        typedData.forEach((item) => {
            const dateVal = type === 'bookings' ? item.start_dt : item.created_at;
            
            if (!dateVal) return;
            
            const date = new Date(dateVal);
            let key = '';

            if (isDaily) {
                key = `${date.getDate()}/${date.getMonth() + 1}`;
            } else {
                key = `T${date.getMonth() + 1}`;
            }
            
            statsMap.set(key, (statsMap.get(key) || 0) + 1);
        });

        return Array.from(statsMap, ([name, total]) => ({ name, total }));
    } catch (error) {
        console.error("L·ªói l·∫•y th·ªëng k√™ bi·ªÉu ƒë·ªì:", error);
        return [];
    }
}
```

## File: src/lib/actions/users.ts
```typescript
'use server'

import { createClient } from '@/lib/supabase/server'
import { revalidatePath } from 'next/cache'
import { createClient as createSupabaseClient } from '@supabase/supabase-js' // Ch·ªâ d√πng cho Service Role

export interface UserProfile {
  user_id: number;
  email: string;
  full_name: string;
  role: 'Admin' | 'Staff';
}

export interface StaffUser extends UserProfile {
  is_active: boolean;
  created_at: string;
  auth_id: string;
}

async function requireAdmin() {
  const supabase = await createClient(); // S·ª≠ d·ª•ng client t·ª´ @supabase/ssr

  // 1. L·∫•y User t·ª´ Session (T·ª± ƒë·ªông ƒë·ªçc Cookie)
  const { data: { user }, error } = await supabase.auth.getUser();
  
  if (error || !user) {
    throw new Error("Unauthorized: B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p.");
  }

  // 2. Check Role trong DB
  const { data: profile } = await supabase
    .from('users')
    .select('role')
    .eq('auth_id', user.id)
    .single();

  if (profile?.role !== 'Admin') {
    throw new Error("Forbidden: Ch·ªâ Admin m·ªõi c√≥ quy·ªÅn n√†y.");
  }

  // (Optional) Tr·∫£ v·ªÅ user hi·ªán t·∫°i ƒë·ªÉ h√†m g·ªçi d√πng ti·∫øp ƒë·ª° ph·∫£i query l·∫°i
  return user;
}


// 1. L·∫•y th√¥ng tin user hi·ªán t·∫°i
export async function getCurrentUserProfile(): Promise<UserProfile | null> {
  const supabase = await createClient();

  try {
    const { data: { user } } = await supabase.auth.getUser();
    if (!user) return null;

    const { data: profile } = await supabase
      .from('users')
      .select('user_id, email, full_name, role')
      .eq('auth_id', user.id)
      .single();

    return profile as UserProfile;
  } catch (error) {
    console.error("L·ªói th√¥ng tin ng∆∞·ªùi d√πng hi·ªán t·∫°i:", error);
    return null;
  }
}

// 2. L·∫•y danh s√°ch nh√¢n vi√™n
export async function getStaffList() {
  const supabase = await createClient();
  try {
    const { data, error } = await supabase
      .from('users')
      .select('*')
      .order('created_at', { ascending: false });

    if (error) throw error;
    return data as StaffUser[];
  } catch (error) {
    console.error("Error fetching staff:", error);
    return [];
  }
}

// 3. Kh√≥a/M·ªü kh√≥a t√†i kho·∫£n
export async function toggleStaffStatus(userId: number, currentStatus: boolean) {
  try {
    // 1. Check quy·ªÅn (Kh√¥ng c·∫ßn truy·ªÅn token n·ªØa)
    const currentUser = await requireAdmin(); 

    // 2. T·∫°o client ƒë·ªÉ th·ª±c hi·ªán update
    const supabase = await createClient(); //

    // 3. Logic nghi·ªáp v·ª• (Gi·ªØ nguy√™n logic c≈© c·ªßa b·∫°n)
    // L·∫•y th√¥ng tin ng∆∞·ªùi b·ªã kh√≥a (Target) ƒë·ªÉ check kh√¥ng t·ª± kh√≥a m√¨nh
    const { data: targetUser } = await supabase
      .from('users')
      .select('auth_id')
      .eq('user_id', userId)
      .single();

    if (targetUser && currentUser.id === targetUser.auth_id) {
      throw new Error("B·∫°n kh√¥ng th·ªÉ t·ª± kh√≥a t√†i kho·∫£n c·ªßa ch√≠nh m√¨nh.");
    }

    const { error } = await supabase
      .from('users')
      .update({ is_active: !currentStatus })
      .eq('user_id', userId);

    if (error) throw error;
    
    // Revalidate n·∫øu c·∫ßn (nh·ªõ import revalidatePath)
    // revalidatePath('/admin/staff');

    return { success: true };
  } catch (error: unknown) {
    console.error("Toggle staff error:", error);
    return { success: false, error: error instanceof Error ? error.message : 'L·ªói h·ªá th·ªëng' };
  }
}

// 4. T·∫°o t√†i kho·∫£n nh√¢n vi√™n (D√πng Service Role)
export async function createStaffAccount(data: { email: string; password: string; fullName: string; role: string }) {
  // Service Role Key c·∫ßn thi·∫øt ƒë·ªÉ t·∫°o user trong Auth m√† kh√¥ng c·∫ßn confirm email th·ªß c√¥ng
  const serviceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;
  const projectUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;

  if (!serviceKey || !projectUrl) {
    return { success: false, error: "Server ch∆∞a c·∫•u h√¨nh Service Role Key" };
  }

  try {
    // T·∫°o Client quy·ªÅn Admin
    const supabaseAdmin = createSupabaseClient(projectUrl, serviceKey, {
      auth: { autoRefreshToken: false, persistSession: false }
    });

    // T·∫°o User b√™n Auth
    const { data: authData, error: authError } = await supabaseAdmin.auth.admin.createUser({
      email: data.email,
      password: data.password,
      email_confirm: true,
      user_metadata: { full_name: data.fullName }
    });

    if (authError) throw authError;
    if (!authData.user) throw new Error("Kh√¥ng t·∫°o ƒë∆∞·ª£c Auth User");

    // L∆∞u v√†o b·∫£ng public.users
    const { error: dbError } = await supabaseAdmin
      .from('users')
      .insert({
        email: data.email,
        username: data.email, 
        full_name: data.fullName,
        role: data.role,
        auth_id: authData.user.id,
        is_active: true
      });

    if (dbError) {
      await supabaseAdmin.auth.admin.deleteUser(authData.user.id); // Rollback
      throw dbError;
    }

    revalidatePath('/admin/staff');
    return { success: true };

  } catch (error: unknown) {
    
    // X·ª≠ l√Ω type safe
    let message = 'L·ªói kh√¥ng x√°c ƒë·ªãnh';
    
    if (error instanceof Error) {
      message = error.message; // L·∫•y message t·ª´ Error object
    } else if (typeof error === 'string') {
      message = error; // N·∫øu throw "chu·ªói"
    }

    // Tr·∫£ v·ªÅ string cho Client hi·ªÉn th·ªã
    return { success: false, error: message };
  }
}
```

## File: src/lib/image-utils.ts
```typescript
// src/lib/image-utils.ts

/**
 * N√©n v√† Resize ·∫£nh tr∆∞·ªõc khi upload
 * @param file File ·∫£nh g·ªëc
 * @param maxWidth Chi·ªÅu r·ªông t·ªëi ƒëa (m·∫∑c ƒë·ªãnh 1920px)
 * @param quality Ch·∫•t l∆∞·ª£ng n√©n (0 - 1, m·∫∑c ƒë·ªãnh 0.8)
 */
export const compressImage = async (
  file: File, 
  maxWidth = 1920, 
  quality = 0.8
): Promise<Blob> => {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    
    reader.onload = (event) => {
      const img = new Image();
      img.src = event.target?.result as string;
      
      img.onload = () => {
        // T√≠nh to√°n k√≠ch th∆∞·ªõc m·ªõi gi·ªØ nguy√™n t·ª∑ l·ªá
        let width = img.width;
        let height = img.height;
        
        if (width > maxWidth) {
          height = Math.round((height * maxWidth) / width);
          width = maxWidth;
        }

        // V·∫Ω l√™n Canvas ƒë·ªÉ resize
        const canvas = document.createElement('canvas');
        canvas.width = width;
        canvas.height = height;
        
        const ctx = canvas.getContext('2d');
        if (!ctx) {
          reject(new Error('Kh√¥ng th·ªÉ t·∫°o context canvas'));
          return;
        }
        
        ctx.drawImage(img, 0, 0, width, height);
        
        // Xu·∫•t ra Blob d·∫°ng WebP
        canvas.toBlob(
          (blob) => {
            if (blob) {
              resolve(blob);
            } else {
              reject(new Error('L·ªói n√©n ·∫£nh'));
            }
          },
          'image/webp',
          quality
        );
      };
      
      img.onerror = (err) => reject(err);
    };
    
    reader.onerror = (err) => reject(err);
  });
};
```

## File: src/lib/supabase/client.ts
```typescript
import { createBrowserClient } from '@supabase/ssr'
import { Database } from '@/types/supabase'

export function createClient() {
  return createBrowserClient<Database>(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
  )
}
```

## File: src/lib/supabase/server.ts
```typescript
import { createServerClient } from '@supabase/ssr'
import { cookies } from 'next/headers'
import { Database } from '@/types/supabase'

export async function createClient() {
  const cookieStore = await cookies()

  return createServerClient<Database>(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() {
          return cookieStore.getAll()
        },
        setAll(cookiesToSet) {
          try {
            cookiesToSet.forEach(({ name, value, options }) =>
              cookieStore.set(name, value, options)
            )
          } catch {
            // The `setAll` method was called from a Server Component.
            // This can be ignored if you have middleware refreshing
            // user sessions.
          }
        },
      },
    }
  )
}
```

## File: src/middleware.ts
```typescript
// src/middleware.ts
import { createServerClient } from '@supabase/ssr';
import { NextResponse, type NextRequest } from 'next/server';

export async function middleware(request: NextRequest) {
  // 1. Kh·ªüi t·∫°o Response
  let response = NextResponse.next({
    request: {
      headers: request.headers,
    },
  });

  // 2. Kh·ªüi t·∫°o Supabase Client cho Middleware
  // Logic n√†y gi√∫p ƒë·ªçc/ghi cookie phi√™n ƒëƒÉng nh·∫≠p m·ªôt c√°ch an to√†n tr√™n Server
  const supabase = createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() {
          return request.cookies.getAll();
        },
        setAll(cookiesToSet) {
          cookiesToSet.forEach(({ name, value }) =>
            request.cookies.set(name, value)
          );
          response = NextResponse.next({
            request,
          });
          cookiesToSet.forEach(({ name, value, options }) =>
            response.cookies.set(name, value, options)
          );
        },
      },
    }
  );

  // 3. Ki·ªÉm tra User (Quan tr·ªçng: d√πng getUser thay v√¨ getSession ƒë·ªÉ b·∫£o m·∫≠t h∆°n)
  // getUser s·∫Ω x√°c th·ª±c l·∫°i v·ªõi Auth Server xem token c√≤n s·ªëng kh√¥ng
  const {
    data: { user },
  } = await supabase.auth.getUser();

  const url = request.nextUrl.clone();

  // --- QUY T·∫ÆC B·∫¢O M·∫¨T ---

  // TR∆Ø·ªúNG H·ª¢P 1: ƒêang c·ªë v√†o trang Admin (/admin/*)
  if (url.pathname.startsWith('/admin')) {
    // N·∫øu ch∆∞a ƒëƒÉng nh·∫≠p -> ƒê√° v·ªÅ trang Login
    if (!user) {
      url.pathname = '/login';
      // L∆∞u l·∫°i trang h·ªç ƒë·ªãnh v√†o ƒë·ªÉ sau khi login xong th√¨ redirect l·∫°i ƒë√≥ (Optional)
      url.searchParams.set('next', request.nextUrl.pathname);
      return NextResponse.redirect(url);
    }
    
    // (T√πy ch·ªçn) N·∫øu b·∫°n c√≥ ph√¢n quy·ªÅn (VD: user th∆∞·ªùng vs admin)
    // Th√¨ check th√™m role ·ªü ƒë√¢y. N·∫øu ch·ªâ c√≥ 1 admin l√† b·∫°n th√¨ kh√¥ng c·∫ßn.
  }

  // TR∆Ø·ªúNG H·ª¢P 2: ƒêang c·ªë v√†o trang Login (/login)
  if (url.pathname === '/login') {
    // N·∫øu ƒê√É ƒëƒÉng nh·∫≠p r·ªìi -> Kh√¥ng cho v√†o login n·ªØa, ƒë√° th·∫≥ng v√†o Admin
    if (user) {
      url.pathname = '/admin'; 
      return NextResponse.redirect(url);
    }
  }

  // N·∫øu h·ª£p l·ªá, cho ƒëi ti·∫øp
  return response;
}

// C·∫•u h√¨nh ƒë·ªÉ Middleware ch·ªâ ch·∫°y tr√™n c√°c route c·∫ßn thi·∫øt
// Gi√∫p t·ªëi ∆∞u hi·ªáu nƒÉng, kh√¥ng ch·∫°y tr√™n file ·∫£nh, static file...
export const config = {
  matcher: [
    /*
     * Match t·∫•t c·∫£ request paths ngo·∫°i tr·ª´:
     * - _next/static (static files)
     * - _next/image (image optimization files)
     * - favicon.ico (favicon file)
     * - images (public images)
     * - public folder
     */
    '/((?!_next/static|_next/image|favicon.ico|.*\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)',
  ],
};
```

## File: src/types/grid-project.ts
```typescript
// src/types/grid-project.ts
import { StaticImageData } from 'next/image';

/**
 * ƒê√¢y l√† c·∫•u tr√∫c d·ªØ li·ªáu m√† PortfolioGrid s·∫Ω nh·∫≠n.
 * N√≥ bao g·ªìm c·∫£ d·ªØ li·ªáu hi·ªÉn th·ªã (title, src)
 * v√† d·ªØ li·ªáu layout (colSpan, rowSpan)
 * v√† d·ªØ li·ªáu h√†nh vi (slug).
 */
export interface GridProject {
  id: number | string;
  src: StaticImageData | string;
  title: string;
  category: string;
  
  // D√†nh cho layout
  colSpan: string;
  rowSpan: string;
  
  // D√†nh cho link chi ti·∫øt
  slug: string; 
}
```

## File: tailwind.config.ts
```typescript
// tailwind.config.ts
import type { Config } from 'tailwindcss';

const config: Config = {
  content: [
    './src/pages/**/*.{js,ts,jsx,tsx,mdx}',
    './src/components/**/*.{js,ts,jsx,tsx,mdx}',
    './src/app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  // TH√äM D√íNG N√ÄY
  darkMode: 'class', 
  theme: {
    extend: {
      //...
    },
  },
  plugins: [],
};
export default config;
```

## File: tsconfig.json
```json
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": [
      "dom",
      "dom.iterable",
      "esnext"
    ],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": [
        "./src/*"
      ]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts"
  ],
  "exclude": [
    "node_modules"
  ]
}
```

## File: src/app/admin/calendar/layout.tsx
```typescript
export default async function CalendarLayout({
  children,
}: {
  children: React.ReactNode
}) {
  // L·∫•y d·ªØ li·ªáu ph√≤ng t·ª´ Server ƒë·ªÉ render Sidebar

  return (
    <div className="flex h-[calc(100vh-136px)] overflow-hidden bg-[var(--admin-bg)] ">
      <main className="flex-1 flex flex-col min-w-0 overflow-hidden m-4 
       shadow-sm">
        {children}
      </main>
    </div>
  )
}
```

## File: src/app/admin/calendar/page.tsx
```typescript
import React from "react";
import { getBookingsForCalendar } from '@/lib/actions/bookings';
import { getRooms, getServices } from '@/lib/actions/studio';
import { getCurrentUserProfile } from '@/lib/actions/users'; 
import { getCleanupMinutes } from '@/lib/actions/settings';
import DashboardCalendar from '@/components/admin/DashboardCalendar'; 

// Helper interface mapping ƒë·ªÉ h·ª©ng d·ªØ li·ªáu t·ª´ DB
interface ServiceFromDB {
  service_id: number;
  name: string;
  category: string | null;
  type: "service" | "surcharge" | "compensation";
  unit: string | null;
  price: number;
  is_active: boolean | null;
}

export default async function CalendarPage() {
  // 1. Chu·∫©n b·ªã kho·∫£ng th·ªùi gian
  const today = new Date();
  const startDate = new Date(today);
  startDate.setDate(today.getDate() - 30);
  const endDate = new Date(today);
  endDate.setDate(today.getDate() + 30);

  const startStr = startDate.toISOString();
  const endStr = endDate.toISOString();

  // 2. Fetch d·ªØ li·ªáu song song
  const [rooms, rawBookings, rawServices, userProfile, cleanupMinutes] = await Promise.all([
    getRooms(),
    getBookingsForCalendar(startStr, endStr),
    getServices(),
    getCurrentUserProfile(),
    getCleanupMinutes(),
  ]);

  // 3. X·ª¨ L√ù D·ªÆ LI·ªÜU SERVICES (Quan tr·ªçng)
  const services = (rawServices as ServiceFromDB[]).map((service) => ({
    ...service,
    // FIX QUAN TR·ªåNG: 
    // 'category' trong interface l√† optional (?) n√™n b·∫Øt bu·ªôc ph·∫£i l√† 'undefined', kh√¥ng ch·ªãu 'null'
    category: service.category ?? undefined, 

    // 'unit' trong interface l√† 'string | null', n√™n gi·ªØ nguy√™n 'null', kh√¥ng √©p v·ªÅ undefined
    unit: service.unit,

    is_active: service.is_active ?? true,
  }));

  // 4. X·ª≠ l√Ω d·ªØ li·ªáu Bookings
  const bookings = rawBookings.map((item) => ({
    ...item,
    booking_id: item.bookings?.booking_id || 0,
  }));

  return (
    <div className="h-[calc(100vh-theme(spacing.16))] flex flex-col gap-4 p-4">
      <div className="flex items-center justify-between">
        <h1 className="text-2xl font-bold tracking-tight">L·ªãch ƒê·∫∑t Ph√≤ng</h1>
      </div>

      <div className="flex-1 rounded-lg border bg-card text-card-foreground shadow-sm overflow-hidden">
        <DashboardCalendar
          rooms={rooms}
          bookings={bookings} 
          services={services} 
          currentUserId={Number(userProfile?.user_id ?? 0)}
          cleanupMinutes={cleanupMinutes}
        />
      </div>
    </div>
  );
}
```

## File: src/app/admin/grid/page.tsx
```typescript
// src/app/admin/grid/page.tsx
import { getProjects } from '@/lib/actions';
import PortfolioGridEditor from '@/components/admin/PortfolioGridEditor';
import { LayoutTemplate, AlertTriangle } from 'lucide-react';
import Link from 'next/link';

export const dynamic = 'force-dynamic';

export default async function PortfolioGridPage() {
  // 1. L·∫•y d·ªØ li·ªáu
  const allProjects = await getProjects('all');
  
  // 2. L·ªçc l·∫•y c√°c d·ª± √°n N·ªïi b·∫≠t (Featured)
  // Ch·ªâ nh·ªØng d·ª± √°n n√†y m·ªõi xu·∫•t hi·ªán ngo√†i Grid trang ch·ªß
  const featuredProjects = allProjects.filter(p => p.isFeatured);

  return (
    <div className="max-w-7xl mx-auto pb-20 space-y-8">
      {/* Header */}
      <div>
        <h1 className="text-3xl font-bold text-[var(--admin-fg)] flex items-center gap-3">
          <LayoutTemplate className="text-[var(--admin-primary)]" size={32} />
          B·ªë c·ª•c d·ª± √°n N·ªïi b·∫≠t
        </h1>
        <p className="text-[var(--admin-sub)] mt-2 max-w-2xl">
          Tinh ch·ªânh k√≠ch th∆∞·ªõc hi·ªÉn th·ªã cho c√°c d·ª± √°n <strong>N·ªïi b·∫≠t</strong> tr√™n trang ch·ªß.
        </p>
      </div>

      {/* Main Content */}
      {featuredProjects.length > 0 ? (
        <PortfolioGridEditor initialProjects={featuredProjects} />
      ) : (
        // Empty State (Khi ch∆∞a ch·ªçn d·ª± √°n n·ªïi b·∫≠t n√†o)
        <div className="flex flex-col items-center justify-center p-12 text-center border-2 border-dashed border-[var(--admin-border)] rounded-2xl bg-[var(--admin-card)]/50">
          <div className="w-16 h-16 bg-yellow-100 text-yellow-600 rounded-full flex items-center justify-center mb-4">
            <AlertTriangle size={32} />
          </div>
          <h3 className="text-xl font-semibold text-[var(--admin-fg)]">Ch∆∞a c√≥ d·ª± √°n N·ªïi b·∫≠t</h3>
          <p className="text-[var(--admin-sub)] mt-2 mb-6 max-w-md">
            B·∫°n c·∫ßn ƒë√°nh d·∫•u <strong>N·ªïi b·∫≠t</strong> cho √≠t nh·∫•t m·ªôt d·ª± √°n ƒë·ªÉ c√≥ th·ªÉ s·∫Øp x·∫øp b·ªë c·ª•c.
          </p>
          <Link 
            href="/admin/projects" 
            className="px-6 py-2.5 bg-[var(--admin-primary)] text-white font-medium rounded-lg hover:opacity-90 transition-all shadow-lg shadow-indigo-500/30"
          >
            ƒê·∫øn danh s√°ch d·ª± √°n
          </Link>
        </div>
      )}
    </div>
  );
}
```

## File: src/app/admin/projects/[id]/page.tsx
```typescript
// src/app/admin/projects/[id]/page.tsx
import { getProjectById } from '@/lib/actions';
import ProjectForm, { ProjectInitialData, BlockDB } from '@/components/admin/ProjectForm';
import { notFound } from 'next/navigation';

interface PageProps {
  params: Promise<{ id: string }>;
}

export default async function EditProjectPage({ params }: PageProps) {
  const { id } = await params;
  
  // 1. L·∫•y d·ªØ li·ªáu t·ª´ DB
  const projectRaw = await getProjectById(parseInt(id));

  if (!projectRaw) {
    notFound(); // Tr·∫£ v·ªÅ trang 404 n·∫øu kh√¥ng t√¨m th·∫•y
  }

  // 2. Chuy·ªÉn ƒë·ªïi format DB -> Format Form
  // C·∫ßn √©p ki·ªÉu c·∫©n th·∫≠n v√¨ Supabase tr·∫£ v·ªÅ JSON object th√¥
  const formattedData: ProjectInitialData = {
    id: projectRaw.project_id,
    title: projectRaw.title,
    client_name: projectRaw.client_name || '',
    description: projectRaw.description || '',
    category_id: projectRaw.category_id?.toString() || '',
    is_featured: projectRaw.is_featured || false,
    thumbnail_url: projectRaw.thumbnail_url || '',
    credits: Array.isArray(projectRaw.credits) ? projectRaw.credits : [],
    content: Array.isArray(projectRaw.content) ? (projectRaw.content as BlockDB[]) : []
  };

  // 3. Render Form
  return <ProjectForm mode="edit" initialData={formattedData} />;
}
```

## File: src/app/styles/ProjectArticle.module.css
```css
/* src/app/styles/ProjectArticle.module.css (CSS m·ªõi) */

/* 1. Container ch√≠nh (Gi·ªëng Gucci, max-width 3xl) */
.articleContainer {
    max-width: 860px; /* max-w-3xl */
    margin: 0 auto;
    padding: 0 1rem; /* px-4 */
    padding-top: 4rem; /* py-16 */
    padding-bottom: 6rem; /* py-24 */
}

/* 2. Ti√™u ƒë·ªÅ ch√≠nh */
.articleTitle {
    font-size: 2.25rem; /* text-4xl */
    line-height: 2.5rem;
    font-weight: 300; /* font-light */
    letter-spacing: -0.025em; /* tracking-tighter */
    text-align: center;
    margin-bottom: 1.5rem; /* mb-6 */
    color: var(--foreground);
}

@media (min-width: 768px) {
    .articleTitle {
        font-size: 3rem; /* md:text-5xl */
        line-height: 1;
    }
}

/* 3. Thanh Credits */
.creditsBar {
    border-top: 1px solid rgba(128, 128, 128, 0.2);
    border-bottom: 1px solid rgba(128, 128, 128, 0.2);
    margin-top: 2rem; /* my-8 */
    margin-bottom: 2rem;
    padding-top: 1rem; /* py-4 */
    padding-bottom: 1rem;
}
.creditsList {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1rem 2rem; /* a/c√°ch 2rem */
    font-size: 0.875rem; /* text-sm */
    color: var(--foreground);
    opacity: 0.8;
}
.creditsList li strong {
    font-weight: 600;
    opacity: 1;
}

/* 4. Kh·ªëi vƒÉn b·∫£n (Gi·ªëng text-wrap) */
.textWrap {
    font-size: 1.125rem; /* text-lg */
    line-height: 1.75rem; /* leading-relaxed */
    color: var(--foreground);
    opacity: 0.9;
    margin-top: 3rem; /* space-y-12 */
    margin-bottom: 3rem;
}
.textWrap p {
    margin-bottom: 1.5rem; /* space-y-6 b√™n trong */
}

/* 5. Kh·ªëi Sub-heading (Gi·ªëng highlight) */
.highlightWrap {
    text-align: center;
    margin-top: 4rem; /* pt-8 + my-12 */
    margin-bottom: 3rem;
}
.highlightWrap h2 {
    font-size: 1.875rem; /* text-3xl */
    line-height: 2.25rem;
    font-weight: 300; /* font-light */
    letter-spacing: -0.025em; /* tracking-tight */
    color: var(--foreground);
}
@media (min-width: 768px) {
    .highlightWrap h2 {
        font-size: 2.25rem; /* md:text-4xl */
    }
}

/* 6. Kh·ªëi ·∫£nh (Gi·ªëng image-row) */
.imageRow {
    display: flex;
    flex-direction: column; /* X·∫øp ch·ªìng tr√™n mobile */
    gap: 1rem; /* gap-4 */
    justify-content: center;
    margin-top: 3rem; /* my-8 md:my-12 */
    margin-bottom: 3rem;
}
@media (min-width: 768px) {
    .imageRow {
        flex-direction: row; /* C·∫°nh nhau tr√™n desktop */
    }
}

/* 7. Gi·ªØ l·∫°i CSS cho Navigation v√† Fade-in */
.projectNavigation {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-top: 1px solid rgba(128, 128, 128, 0.2);
    padding-top: 30px;
}
.navLink {
    text-decoration: none;
    color: var(--foreground);
    font-weight: 500;
    padding: 10px 15px;
    transition: all 0.3s ease;
    border-radius: 4px;
}
.navLink:hover:not(.disabled) {
    color: var(--glow-color);
    background-color: rgba(128, 128, 128, 0.1);
}
.navLink.disabled {
    color: var(--foreground);
    opacity: 0.3;
    pointer-events: none;
}
.fade_in_hidden {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.8s ease-out, transform 0.8s ease-out;
}
.fade_in_visible {
    opacity: 1;
    transform: translateY(0);
}
```

## File: src/components/admin/calendar/BookingCalendar.tsx
```typescript
'use client'

import { 
  Calendar, 
  momentLocalizer, 
  Views, 
  View, 
  EventProps, 
  SlotInfo,
  EventPropGetter,
} from 'react-big-calendar'
import moment from 'moment'
import 'moment/locale/vi'
import 'react-big-calendar/lib/css/react-big-calendar.css'
import React, { useState, useMemo, useCallback } from 'react'
import CustomToolbar from './CustomToolbar'
import withDragAndDrop, { EventInteractionArgs } from 'react-big-calendar/lib/addons/dragAndDrop'
import 'react-big-calendar/lib/addons/dragAndDrop/styles.css'
import { ROOM_COLORS } from '@/lib/constants';

// C·∫•u h√¨nh Moment ti·∫øng Vi·ªát
moment.locale('vi')
const localizer = momentLocalizer(moment)

// --- TYPE DEFINITIONS ---
interface BookingInfo {
  booking_id: number; // ƒê·∫£m b·∫£o field n√†y t·ªìn t·∫°i n·∫øu b·∫°n d√πng nested
  status: string | null;
  customers: {
    full_name: string | null;
  } | null;
}

export interface BookingItem {
  booking_item_id: number;
  // QUAN TR·ªåNG: Th√™m booking_id v√†o ƒë√¢y (FK t·ª´ b·∫£ng booking_items)
  booking_id: number; 
  start_dt: string;
  end_dt: string;
  room_id: number;
  bookings: BookingInfo | null;
}

export interface CalendarResource {
  id: number;
  title: string;
}

interface Room {
  room_id: number;
  name: string | null;
  code: string | null;
  status: 'available' | 'maintenance' | 'inactive';
  is_equipment_room?: boolean;
}

export interface CalendarEvent {
  id: string | number;
  title: string;       
  start: Date;
  end: Date;
  resourceId: number;  
  type: 'booking' | 'cleanup';
  status?: string;
  allDay?: boolean;
  resource?: { 
    bookingId?: number; 
  };
}

interface BookingCalendarProps {
  bookings: BookingItem[]; 
  rooms: Room[];
  date: Date;
  cleanupMinutes?: number;
  onNavigate: (newDate: Date) => void;
  onSelectSlot?: (info: { start: Date; end: Date; resourceId: number }) => void;
  // Prop quan tr·ªçng ƒë·ªÉ nh·∫≠n s·ª± ki·ªán click
  onSelectEvent?: (event: CalendarEvent) => void; 
  onEventDrop?: (args: EventInteractionArgs<CalendarEvent>) => void;
  onEventResize?: (args: EventInteractionArgs<CalendarEvent>) => void;
}

const DnDCalendar = withDragAndDrop<CalendarEvent, CalendarResource>(Calendar)

// --- CUSTOM EVENT COMPONENT ---
const CustomEvent = ({ event }: EventProps<CalendarEvent>) => {
  return (
    <div className="h-full w-full flex flex-col px-1.5 py-0.5 leading-snug overflow-hidden relative group">
      <div className="absolute left-0 top-0 bottom-0 w-[3px] bg-black/20"></div>
      
      {event.type === 'cleanup' ? (
        <div className="flex items-center gap-1 text-[10px] italic opacity-75">
          <span>üßπ</span> <span>D·ªçn d·∫πp</span>
        </div>
      ) : (
        <>
          <div className="font-bold text-[11px] truncate mt-0.5">
            {event.title}
          </div>
          <div className="text-[10px] opacity-90 truncate flex items-center gap-1">
             <span className={`w-1.5 h-1.5 rounded-full ${event.status === 'confirmed' ? 'bg-white' : 'bg-white/50'}`}></span>
             <span className="capitalize">{event.status === 'confirmed' ? 'ƒê√£ c·ªçc' : event.status}</span>
          </div>
        </>
      )}
    </div>
  )
}

export default function BookingCalendar({ 
  bookings,
  rooms,
  date, 
  cleanupMinutes = 60,
  onNavigate,
  onSelectSlot,
  onSelectEvent, // 1. Nh·∫≠n prop n√†y t·ª´ cha
  onEventDrop, 
  onEventResize 
}: BookingCalendarProps) {
  
  const [view, setView] = useState<View>(Views.DAY)

  // Mapping Events
  const events: CalendarEvent[] = useMemo(() => {
    const list: CalendarEvent[] = []
    bookings.forEach((b) => {
      // 2. S·ª¨A LOGIC L·∫§Y BOOKING ID
      // L·∫•y tr·ª±c ti·∫øp b.booking_id (FK) thay v√¨ b.bookings?.booking_id (Nested) ƒë·ªÉ ch·∫Øc ch·∫Øn c√≥ d·ªØ li·ªáu
      const bookingId = b.booking_id || b.bookings?.booking_id;

      list.push({
        id: b.booking_item_id,
        title: b.bookings?.customers?.full_name || 'Kh√°ch v√£ng lai', 
        start: new Date(b.start_dt),
        end: new Date(b.end_dt),
        resourceId: b.room_id, 
        type: 'booking',
        status: b.bookings?.status || 'unknown',
        allDay: false,
        // L∆∞u bookingId v√†o ƒë√¢y
        resource: { bookingId: bookingId } 
      })

      // Logic Cleanup
      const cleanupStart = new Date(b.end_dt);
      const cleanupEnd = moment(b.end_dt).add(cleanupMinutes, 'minutes').toDate();

      list.push({
        id: `cleanup-${b.booking_item_id}`,
        title: `D·ªçn d·∫πp (${cleanupMinutes}p)`,
        start: cleanupStart,
        end: cleanupEnd,
        resourceId: b.room_id,
        type: 'cleanup',
        allDay: false
      })
    })
    return list
  }, [bookings, cleanupMinutes])

  const resources: CalendarResource[] = useMemo(() => {
    return rooms
    .filter(r => r.status === 'available' && !r.is_equipment_room)
    .map(r => ({ id: r.room_id, title: r.name || `Room ${r.code}` }))
  }, [rooms])

  // Styling logic
  const eventStyleGetter: EventPropGetter<CalendarEvent> = useCallback((event) => {
    const resourceIndex = resources.findIndex(r => r.id === event.resourceId);
    let color = resourceIndex >= 0 ? ROOM_COLORS[resourceIndex % ROOM_COLORS.length] : '#6b7280';

    // Logic m√†u OT
    const now = new Date();
    if (event.status === 'checked_in' && now > event.end) {
        color = 'var(--admin-ot)'; 
    } else if (event.status === 'completed') {
        color = 'var(--status-completed)';
    }

    if (event.type === 'cleanup') {
      return {
        style: {
          backgroundColor: 'var(--admin-bg)',
          backgroundImage: 'repeating-linear-gradient(45deg, transparent, transparent 5px, rgba(0,0,0,0.05) 5px, rgba(0,0,0,0.05) 10px)',
          color: 'var(--admin-sub)',
          border: '1px dashed var(--admin-border)',
          fontSize: '10px',
          pointerEvents: 'none',
          cursor: 'default',
          borderRadius: '4px',
          zIndex: 1
        }
      }
    }

    return {
      style: {
        backgroundColor: color,
        border: 'none',
        color: '#fff',
        borderRadius: '4px',
        opacity: event.status === 'cancelled' ? 0.5 : 1, 
        boxShadow: '0 2px 4px rgba(0,0,0,0.1)',
        zIndex: 10,
        cursor: 'pointer' // Th√™m cursor pointer ƒë·ªÉ bi·∫øt click ƒë∆∞·ª£c
      }
    }
  }, [resources])

  const handleSelectSlotInternal = useCallback((slotInfo: SlotInfo) => {
    if (!slotInfo.resourceId) return
    if (onSelectSlot) {
      onSelectSlot({
        start: slotInfo.start as Date,
        end: slotInfo.end as Date,
        resourceId: Number(slotInfo.resourceId)
      })
    }
  }, [onSelectSlot])

  return (
    <div className="h-full w-full bg-[var(--admin-card)] text-[var(--admin-fg)] font-sans">
      <DnDCalendar
        localizer={localizer}
        events={events}
        resources={view === Views.DAY ? resources : undefined} 
        resourceIdAccessor={(r: CalendarResource) => r.id}
        resourceTitleAccessor={(r: CalendarResource) => r.title}
        view={view}
        onView={setView}
        date={date}
        onNavigate={onNavigate}
        components={{
          toolbar: CustomToolbar,
          event: CustomEvent,
          resourceHeader: ({ label }) => (
             <div className="text-sm font-bold text-[var(--admin-fg)] py-1">{label}</div>
          )
        }}
        eventPropGetter={eventStyleGetter}
        selectable
        onSelectSlot={handleSelectSlotInternal}
        onSelectEvent={onSelectEvent} 
        draggableAccessor={() => true} 
        resizable 
        onEventDrop={onEventDrop}     
        onEventResize={onEventResize} 
        step={30} 
        timeslots={2} 
        min={new Date(0, 0, 0, 0, 0, 0)} 
        max={new Date(0, 0, 0, 23, 59, 59)} 
        views={[Views.DAY, Views.WEEK, Views.MONTH, Views.AGENDA]} 
        defaultView={Views.DAY} 
      />
    </div>
  )
}
```

## File: src/components/admin/calendar/BookingCreateModal.tsx
```typescript
'use client';

import React, { useState, useEffect, useMemo, useRef } from 'react';
import { X, User, Check, Plus, Trash2, Loader2, Calendar as CalendarIcon, ChevronDown, Search } from 'lucide-react';
import { toast } from 'sonner';
import { 
  format, addMinutes, startOfDay, startOfMonth, endOfMonth, 
  eachDayOfInterval, getDay, isSameDay, addMonths, subMonths 
} from 'date-fns';
import { vi } from 'date-fns/locale';
import { createBooking } from '@/lib/actions/bookings';
import { createCustomer, getCustomers } from '@/lib/actions/customers'; // <--- 1. IMPORT getCustomers
import { RoomWithBranch, ServiceItem } from '@/lib/actions/studio';
import { CustomerRow } from '@/lib/actions/customers';
import ModalPortal from '@/components/ui/ModalPortal';

// --- HELPER: T·∫°o danh s√°ch khung gi·ªù 15 ph√∫t ---
const generateTimeOptions = () => {
  const times = [];
  const start = startOfDay(new Date());
  for (let i = 0; i < 24 * 4; i++) {
    const t = addMinutes(start, i * 15);
    times.push(format(t, 'HH:mm'));
  }
  return times;
};
const formatCurrency = (val: number) => new Intl.NumberFormat('vi-VN').format(val);

const TIME_OPTIONS = generateTimeOptions();

// --- SUB-COMPONENT: DATE SELECTOR ---
// (Gi·ªØ nguy√™n code DateSelector c≈© c·ªßa b·∫°n, kh√¥ng thay ƒë·ªïi)
interface DateSelectorProps {
  value: Date;
  onChange: (date: Date) => void;
  align?: 'left' | 'right';
}

const DateSelector = ({ value, onChange, align = 'left' }: DateSelectorProps) => {
    // ... (Gi·ªØ nguy√™n logic DateSelector nh∆∞ c≈©)
    // ƒê·ªÉ ti·∫øt ki·ªám kh√¥ng gian hi·ªÉn th·ªã, t√¥i xin ph√©p thu g·ªçn ph·∫ßn n√†y v√¨ n√≥ kh√¥ng ƒë·ªïi
    // B·∫°n h√£y gi·ªØ nguy√™n code DateSelector c≈© nh√©
    const [isOpen, setIsOpen] = useState(false);
    const [viewDate, setViewDate] = useState(value);
    const containerRef = useRef<HTMLDivElement>(null);
    useEffect(() => { if (isOpen) setViewDate(value); }, [isOpen, value]);
    useEffect(() => {
        const handleClickOutside = (e: MouseEvent) => {
        if (containerRef.current && !containerRef.current.contains(e.target as Node)) setIsOpen(false);
        };
        if (isOpen) document.addEventListener('mousedown', handleClickOutside);
        return () => document.removeEventListener('mousedown', handleClickOutside);
    }, [isOpen]);
    const daysInMonth = useMemo(() => eachDayOfInterval({ start: startOfMonth(viewDate), end: endOfMonth(viewDate) }), [viewDate]);
    const startDay = getDay(startOfMonth(viewDate));
    const paddingDaysCount = startDay === 0 ? 6 : startDay - 1;
    const paddingDays = Array(paddingDaysCount).fill(null);

    return (
        <div ref={containerRef} className="relative inline-block ml-2">
        <span onClick={(e) => { e.stopPropagation(); setIsOpen(!isOpen); }} className={`text-xs font-medium cursor-pointer transition-all border-b border-transparent ${isOpen ? 'text-[var(--admin-primary)] border-[var(--admin-primary)]' : 'text-[var(--admin-sub)] hover:text-[var(--admin-fg)] hover:border-[var(--admin-sub)]'}`}>{format(value, 'dd/MM', { locale: vi })}</span>
        {isOpen && (
            <div onClick={(e) => e.stopPropagation()} className={`absolute top-full mt-2 p-3 bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-xl shadow-xl z-[60] w-64 animate-in fade-in zoom-in-95 duration-100 ${align === 'right' ? 'right-0' : 'left-0'}`}>
            <div className="flex items-center justify-between mb-3">
                <button onClick={() => setViewDate(subMonths(viewDate, 1))} className="hover:bg-[var(--admin-hover)] p-1 rounded text-[var(--admin-sub)] text-xs">‚Äπ</button>
                <div className="text-[11px] font-bold text-[var(--admin-fg)] uppercase tracking-wider">Th√°ng {format(viewDate, 'MM/yyyy')}</div>
                <button onClick={() => setViewDate(addMonths(viewDate, 1))} className="hover:bg-[var(--admin-hover)] p-1 rounded text-[var(--admin-sub)] text-xs">‚Ä∫</button>
            </div>
            <div className="grid grid-cols-7 text-center text-[9px] gap-y-2 text-[var(--admin-sub)] font-medium mb-1"><span>T2</span><span>T3</span><span>T4</span><span>T5</span><span>T6</span><span>T7</span><span className="text-red-400">CN</span></div>
            <div className="grid grid-cols-7 text-center text-[10px] gap-1">
                {paddingDays.map((_, i) => <span key={`pad-${i}`} />)}
                {daysInMonth.map(d => {
                    const isSelected = isSameDay(d, value); const isToday = isSameDay(d, new Date());
                    return (<span key={d.toString()} onClick={() => { onChange(d); setIsOpen(false); }} className={`cursor-pointer h-7 w-7 flex items-center justify-center rounded-full transition-all ${isSelected ? 'bg-[var(--admin-primary)] text-white font-bold shadow-md' : isToday ? 'text-[var(--admin-primary)] font-bold border border-[var(--admin-primary)]' : 'text-[var(--admin-fg)] hover:bg-[var(--admin-hover)]'}`}>{format(d, 'd')}</span>)
                })}
            </div>
            </div>
        )}
        </div>
    );
};

// --- SUB-COMPONENT: TIME SELECTOR ---
// (Gi·ªØ nguy√™n code TimeSelector c≈© c·ªßa b·∫°n)
interface TimeSelectorProps {
  label: string;
  timeValue: string;
  dateValue: Date;
  onTimeChange: (val: string) => void;
  onDateChange: (val: Date) => void;
  className?: string;
  align?: 'left' | 'right';
}
const TimeSelector = ({ label, timeValue, dateValue, onTimeChange, onDateChange, className, align = 'left' }: TimeSelectorProps) => {
    // ... (Gi·ªØ nguy√™n logic TimeSelector)
    const [isOpen, setIsOpen] = useState(false);
    const containerRef = useRef<HTMLDivElement>(null);
    useEffect(() => {
        const handleClickOutside = (e: MouseEvent) => {
        if (containerRef.current && !containerRef.current.contains(e.target as Node)) setIsOpen(false);
        };
        if (isOpen) document.addEventListener('mousedown', handleClickOutside);
        return () => document.removeEventListener('mousedown', handleClickOutside);
    }, [isOpen]);
    return (
        <div className={`relative ${className}`}>
        <span className="text-[10px] font-bold text-[var(--admin-sub)] uppercase mb-1 block tracking-wider">{label}</span>
        <div className="flex items-baseline gap-1 select-none">
            <div ref={containerRef} onClick={() => setIsOpen(!isOpen)} className="flex items-center gap-1 cursor-pointer group">
                <span className={`text-2xl font-bold text-[var(--admin-fg)] border-b-2 border-transparent transition-all ${isOpen ? 'border-[var(--admin-primary)] text-[var(--admin-primary)]' : 'group-hover:border-[var(--admin-sub)]'}`}>{timeValue}</span>
                <ChevronDown size={14} className={`text-[var(--admin-sub)] transition-transform ${isOpen ? 'rotate-180' : ''}`} />
            </div>
            <DateSelector value={dateValue} onChange={onDateChange} align={align} />
        </div>
        {isOpen && (
            <div ref={containerRef} className={`absolute top-full mt-2 w-32 max-h-60 overflow-y-auto bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-xl shadow-xl z-50 table-scrollbar animate-in fade-in zoom-in-95 duration-100 ${align === 'right' ? 'right-0' : 'left-0'}`}>
            {TIME_OPTIONS.map((t) => (
                <div key={t} onClick={() => { onTimeChange(t); setIsOpen(false); }} className={`px-4 py-2 text-sm cursor-pointer transition-colors flex items-center justify-between ${t === timeValue ? 'bg-[var(--admin-primary)] text-white font-bold' : 'text-[var(--admin-fg)] hover:bg-[var(--admin-hover)]'}`}>{t}{t === timeValue && <Check size={14} />}</div>
            ))}
            </div>
        )}
        </div>
    );
};

// --- MAIN COMPONENT ---

interface BookingCreateModalProps {
  isOpen: boolean;
  onClose: () => void;
  initialData: {
    start: Date;
    end: Date;
    roomId: number;
  };
  rooms: RoomWithBranch[];
  services: ServiceItem[];
  // customers: CustomerRow[]; // <--- 2. X√ìA D√íNG N√ÄY ƒê·ªÇ FIX L·ªñI
  currentUserId: number;
}

export default function BookingCreateModal({
  isOpen,
  onClose,
  initialData,
  rooms,
  services,
  // customers: initialCustomers, // <--- 3. X√ìA NH·∫¨N PROP N√ÄY
  currentUserId
}: BookingCreateModalProps) {
  
  // --- STATES ---
  // Thay th·∫ø state customers tƒ©nh b·∫±ng state searchResults
  const [searchResults, setSearchResults] = useState<CustomerRow[]>([]); 
  const [isSearchingCustomer, setIsSearchingCustomer] = useState(false);

  const [isSubmitting, setIsSubmitting] = useState(false);
  
  // Th·ªùi gian
  const [startTimeStr, setStartTimeStr] = useState('');
  const [endTimeStr, setEndTimeStr] = useState('');
  const [bookingDate, setBookingDate] = useState<Date>(new Date());
  
  const [selectedRoomId, setSelectedRoomId] = useState(initialData.roomId);
  const [selectedCustomerId, setSelectedCustomerId] = useState<number | ''>('');
  const [note, setNote] = useState('');
  const [deposit, setDeposit] = useState<number>(0);
  const [selectedServices, setSelectedServices] = useState<{ id: number; quantity: number }[]>([]);

  // CUSTOMER SEARCH STATES
  const [isCreatingCustomer, setIsCreatingCustomer] = useState(false);
  const [customerSearch, setCustomerSearch] = useState(''); 
  const [isCustomerDropdownOpen, setIsCustomerDropdownOpen] = useState(false); 
  const customerInputRef = useRef<HTMLDivElement>(null);

  // New Customer Form States
  const [newCustomerName, setNewCustomerName] = useState('');
  const [newCustomerPhone, setNewCustomerPhone] = useState('');
  const [isCreatingCustLoading, setIsCreatingCustLoading] = useState(false);

  const initStartMillis = initialData.start.getTime();
  const initEndMillis = initialData.end.getTime();
  const initRoomId = initialData.roomId;

  // Sync Data khi m·ªü Modal
  useEffect(() => {
    if (isOpen) {
      const startDate = new Date(initStartMillis);
      const endDate = new Date(initEndMillis);

      setStartTimeStr(format(startDate, 'HH:mm'));
      setEndTimeStr(format(endDate, 'HH:mm'));
      setBookingDate(startDate); 
      
      setSelectedRoomId(initRoomId);
      
      setSelectedCustomerId('');
      setNote('');
      setDeposit(0);
      setSelectedServices([]);
      
      setIsCreatingCustomer(false);
      setCustomerSearch('');
      setIsCustomerDropdownOpen(false);
      setNewCustomerName('');
      setNewCustomerPhone('');
      setSearchResults([]); // Reset k·∫øt qu·∫£ t√¨m ki·∫øm
    }
  }, [isOpen, initStartMillis, initEndMillis, initRoomId]);

  // --- 4. LOGIC SEARCH ASYNC (THAY TH·∫æ FILTER CLIENT-SIDE) ---
  useEffect(() => {
    // Debounce search ƒë·ªÉ tr√°nh spam API
    const delayDebounceFn = setTimeout(async () => {
        if (customerSearch.trim().length > 0) {
            setIsSearchingCustomer(true);
            try {
                // G·ªçi Server Action t√¨m ki·∫øm
                const results = await getCustomers(customerSearch, 10);
                setSearchResults(results);
            } catch (error) {
                console.error("Search error", error);
                setSearchResults([]);
            } finally {
                setIsSearchingCustomer(false);
            }
        } else {
            setSearchResults([]);
        }
    }, 300); // Delay 300ms

    return () => clearTimeout(delayDebounceFn);
  }, [customerSearch]);

  useEffect(() => {
    const handleClickOutside = (e: MouseEvent) => {
      if (customerInputRef.current && !customerInputRef.current.contains(e.target as Node)) {
        setIsCustomerDropdownOpen(false);
      }
    };
    if (isCustomerDropdownOpen) {
      document.addEventListener('mousedown', handleClickOutside);
    }
    return () => document.removeEventListener('mousedown', handleClickOutside);
  }, [isCustomerDropdownOpen]);


  const handleSelectCustomer = (customer: CustomerRow) => {
    setSelectedCustomerId(customer.customer_id);
    setCustomerSearch(customer.full_name); 
    setIsCustomerDropdownOpen(false);
  };

  // --- LOGIC T√çNH TO√ÅN (Gi·ªØ nguy√™n) ---
  const durationHours = useMemo(() => {
    const [startH, startM] = startTimeStr.split(':').map(Number);
    const [endH, endM] = endTimeStr.split(':').map(Number);
    if (isNaN(startH) || isNaN(endH)) return 0;
    
    let duration = (endH + endM / 60) - (startH + startM / 60);
    if (duration < 0) duration += 24;
    return Math.max(0, duration);
  }, [startTimeStr, endTimeStr]);

  const roomPricePerHour = 500000;
  const roomTotal = durationHours * roomPricePerHour;

  const servicesTotal = selectedServices.reduce((acc, item) => {
    const service = services.find(s => s.service_id === item.id);
    return acc + (service ? service.price * item.quantity : 0);
  }, 0);

  const grandTotal = roomTotal + servicesTotal;

  // --- HANDLERS ---

  const handleCreateCustomer = async () => {
    if (!newCustomerName.trim() || !newCustomerPhone.trim()) {
      toast.error('Vui l√≤ng nh·∫≠p t√™n v√† s·ªë ƒëi·ªán tho·∫°i');
      return;
    }
    setIsCreatingCustLoading(true);
    
    const formData = new FormData();
    formData.append('full_name', newCustomerName);
    formData.append('phone', newCustomerPhone);
    formData.append('customer_type', 'regular');

    const res = await createCustomer(formData);
    
    setIsCreatingCustLoading(false);

    if (res.success && res.data) {
      toast.success('ƒê√£ th√™m kh√°ch h√†ng m·ªõi!');
      const newCust = res.data as CustomerRow;
      // Th√™m kh√°ch m·ªõi v√†o list searchResults ƒë·ªÉ ch·ªçn lu√¥n
      setSearchResults([newCust]); 
      
      setSelectedCustomerId(newCust.customer_id);
      setCustomerSearch(newCust.full_name);
      
      setIsCreatingCustomer(false); 
    } else {
      toast.error(res.error || 'L·ªói t·∫°o kh√°ch h√†ng');
    }
  };

  const handleAddService = (serviceId: string) => {
    const id = Number(serviceId);
    if (!id) return;
    
    const existing = selectedServices.find(s => s.id === id);
    if (existing) {
      setSelectedServices(prev => prev.map(s => s.id === id ? { ...s, quantity: s.quantity + 1 } : s));
    } else {
      setSelectedServices(prev => [...prev, { id, quantity: 1 }]);
    }
  };

  const handleSubmit = async () => {
    if (!selectedCustomerId) {
      toast.error('Ch∆∞a ch·ªçn kh√°ch h√†ng');
      return;
    }

    const baseDate = format(bookingDate, 'yyyy-MM-dd');
    const startISO = `${baseDate}T${startTimeStr}:00`;
    const endISO = `${baseDate}T${endTimeStr}:00`;

    if (new Date(startISO) >= new Date(endISO)) {
        toast.error('Gi·ªù k·∫øt th√∫c ph·∫£i sau gi·ªù b·∫Øt ƒë·∫ßu');
        return;
    }

    setIsSubmitting(true);

    try {
      const payload = {
        customerId: Number(selectedCustomerId),
        staffId: currentUserId,
        deposit: deposit,
        discount: 0,
        notes: note,
        items: [{
          roomId: selectedRoomId,
          startDt: new Date(startISO).toISOString(),
          endDt: new Date(endISO).toISOString(),
          price: roomTotal
        }],
        services: selectedServices.map(s => {
          const sv = services.find(x => x.service_id === s.id)!;
          return {
            serviceId: s.id,
            quantity: s.quantity,
            price: sv.price,
            type: sv.type
          };
        })
      };

      const result = await createBooking(payload);

      if (result.success) {
        toast.success('ƒê·∫∑t l·ªãch th√†nh c√¥ng!');
        onClose();
        window.location.reload(); 
      } else {
        toast.error(result.error);
      }
    } catch (error) {
      const msg = (error as Error).message || 'L·ªói k·∫øt n·ªëi h·ªá th·ªëng';
      toast.error(msg);
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <ModalPortal isOpen={isOpen} onClose={onClose} title="T·∫°o L·ªãch M·ªõi" className="max-w-3xl">
      <div className="flex flex-col md:flex-row h-[80vh] md:h-auto">
        
        {/* --- LEFT COLUMN: INPUT FORM --- */}
        <div className="flex-1 p-6 space-y-6 overflow-y-auto table-scrollbar">
          
          {/* 1. CH·ªåN GI·ªú & NG√ÄY */}
          <div className="bg-[var(--admin-bg)] p-5 rounded-2xl border border-[var(--admin-border)] flex items-center justify-between gap-4">
             <TimeSelector 
                label="B·∫Øt ƒë·∫ßu" 
                timeValue={startTimeStr} 
                dateValue={bookingDate} 
                onTimeChange={setStartTimeStr}
                onDateChange={setBookingDate}
             />
             <div className="h-8 w-[1px] bg-[var(--admin-border)]"></div>
             <TimeSelector 
                label="K·∫øt th√∫c" 
                timeValue={endTimeStr} 
                dateValue={bookingDate} 
                onTimeChange={setEndTimeStr}
                onDateChange={setBookingDate}
                className="text-right flex flex-col items-end"
                align="right"
             />
          </div>

          {/* 2. CH·ªåN PH√íNG */}
          <div>
             <label className="text-xs font-bold text-[var(--admin-sub)] uppercase mb-2 block">Ph√≤ng Studio</label>
             <div className="relative">
                <select
                    className="w-full p-3 pl-10 bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-xl appearance-none outline-none focus:border-[var(--admin-primary)] focus:ring-1 focus:ring-[var(--admin-primary)] transition-all cursor-pointer text-[var(--admin-fg)] font-medium"
                    value={selectedRoomId}
                    onChange={(e) => setSelectedRoomId(Number(e.target.value))}
                >
                    {rooms.filter(r => r.status === 'available' && !(r.is_equipment_room === true))
                      .map(r => (
                        <option key={r.room_id} value={r.room_id}>{r.name || r.code}</option>
                    ))}
                </select>
                <div className="absolute left-3 top-3.5 text-[var(--admin-sub)]">
                    <CalendarIcon size={18} />
                </div>
                <div className="absolute right-3 top-3.5 pointer-events-none text-[var(--admin-sub)]">
                    <ChevronDown size={16} />
                </div>
             </div>
          </div>

          {/* 3. KH√ÅCH H√ÄNG (ƒê√É UPDATE ASYNC SEARCH) */}
          <div className="space-y-2" ref={customerInputRef}>
             <div className="flex justify-between items-center mb-1">
                <label className="text-xs font-bold text-[var(--admin-sub)] uppercase">Kh√°ch H√†ng</label>
                {!isCreatingCustomer && (
                    <button 
                        onClick={() => setIsCreatingCustomer(true)}
                        className="text-[10px] bg-[var(--admin-primary)]/10 text-[var(--admin-primary)] px-2 py-1 rounded-md font-bold hover:bg-[var(--admin-primary)] hover:text-white transition-colors flex items-center gap-1"
                    >
                        <Plus size={12} /> T·∫†O M·ªöI
                    </button>
                )}
             </div>

             {isCreatingCustomer ? (
                // FORM T·∫†O KH√ÅCH INLINE
                <div className="bg-[var(--admin-bg)] p-4 rounded-xl border border-[var(--admin-border)] space-y-3 animate-fade-in-up">
                    <div className="flex items-center justify-between mb-2">
                        <span className="text-sm font-bold text-[var(--admin-fg)]">Th√¥ng tin kh√°ch m·ªõi</span>
                        <button onClick={() => setIsCreatingCustomer(false)} className="text-[var(--admin-sub)] hover:text-[var(--admin-fg)]"><X size={16}/></button>
                    </div>
                    <input 
                        className="w-full p-2.5 rounded-lg border border-[var(--admin-border)] bg-[var(--admin-card)] text-sm focus:border-[var(--admin-primary)] outline-none"
                        placeholder="H·ªç v√† t√™n *"
                        value={newCustomerName}
                        onChange={e => setNewCustomerName(e.target.value)}
                    />
                    <input 
                        className="w-full p-2.5 rounded-lg border border-[var(--admin-border)] bg-[var(--admin-card)] text-sm focus:border-[var(--admin-primary)] outline-none"
                        placeholder="S·ªë ƒëi·ªán tho·∫°i *"
                        value={newCustomerPhone}
                        onChange={e => setNewCustomerPhone(e.target.value)}
                    />
                    <button 
                        onClick={handleCreateCustomer}
                        disabled={isCreatingCustLoading}
                        className="w-full py-2 bg-[var(--admin-fg)] text-[var(--admin-bg)] rounded-lg text-sm font-bold hover:opacity-90 flex justify-center items-center gap-2"
                    >
                        {isCreatingCustLoading ? <Loader2 className="animate-spin" size={14}/> : <Check size={14}/>} L∆∞u kh√°ch h√†ng
                    </button>
                </div>
             ) : (
                // SEARCHABLE INPUT (ASYNC)
                <div className="relative">
                    <div className="relative">
                        <User size={18} className="absolute left-3 top-3.5 text-[var(--admin-sub)]" />
                        <input
                            type="text"
                            placeholder="Nh·∫≠p t√™n ho·∫∑c SƒêT..."
                            className="w-full p-3 pl-10 pr-10 bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-xl outline-none focus:border-[var(--admin-primary)] focus:ring-1 focus:ring-[var(--admin-primary)] transition-all text-[var(--admin-fg)]"
                            value={customerSearch}
                            onChange={(e) => {
                                setCustomerSearch(e.target.value);
                                setIsCustomerDropdownOpen(true);
                                if (e.target.value === '') setSelectedCustomerId('');
                            }}
                            onFocus={() => setIsCustomerDropdownOpen(true)}
                        />
                        {/* Loading Icon khi ƒëang search */}
                        {isSearchingCustomer && (
                             <div className="absolute right-10 top-3.5 text-[var(--admin-primary)]">
                                <Loader2 size={16} className="animate-spin" />
                             </div>
                        )}
                        
                        {customerSearch && (
                            <button 
                                onClick={() => { setCustomerSearch(''); setSelectedCustomerId(''); setSearchResults([]) }}
                                className="absolute right-3 top-3.5 text-[var(--admin-sub)] hover:text-[var(--admin-fg)]"
                            >
                                <X size={16} />
                            </button>
                        )}
                        {!customerSearch && <Search size={16} className="absolute right-3 top-3.5 text-[var(--admin-sub)]" />}
                    </div>

                    {/* DROPDOWN RESULTS */}
                    {isCustomerDropdownOpen && customerSearch && (
                        <div className="absolute top-full left-0 right-0 mt-1 max-h-48 overflow-y-auto bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-xl shadow-lg z-50 table-scrollbar animate-in fade-in zoom-in-95 duration-100">
                            {searchResults.length === 0 ? (
                                <div className="p-3 text-center text-sm text-[var(--admin-sub)] italic">
                                    {isSearchingCustomer ? 'ƒêang t√¨m...' : 'Kh√¥ng t√¨m th·∫•y kh√°ch h√†ng.'}
                                </div>
                            ) : (
                                searchResults.map(c => (
                                    <div
                                        key={c.customer_id}
                                        onClick={() => handleSelectCustomer(c)}
                                        className="px-4 py-3 hover:bg-[var(--admin-hover)] cursor-pointer border-b border-[var(--admin-border)] last:border-0"
                                    >
                                        <div className="text-sm font-bold text-[var(--admin-fg)]">{c.full_name}</div>
                                        <div className="text-xs text-[var(--admin-sub)]">{c.phone || 'Kh√¥ng c√≥ SƒêT'}</div>
                                    </div>
                                ))
                            )}
                        </div>
                    )}
                </div>
             )}
          </div>

          {/* 4. D·ªäCH V·ª§ TH√äM (Gi·ªØ nguy√™n) */}
          <div>
             <label className="text-xs font-bold text-[var(--admin-sub)] uppercase mb-2 block">D·ªãch v·ª• ƒëi k√®m</label>
             <div className="relative">
                <select
                    className="w-full p-3 pl-10 bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-xl appearance-none outline-none focus:border-[var(--admin-primary)] transition-all cursor-pointer text-[var(--admin-fg)] text-sm"
                    onChange={(e) => {
                        handleAddService(e.target.value);
                        e.target.value = ''; 
                    }}
                >
                    <option value="">+ Th√™m d·ªãch v·ª•...</option>
                    {services.map(s => (
                        <option key={s.service_id} value={s.service_id}>
                            {s.name} (+{new Intl.NumberFormat('vi-VN').format(s.price)}ƒë)
                        </option>
                    ))}
                </select>
                <Plus size={18} className="absolute left-3 top-3.5 text-[var(--admin-sub)]" />
             </div>
             {selectedServices.length > 0 && (
                 <div className="mt-3 space-y-2">
                    {selectedServices.map(item => {
                        const sInfo = services.find(s => s.service_id === item.id);
                        return (
                            <div key={item.id} className="flex justify-between items-center bg-[var(--admin-bg)] p-2 rounded-lg border border-[var(--admin-border)] animate-fade-in-row">
                                <span className="text-sm font-medium text-[var(--admin-fg)]">{sInfo?.name}</span>
                                <div className="flex items-center gap-3">
                                    <span className="text-xs text-[var(--admin-sub)]">x{item.quantity}</span>
                                    <button 
                                        onClick={() => setSelectedServices(prev => prev.filter(x => x.id !== item.id))}
                                        className="text-[var(--admin-sub)] hover:text-red-500 transition-colors"
                                    >
                                        <Trash2 size={14}/>
                                    </button>
                                </div>
                            </div>
                        )
                    })}
                 </div>
             )}
          </div>

          <div className="grid grid-cols-2 gap-4">
             {/* Ti·ªÅn c·ªçc */}
             <div>
                <label className="text-xs font-bold text-[var(--admin-sub)] uppercase mb-2 block">
                  Ti·ªÅn c·ªçc (VNƒê)
                </label>
                <div className="relative">
                  <input 
                    type="text"
                    className="w-full p-3 rounded-xl bg-[var(--admin-card)] border border-[var(--admin-border)] focus:border-[var(--admin-primary)] outline-none font-mono text-sm font-bold"
                    placeholder="0"
                    value={deposit > 0 ? formatCurrency(deposit) : ''} 
                    onChange={e => {
                        const rawValue = e.target.value.replace(/[^0-9]/g, '');
                        setDeposit(Number(rawValue));
                    }}
                  />
                </div>
                {deposit > 0 && (
                  <div className="text-right mt-1">
                     <span className="text-[10px] text-[var(--admin-sub)] italic">
                        {deposit.toLocaleString('vi-VN')} ƒë
                     </span>
                  </div>
                )}
             </div>
             {/* Ghi ch√∫ */}
             <div>
                <label className="text-xs font-bold text-[var(--admin-sub)] uppercase mb-2 block">Ghi ch√∫</label>
                <input 
                    className="w-full p-3 rounded-xl bg-[var(--admin-card)] border border-[var(--admin-border)] focus:border-[var(--admin-primary)] outline-none text-sm"
                    placeholder="..."
                    value={note}
                    onChange={e => setNote(e.target.value)}
                />
             </div>
          </div>
        </div>

        {/* --- RIGHT COLUMN: SUMMARY & ACTIONS (Gi·ªØ nguy√™n) --- */}
        <div className="w-full md:w-80 bg-[var(--admin-bg)] border-t md:border-t-0 md:border-l border-[var(--admin-border)] p-6 flex flex-col justify-between">
            <div className="space-y-6">
                <h3 className="text-sm font-bold text-[var(--admin-sub)] uppercase tracking-wider">Chi ti·∫øt thanh to√°n</h3>
                <div className="space-y-3">
                    <div className="flex justify-between text-sm">
                        <span className="text-[var(--admin-sub)]">Ti·ªÅn ph√≤ng ({durationHours.toFixed(1)}h)</span>
                        <span className="font-medium text-[var(--admin-fg)]">{new Intl.NumberFormat('vi-VN').format(roomTotal)} VNƒê</span>
                    </div>
                    <div className="flex justify-between text-sm">
                        <span className="text-[var(--admin-sub)]">D·ªãch v·ª•</span>
                        <span className="font-medium text-[var(--admin-fg)]">{new Intl.NumberFormat('vi-VN').format(servicesTotal)} VNƒê</span>
                    </div>
                    <div className="border-t border-[var(--admin-border)] my-2"></div>
                    <div className="flex justify-between text-base font-bold">
                        <span className="text-[var(--admin-fg)]">T·ªîNG C·ªòNG</span>
                        <span className="text-[var(--admin-primary)] text-lg">{new Intl.NumberFormat('vi-VN').format(grandTotal)} VNƒê</span>
                    </div>
                    {deposit > 0 && (
                        <div className="flex justify-between text-sm text-green-600">
                            <span>ƒê√£ c·ªçc</span>
                            <span>-{new Intl.NumberFormat('vi-VN').format(deposit)} VNƒê</span>
                        </div>
                    )}
                </div>
            </div>

            <div className="mt-8 space-y-3">
                <button 
                    onClick={handleSubmit}
                    disabled={isSubmitting}
                    className="w-full py-3.5 bg-[var(--admin-primary)] text-[var(--admin-bg)] rounded-xl font-bold hover:opacity-90 shadow-lg shadow-indigo-500/20 transition-all flex items-center justify-center gap-2 disabled:opacity-70"
                >
                    {isSubmitting ? <Loader2 className="animate-spin"/> : <Check size={18}/>}
                    X√°c nh·∫≠n ƒê·∫∑t L·ªãch
                </button>
                <button 
                    onClick={onClose}
                    className="w-full py-3 border border-[var(--admin-border)] text-[var(--admin-sub)] hover:text-[var(--admin-fg)] hover:bg-[var(--admin-hover)] rounded-xl font-medium transition-colors"
                >
                    H·ªßy b·ªè
                </button>
            </div>
        </div>
      </div>
    </ModalPortal>
  );
}
```

## File: src/components/admin/calendar/NavCalendarWidget.tsx
```typescript
'use client'

import { useState, useEffect, useMemo } from 'react'
import { useRouter, usePathname } from 'next/navigation';
import { CalendarIcon, ChevronDown, Check, Plus } from 'lucide-react';
import { format, startOfMonth, endOfMonth, eachDayOfInterval, getDay, isSameDay, addMonths, subMonths } from 'date-fns';
import { useCalendar } from '@/context/CalendarContext';
import { ROOM_COLORS } from '@/lib/constants'; //

interface Room {
  room_id: number;
  name: string | null;
  status?: 'available' | 'maintenance' | 'inactive';
  is_equipment_room?: boolean | null;
}

export default function NavCalendarWidget({ rooms }: { rooms: Room[] }) {
  const router = useRouter();
  const pathname = usePathname();
  const [isExpanded, setIsExpanded] = useState(true); 
  
  const { 
    date, 
    setDate, 
    setCreateModalOpen, 
    visibleRoomIds, 
    toggleRoomVisibility,
    setVisibleRoomIds
  } = useCalendar();


  const availableRooms = useMemo(() => {
    return rooms.filter(r => 
        r.status === 'available' && 
        !(r.is_equipment_room === true)
    );
  }, [rooms]);

  // Kh·ªüi t·∫°o: M·∫∑c ƒë·ªãnh ch·ªçn t·∫•t c·∫£ ph√≤ng khi m·ªõi load
  useEffect(() => {
    if (availableRooms.length > 0 && visibleRoomIds.length === 0) {
        const allIds = availableRooms.map(r => r.room_id);
        setVisibleRoomIds(allIds);
    }
  }, [availableRooms, visibleRoomIds.length, setVisibleRoomIds]);

  // Logic chuy·ªÉn trang
  const navigateToCalendar = () => {
    if (pathname !== '/admin/calendar') {
        router.push('/admin/calendar');
    }
  };

  // Logic Mini Calendar
  const currentMonthStart = startOfMonth(date);
  const currentMonthEnd = endOfMonth(date);
  const daysInMonth = eachDayOfInterval({ start: currentMonthStart, end: currentMonthEnd });
  const startDayOfWeek = getDay(currentMonthStart); 
  const paddingCount = startDayOfWeek === 0 ? 6 : startDayOfWeek - 1;
  const paddingDays = Array.from({ length: paddingCount });

  const handleDateClick = (d: Date) => {
    setDate(d);
    navigateToCalendar();
    if (!isExpanded) setIsExpanded(true);
  };

  const handleQuickCreate = (e: React.MouseEvent) => {
    e.stopPropagation();
    setCreateModalOpen(true);
    navigateToCalendar(); 
  };

  return (
    <div className="my-1">
      {/* Header Button */}
      <div className="flex items-stretch gap-[1px]"> 
        <button 
          onClick={() => { navigateToCalendar() }}
          className={`flex-1 flex items-center gap-3 px-4 py-2.5 text-sm font-medium rounded-l-lg cursor-pointer transition-all duration-200 
            ${pathname === '/admin/calendar' 
              ? 'bg-[var(--admin-bg)] text-[var(--admin-primary)] shadow-md shadow-gray-500/20' 
              : 'text-[var(--admin-sub)] hover:bg-[var(--admin-hover)] hover:text-[var(--admin-fg)]'
            }`}
        >
            <CalendarIcon size={20} />
            <span className="truncate ">L·ªãch Studio</span>
        </button>
        <button 
          onClick={(e) => { e.stopPropagation(); setIsExpanded(!isExpanded); }}
          className="w-8 flex items-center justify-center cursor-pointer rounded-r-lg transition-all duration-200 text-[var(--admin-sub)] hover:bg-[var(--admin-hover)]"
        >
           <ChevronDown size={14} className={`transition-transform duration-200 ${isExpanded ? 'rotate-180' : ''}`} />
        </button>
      </div>

      {/* Expandable Content */}
      <div className={`grid transition-all duration-300 ease-in-out overflow-hidden ${isExpanded ? 'grid-rows-[1fr] opacity-100 mt-3' : 'grid-rows-[0fr] opacity-0'}`}>
        <div className="min-h-0 space-y-4">
            
            {/* N√∫t T·∫°o Nhanh */}
            <button 
                onClick={handleQuickCreate}
                className="w-full flex items-center justify-center gap-2 bg-[var(--admin-card)] 
                border border-[var(--admin-primary)] text-[var(--admin-fg)] text-xs font-bold py-2 
                rounded-lg hover:bg-[var(--admin-primary)] hover:text-[var(--admin-bg)] transition-all cursor-pointer shadow-sm"
            >
                <Plus size={14} /> T·∫†O BOOKING
            </button>

            {/* Mini Calendar */}
            <div className="bg-[var(--admin-card)] p-3 rounded-lg border border-[var(--admin-border)] shadow-sm">
                <div className="flex items-center justify-between mb-3">
                    <button onClick={() => setDate(subMonths(date, 1))} className="hover:bg-[var(--admin-hover)] p-1 rounded text-[var(--admin-sub)] text-xs">‚Äπ</button>
                    <div className="text-[11px] font-bold text-[var(--admin-fg)] uppercase tracking-wider">
                        Th√°ng {format(date, 'MM/yyyy')}
                    </div>
                    <button onClick={() => setDate(addMonths(date, 1))} className="hover:bg-[var(--admin-hover)] p-1 rounded text-[var(--admin-sub)] text-xs">‚Ä∫</button>
                </div>
                
                <div className="grid grid-cols-7 text-center text-[9px] gap-y-2 text-[var(--admin-sub)] font-medium mb-1">
                    <span>T2</span><span>T3</span><span>T4</span><span>T5</span><span>T6</span><span>T7</span><span className="text-red-400">CN</span>
                </div>
                
                <div className="grid grid-cols-7 text-center text-[10px] gap-1">
                    {paddingDays.map((_, i) => <span key={`pad-${i}`} />)}
                    {daysInMonth.map(d => {
                        const isSelected = isSameDay(d, date);
                        return (
                            <span 
                                key={d.toString()} 
                                onClick={(e) => { e.stopPropagation(); handleDateClick(d); }}
                                className={`
                                    cursor-pointer h-6 w-6 flex items-center justify-center rounded-full transition-all
                                    ${isSelected 
                                        ? 'bg-[var(--admin-primary)] text-[var(--admin-primary-fg)] font-bold shadow-md' 
                                        : 'text-[var(--admin-fg)] hover:bg-[var(--admin-hover)]'
                                    }
                                `}
                            >
                                {format(d, 'd')}
                            </span>
                        )
                    })}
                </div>
            </div>

            {/* B·ªô l·ªçc ph√≤ng */}
            <div className="space-y-2">
                <div className="flex items-center justify-between px-1">
                     <p className="text-[10px] font-bold text-[var(--admin-sub)] uppercase">Hi·ªÉn th·ªã ph√≤ng:</p>
                     <button 
                        onClick={() => setVisibleRoomIds(availableRooms.map(r => r.room_id))}
                        className="text-[9px] text-[var(--admin-primary)] hover:underline cursor-pointer hover:text-[var(--admin-fg)]"
                     >
                        T·∫•t c·∫£
                     </button>
                </div>
                
                <div className="max-h-[200px] overflow-y-auto no-scrollbar space-y-1">
                    {availableRooms.length > 0 ? (
                        availableRooms.map((room, index) => {
                            const isChecked = visibleRoomIds.includes(room.room_id);
                            // L·∫•y m√†u d·ª±a tr√™n index c·ªßa m·∫£ng ƒë√£ l·ªçc
                            const color = ROOM_COLORS[index % ROOM_COLORS.length]; 

                            return (
                                <div 
                                    key={room.room_id} 
                                    onClick={() => toggleRoomVisibility(room.room_id)}
                                    className="flex items-center gap-3 cursor-pointer group py-1.5 px-2 hover:bg-[var(--admin-hover)] rounded-md transition-colors"
                                >
                                    <div 
                                        className={`w-4 h-4 rounded border flex items-center justify-center transition-all ${isChecked ? 'border-transparent' : 'border-[var(--admin-sub)] bg-transparent'}`}
                                        style={{ backgroundColor: isChecked ? color : undefined }}
                                    >
                                        {isChecked && <Check size={10} className="text-white" />}
                                    </div>

                                    <span className={`text-xs truncate transition-opacity ${isChecked ? 'text-[var(--admin-fg)] font-medium' : 'text-[var(--admin-sub)] opacity-70'}`}>
                                        {room.name || `Ph√≤ng ${room.room_id}`}
                                    </span>
                                </div>
                            )
                        })
                    ) : (
                        <p className="text-xs text-[var(--admin-sub)] text-center py-2 italic">
                            Kh√¥ng c√≥ ph√≤ng tr·ªëng
                        </p>
                    )}
                </div>
            </div>
        </div>
      </div>
    </div>
  )
}
```

## File: src/components/admin/DeleteProjectButton.tsx
```typescript
// src/components/admin/DeleteProjectButton.tsx
'use client';

import { useState } from 'react';
import { Trash2 } from 'lucide-react';
import { toast } from 'sonner';
import { deleteProject } from '@/lib/actions';
import { createBrowserClient } from '@supabase/ssr';
import ConfirmModal from '@/components/ui/ConfirmModal';

export default function DeleteProjectButton({ projectId, projectTitle }: { projectId: number, projectTitle: string }) {
  const [isDeleting, setIsDeleting] = useState(false);
  const [showModal, setShowModal] = useState(false); 
  const supabase = createBrowserClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
  );

  const handleDelete = async () => {
    const confirmMsg = `C·∫¢NH B√ÅO: B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a d·ª± √°n "${projectTitle}"?\nH√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c!`;
    if (!window.confirm(confirmMsg)) return;

    setIsDeleting(true);
    const toastId = toast.loading('ƒêang x√≥a...');

    try {
      const { data: { session } } = await supabase.auth.getSession();
      
      if (!session) {
        toast.error('Kh√¥ng t√¨m th·∫•y phi√™n ƒëƒÉng nh·∫≠p. Vui l√≤ng F5.', { id: toastId });
        setIsDeleting(false);
        setShowModal(false);
        return;
      }

      // 4. G·ªåI SERVER ACTION
      const res = await deleteProject(session.access_token, projectId);

      if (res.success) {
        toast.success('ƒê√£ x√≥a d·ª± √°n', { id: toastId });
        setShowModal(false)
        // Refresh c·ª©ng ƒë·ªÉ ƒë·∫£m b·∫£o danh s√°ch c·∫≠p nh·∫≠t s·∫°ch s·∫Ω
        setTimeout(() => {
            window.location.reload(); 
        }, 500);
      } else {
        toast.error(`L·ªói: ${res.error}`, { id: toastId });
        setIsDeleting(false);
      }
    } catch (error) {
        const msg = error instanceof Error ? error.message : 'C√≥ l·ªói x·∫£y ra';
        toast.error(msg, { id: toastId });
    } finally {
      setIsDeleting(false);
    }
  };

  return (
  <main>
      {/* N√∫t th√πng r√°c (Ch·ªâ m·ªü Modal) */}
      <button 
        onClick={() => setShowModal(true)}
        className="p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors"
        title="X√≥a d·ª± √°n"
      >
        <Trash2 size={18} />
      </button>

      {/* Modal x√°c nh·∫≠n */}
      <ConfirmModal 
        isOpen={showModal}
        onClose={() => !isDeleting && setShowModal(false)} // Kh√¥ng cho ƒë√≥ng khi ƒëang x√≥a d·ªü
        onConfirm={handleDelete}
        title="X√≥a d·ª± √°n n√†y?"
        description={`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a d·ª± √°n "${projectTitle}"? H√†nh ƒë·ªông n√†y s·∫Ω x√≥a vƒ©nh vi·ªÖn to√†n b·ªô th√¥ng tin v√† h√¨nh ·∫£nh li√™n quan. Kh√¥ng th·ªÉ ho√†n t√°c.`}
        confirmText={isDeleting ? "ƒêang x√≥a..." : "X√≥a vƒ©nh vi·ªÖn"}
        cancelText="H·ªßy b·ªè"
        variant="danger"
        isLoading={isDeleting}
      />
    </main>
  );
}
```

## File: src/components/Container.tsx
```typescript
import { ReactNode } from "react";

interface ContainerProps {
  children: ReactNode;
  className?: string;
}

export default function Container({ children, className = "" }: ContainerProps) {
  return (
    <div className={`mx-auto lg:max-w-9/10 md:max-w-7xl px-4 sm:px-6 lg:px-8 ${className}`}>
      {children}
    </div>
  );
}
```

## File: src/components/HomePageContent.tsx
```typescript
// src/components/HomePageContent.tsx

'use client';

import dynamic from 'next/dynamic';

// 1. T·∫£i ngay l·∫≠p t·ª©c
import HeroSection from '@/components/HeroSection';

// 2. T·∫°o m·ªôt component Loading (Tr·∫°ng th√°i ch·ªù)
const LoadingSpinner = () => (
  <div className="h-96 flex items-center justify-center">
    <p>ƒêang t·∫£i...</p>
  </div>
);

// 3. T·∫£i l∆∞·ªùi (Dynamic Imports) cho c√°c section b√™n d∆∞·ªõi
const DynamicPortfolioSection = dynamic(
  () => import('@/components/PortfolioSection'), // Gi·∫£ ƒë·ªãnh component n√†y t·ªìn t·∫°i
  { ssr: false, loading: () => <LoadingSpinner /> }
);

const DynamicProjectShowcase = dynamic(
  () => import('@/components/ProjectShowcase'), // Gi·∫£ ƒë·ªãnh component n√†y t·ªìn t·∫°i
  { ssr: false, loading: () => <LoadingSpinner /> }
);


const DynamicContactSection = dynamic(
  () => import('@/components/ContactSection'),
  { ssr: false, loading: () => <LoadingSpinner /> }
);

// 4. ƒê·ªïi t√™n function (t·ª´ HomePage th√†nh HomePageContent)
export default function HomePageContent() {
  return (
    <main>
      {/* Section 01 (T·∫£i ngay) */}
      <HeroSection />

      {/* Section 02 (T·∫£i l∆∞·ªùi) */}
      <section id="portfolio" className="md:pt-24">
        <DynamicPortfolioSection />
      </section>

      {/* Section 03 (T·∫£i l∆∞·ªùi) */}
      <section id="showcase" className="md:pt-24">
        <DynamicProjectShowcase />
      </section>

      {/* Section 04 (T·∫£i l∆∞·ªùi) */}
      <section id="contact">
        <DynamicContactSection />
      </section>
    </main>
  );
}
```

## File: src/components/PhilosophyBackground.tsx
```typescript
// src/components/PhilosophyBackground.tsx
'use client';

import ScrollBaseAnimation from '@/components/scroll-text-marque';

export default function PhilosophyBackground() {
  return (
    <div className="absolute inset-0 z-10 flex flex-col justify-center 
                    opacity-10 dark:opacity-5 
                    pointer-events-none gap-4 md:gap-8">

      <ScrollBaseAnimation
        baseVelocity={-3}
        className="text-6xl font-bold uppercase whitespace-nowrap"
      >
        TH∆Ø∆†NG M·∫†I ‚Ä¢ TH·ªúI TRANG ‚Ä¢ C√Å NH√ÇN ‚Ä¢
      </ScrollBaseAnimation>

      <ScrollBaseAnimation
        baseVelocity={3}
        className="text-9xl font-bold uppercase whitespace-nowrap text-center"
      >
        KHO·∫¢NH KH·∫ÆC ‚Ä¢ S√ÅNG T·∫†O ‚Ä¢ ONI STUDIO ‚Ä¢
      </ScrollBaseAnimation>

      <ScrollBaseAnimation
        baseVelocity={-2}
        className="text-6xl font-bold uppercase whitespace-nowrap"
      >
        LOOKBOOK ‚Ä¢ PORTRAIT ‚Ä¢ PHOTOGRAPHY ‚Ä¢
      </ScrollBaseAnimation>
    </div>
  );
}
```

## File: src/components/ScrollingText.tsx
```typescript
// // src/components/ui/ScrollingText.tsx
// 'use client';

// import { useRef, useState } from 'react';
// import {
//   motion,
//   useScroll,
//   useMotionValueEvent,
// } from 'framer-motion';

// // ƒê·ªãnh nghƒ©a props cho component
// interface ScrollingTextProps {
//   text: string;
//   className?: string;
//   direction?: 'left' | 'right'; 
//   speed?: number; // T·ªëc ƒë·ªô ch·∫°y (s), c√†ng nh·ªè c√†ng nhanh
// }


// /**
//  * Component ch√≠nh
//  */
// export const ScrollingText = ({
//   text,
//   className = '',
//   direction = 'left',
//   speed = 15, // M·∫∑c ƒë·ªãnh 15s cho 1 v√≤ng
// }: ScrollingTextProps) => {
//   const containerRef = useRef<HTMLDivElement>(null);
  
//   // 1. THEO D√ïI H∆Ø·ªöNG CU·ªòN
//   const { scrollY } = useScroll();
//   const [scrollDirection, setScrollDirection] = useState<'up' | 'down'>('down');

//   useMotionValueEvent(scrollY, 'change', (latest) => {
//     const previous = scrollY.getPrevious() ?? 0;
//     if (latest > previous) {
//       setScrollDirection('down');
//     } else {
//       setScrollDirection('up');
//     }
//   });

//   // 2. T·∫†O ANIMATION
//   // D·ª±a tr√™n h∆∞·ªõng cu·ªôn, ch√∫ng ta ƒë·ªïi h∆∞·ªõng ch·∫°y c·ªßa ch·ªØ
//   const effectiveDirection =
//     scrollDirection === 'down' ? direction : direction === 'left' ? 'right' : 'left';


//   // T·∫°o gi√° tr·ªã 'from' v√† 'to' cho animation
//   const fromX = effectiveDirection === 'left' ? 0 : -2000;
//   const toX = effectiveDirection === 'left' ? -2000 : 0;

//   return (
//     <div
//       ref={containerRef}
//       className={`relative w-full overflow-hidden ${className}`}
//     >
//       <motion.div
//         className="relative"
//         // S·ª≠ d·ª•ng 'animate' v√† 'transition' c·ªßa Framer Motion
//         animate={{ x: [fromX, toX] }}
//         transition={{
//           repeat: Infinity,
//           repeatType: 'loop',
//           duration: speed, // D√πng speed (gi√¢y) l√†m duration
//           ease: 'linear',
//         }}
//         style={{
//           width: '400%', // G·∫•p 4 l·∫ßn v√¨ c√≥ 4 b·∫£n sao
//           display: 'flex',
//         }}
//       >
//         {/* Render 4 b·∫£n sao. ƒê√£ x√≥a style 'speed' b·ªã l·ªói */}
//         <span className="block w-1/4 mr-8">{text}</span>
//         <span className="block w-1/4 mr-8">{text}</span>
//         <span className="block w-1/4 mr-8">{text}</span>
//         <span className="block w-1/4 mr-8">{text}</span>
//       </motion.div>
//     </div>
//   );
// };
```

## File: src/components/ui/SelectBox.tsx
```typescript
// src/components/ui/SelectBox.tsx
'use client';

import { useState, useRef, useEffect } from 'react';
import { ChevronDown, Check } from 'lucide-react';

interface Option {
  label: string;
  value: string | number;
}

interface SelectBoxProps {
  label?: string; // Label hi·ªÉn th·ªã b√™n tr√™n (optional)
  value: string | number;
  onChange: (value: string) => void;
  options: Option[];
  placeholder?: string;
  required?: boolean;
  icon?: React.ReactNode; // Icon trang tr√≠ b√™n tr√°i
  className?: string;
}

export default function SelectBox({
  label,
  value,
  onChange,
  options,
  placeholder = "Ch·ªçn m·ªôt t√πy ch·ªçn",
  required = false,
  icon,
  className = ""
}: SelectBoxProps) {
  const [isOpen, setIsOpen] = useState(false);
  const containerRef = useRef<HTMLDivElement>(null);

  // T√¨m label c·ªßa gi√° tr·ªã hi·ªán t·∫°i
  const selectedLabel = options.find(opt => String(opt.value) === String(value))?.label;

  // ƒê√≥ng khi click ra ngo√†i
  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {
        setIsOpen(false);
      }
    };
    document.addEventListener('mousedown', handleClickOutside);
    return () => document.removeEventListener('mousedown', handleClickOutside);
  }, []);

  return (
    <div className={`space-y-2 ${className}`} ref={containerRef}>
      {label && (
        <label className="text-sm font-medium text-[var(--admin-fg)]">
          {label} {required && <span className="text-red-500">*</span>}
        </label>
      )}

      <div className="relative">
        <button
          type="button" // Quan tr·ªçng: type button ƒë·ªÉ kh√¥ng submit form
          onClick={() => setIsOpen(!isOpen)}
          className={`
            w-full flex items-center justify-between px-4 py-3 rounded-lg border transition-all
            bg-[var(--admin-bg)] text-left
            ${isOpen 
              ? 'border-[var(--admin-primary)] ring-2 ring-[var(--admin-primary)]/20' 
              : 'border-[var(--admin-border)] hover:border-[var(--admin-sub)]'
            }
          `}
        >
          <div className="flex items-center gap-2 truncate text-[var(--admin-fg)]">
            {icon}
            <span className={selectedLabel ? "" : "text-[var(--admin-sub)]"}>
              {selectedLabel || placeholder}
            </span>
          </div>
          <ChevronDown 
            size={18} 
            className={`text-[var(--admin-sub)] transition-transform duration-200 ${isOpen ? 'rotate-180' : ''}`} 
          />
        </button>

        {/* DROPDOWN MENU */}
        {isOpen && (
          <div className="absolute top-full left-0 right-0 mt-2 bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-xl shadow-xl z-50 animate-in fade-in zoom-in-95 duration-100 overflow-hidden max-h-60 overflow-y-auto">
            <div className="p-1.5">
              {options.length === 0 ? (
                <div className="p-3 text-center text-sm text-[var(--admin-sub)] italic">
                  Kh√¥ng c√≥ d·ªØ li·ªáu
                </div>
              ) : (
                options.map((opt) => {
                  const isActive = String(opt.value) === String(value);
                  return (
                    <button
                      key={opt.value}
                      type="button"
                      onClick={() => {
                        onChange(String(opt.value));
                        setIsOpen(false);
                      }}
                      className={`
                        w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-sm transition-colors mb-0.5 cursor-pointer
                        ${isActive 
                          ? 'bg-[var(--admin-primary)]/10 text-[var(--admin-primary)] font-medium' 
                          : 'text-[var(--admin-fg)] hover:bg-[var(--admin-hover)]'
                        }
                      `}
                    >
                      <span>{opt.label}</span>
                      {isActive && <Check size={16} />}
                    </button>
                  );
                })
              )}
            </div>
          </div>
        )}
      </div>
    </div>
  );
}
```

## File: src/lib/actions/bookings.ts
```typescript
// src/lib/actions/bookings.ts
'use server'

import { createClient } from '@/lib/supabase/server'
import { revalidatePath } from 'next/cache'
import { getCleanupMinutes } from './settings' 

// --- 1. ƒê·ªäNH NGHƒ®A C√ÅC INTERFACE C·∫¶N THI·∫æT ---

// Interface cho vi·ªác check tr√πng (ƒë√£ c√≥)
interface BookingCollisionCheck {
  booking_item_id: number;
  booking_id: number;
  start_dt: string;
  end_dt: string;
  cleanup_minutes: number | null;
}

interface ActiveBookingResult {
  booking_id: number;
  bookings: {
    status: string | null;
  } | null;
}

// Interface CHU·∫®N cho d·ªØ li·ªáu tr·∫£ v·ªÅ Calendar (FIX L·ªñI SelectQueryError)
export interface CalendarBookingItem {
  booking_item_id: number;
  start_dt: string;
  end_dt: string;
  room_id: number;
  cleanup_minutes?: number | null; // C·ªôt m·ªõi th√™m
  rooms: { 
    name: string | null; 
    code: string | null; 
  } | null;
  bookings: {
    booking_id: number;
    status: string | null;
    customer_id: number | null;
    customers: { 
      full_name: string | null; 
      phone: string | null; 
    } | null;
  } | null;
}

export interface BookingItemInput {
  roomId: number;
  startDt: string; 
  endDt: string;   
  price: number;   
}

export interface ServiceInput {
  serviceId: number;
  quantity: number;
  price: number;   
  type: 'service' | 'surcharge' | 'compensation';
}

export interface CreateBookingDTO {
  customerId: number; 
  staffId: number;    
  deposit: number;    
  discount: number;   
  discountReason?: string;
  notes?: string;
  items: BookingItemInput[]; 
  services?: ServiceInput[]; 
}

// ==============================================================================
// 1. KI·ªÇM TRA PH√íNG TR·ªêNG (CHECK AVAILABILITY)
// ==============================================================================
export async function checkRoomAvailability(roomId: number, startStr: string, endStr: string) {
  const supabase = await createClient()
  const currentGap = await getCleanupMinutes();

  const { data: rawData, error } = await supabase
    .from('booking_items')
    .select('booking_item_id, booking_id, start_dt, end_dt, cleanup_minutes') 
    .eq('room_id', roomId)
    .filter('start_dt', 'lt', new Date(new Date(endStr).getTime() + 120 * 60000).toISOString()) 
    .filter('end_dt', 'gt', new Date(new Date(startStr).getTime() - 120 * 60000).toISOString())

  if (error) return { valid: false, error: error.message }

  const data = rawData as unknown as BookingCollisionCheck[];

  if (data && data.length > 0) {
    const itemIds = data.map(i => i.booking_item_id)
    
    const { data: rawActiveBookings } = await supabase
      .from('booking_items')
      .select('booking_id, bookings!inner(status)')
      .in('booking_item_id', itemIds)
      .in('bookings.status', ['pending', 'confirmed', 'checked_in'])
    
    const activeBookings = rawActiveBookings as unknown as ActiveBookingResult[];
    
    if (activeBookings && activeBookings.length > 0) {
      const isOverlap = data.some(existingItem => {
        const isActive = activeBookings.find(ab => ab.booking_id === existingItem.booking_id);
        if (!isActive) return false;

        const oldStart = new Date(existingItem.start_dt).getTime();
        const oldEnd = new Date(existingItem.end_dt).getTime();
        const oldGap = (existingItem.cleanup_minutes || 60) * 60000; 

        const newStart = new Date(startStr).getTime();
        const newEnd = new Date(endStr).getTime();
        const newGap = currentGap * 60000;

        const clash1 = (newStart < oldEnd + oldGap) && (newEnd > oldStart);
        const clash2 = (oldStart < newEnd + newGap) && (oldEnd > newStart);

        return clash1 || clash2;
      });

      if (isOverlap) {
        return { valid: false, error: `Ph√≤ng b·ªã tr√πng l·ªãch ho·∫∑c vi ph·∫°m th·ªùi gian d·ªçn d·∫πp.` }
      }
    }
  }

  return { valid: true }
}

// ==============================================================================
// 2. T·∫†O BOOKING (TRANSACTION)
// ==============================================================================

export async function createBooking(payload: CreateBookingDTO) {
  const supabase = await createClient()
  const currentCleanupMinutes = await getCleanupMinutes();

  // --- B∆Ø·ªöC 1: T·∫†O HEADER ---
  const { data: booking, error: bookingError } = await supabase
    .from('bookings')
    .insert({
      customer_id: payload.customerId,
      created_by: payload.staffId,
      status: 'confirmed', 
      deposit_amount: payload.deposit,
      deposit_paid: 0, 
      discount_amount: payload.discount,
      discount_reason: payload.discountReason,
      notes: payload.notes,
      vat_percent_snapshot: 8, 
      total_estimate: 0, 
      total_actual: 0
    })
    .select()
    .single()

  if (bookingError) return { success: false, error: 'L·ªói t·∫°o ƒë∆°n: ' + bookingError.message }
  
  // FIX: Thay th·∫ø 'any' b·∫±ng ƒë·ªãnh nghƒ©a ki·ªÉu inline ƒë·ªÉ tr√°nh l·ªói Linter
  const bookingId = (booking as { booking_id: number }).booking_id;

  // --- B∆Ø·ªöC 2: T·∫†O ITEMS ---
  try {
    const itemsToInsert = payload.items.map(item => ({
      booking_id: bookingId,
      room_id: item.roomId,
      start_dt: item.startDt,
      end_dt: item.endDt,
      price_snapshot: item.price,
      cleanup_minutes: currentCleanupMinutes 
    }))

    const { error: itemsError } = await supabase
      .from('booking_items')
      .insert(itemsToInsert)

    if (itemsError) throw itemsError 

    // --- B∆Ø·ªöC 3: T·∫†O SERVICES ---
    if (payload.services && payload.services.length > 0) {
      const servicesToInsert = payload.services.map(s => ({
        booking_id: bookingId,
        service_id: s.serviceId,
        quantity: s.quantity,
        type: s.type,
        unit_price_snapshot: s.price,
        computed_amount: s.quantity * s.price
      }))

      const { error: serviceError } = await supabase
        .from('booking_services')
        .insert(servicesToInsert)
      
      if (serviceError) throw serviceError
    }
    
    revalidatePath('/admin/bookings')
    revalidatePath('/admin/calendar')
    return { success: true, bookingId }

  } catch (error: unknown) {
    console.error("Booking Transaction Failed. Rolling back...", error)
    await supabase.from('bookings').delete().eq('booking_id', bookingId)
    
    const errMsg = error instanceof Error ? error.message : JSON.stringify(error);
    return { success: false, error: 'ƒê·∫∑t ph√≤ng th·∫•t b·∫°i: ' + errMsg }
  }
}

// ==============================================================================
// 3. L·∫§Y DANH S√ÅCH BOOKING (CHO CALENDAR)
// ==============================================================================

export async function getBookingsForCalendar(startStr: string, endStr: string) {
  const supabase = await createClient()

  const { data, error } = await supabase
    .from('booking_items')
    .select(`
      *,
      cleanup_minutes, 
      rooms ( name, code ),
      bookings ( 
        status, 
        customer_id, 
        customers ( full_name, phone )
      )
    `)
    .lt('start_dt', endStr)
    .gt('end_dt', startStr)
    .not('bookings.status', 'eq', 'cancelled')

  if (error) {
    console.error("Error fetching calendar bookings:", error);
    return [];
  }

  // FIX L·ªñI TypeScript: √âp ki·ªÉu 'data' (ƒëang b·ªã Supabase hi·ªÉu l√† l·ªói) v·ªÅ Interface chu·∫©n
  // K·ªπ thu·∫≠t "Double Casting": (data as unknown) -> as CalendarBookingItem[]
  return (data as unknown) as CalendarBookingItem[];
}


// H√†m update th·ªùi gian & ph√≤ng khi k√©o th·∫£
export async function updateBookingTime(
  bookingItemId: number, 
  newStart: string, 
  newEnd: string, 
  newRoomId: number
) {
  const supabase = await createClient();

  const { error } = await supabase
    .from('booking_items')
    .update({
      start_dt: newStart,
      end_dt: newEnd,
      room_id: newRoomId
    })
    .eq('booking_item_id', bookingItemId);

  if (error) return { success: false, error: error.message };
  
  revalidatePath('/admin'); 
  return { success: true };
}
```

## File: src/lib/actions/studio.ts
```typescript
'use server'

import { createClient } from '@/lib/supabase/server'
import { revalidatePath } from 'next/cache'
import { Database } from '@/types/supabase'

// ƒê·ªãnh nghƒ©a l·∫°i c√°c Type tr·∫£ v·ªÅ cho UI d·ªÖ d√πng
// K·ªπ thu·∫≠t: L·∫•y Type d√≤ng (Row) t·ª´ Database v√† m·ªü r·ªông th√™m quan h·ªá
export type RoomWithBranch = Database['public']['Tables']['rooms']['Row'] & {
  branches: { name: string; branch_code: string } | null
}

export interface ServiceItem {
  service_id: number;
  name: string;
  price: number;
  unit: string | null;
  is_active: boolean | null;
  type: 'service' | 'surcharge' | 'compensation';
  // --- TH√äM D√íNG N√ÄY ---
  // ƒê·ªãnh nghƒ©a category kh·ªõp v·ªõi c√°c Tab b·∫°n ƒëang d√πng
  category?: 'equipment' | 'fnb' | 'surcharge' | string; 
}

// ==============================================================================
// 1. CHI NH√ÅNH (BRANCHES)
// ==============================================================================

export async function getBranches() {
  const supabase = await createClient()
  const { data, error } = await supabase
    .from('branches')
    .select('*')
    .eq('is_active', true)
    .order('created_at')

  if (error) {
    console.error('Error fetching branches:', error)
    return []
  }
  return data
}

// ==============================================================================
// 2. PH√íNG (ROOMS)
// ==============================================================================

export async function getRooms(): Promise<RoomWithBranch[]> {
  const supabase = await createClient()
  
  // L·∫•y ph√≤ng k√®m th√¥ng tin chi nh√°nh (Join b·∫£ng)
  const { data, error } = await supabase
    .from('rooms')
    .select(`
      *,
      branches (
        name,
        branch_code
      )
    `)
    .order('branch_id')
    .order('code')

  if (error) {
    console.error('Error fetching rooms:', error)
    return []
  }
  
  // √âp ki·ªÉu v·ªÅ RoomWithBranch ƒë·ªÉ TypeScript hi·ªÉu c·∫•u tr√∫c Join
  return data as unknown as RoomWithBranch[]
}

export async function createRoom(formData: FormData) {
  const supabase = await createClient()

  // L·∫•y d·ªØ li·ªáu t·ª´ Form
  // L∆∞u √Ω: DB v2 ƒë√£ b·ªè c·ªôt cleanup_minutes, d√πng Global Setting n√™n kh√¥ng c·∫ßn g·ª≠i l√™n
  const rawData = {
    branch_id: Number(formData.get('branch_id')),
    code: formData.get('code') as string,
    name: formData.get('name') as string,
    capacity: Number(formData.get('capacity') || 0),
    is_rentable: formData.get('is_rentable') === 'on',
    is_equipment_room: formData.get('is_equipment_room') === 'on',
    status: 'available' as const // ENUM: available | maintenance | inactive
  }

  const { error } = await supabase.from('rooms').insert(rawData)

  if (error) {
    return { success: false, error: error.message }
  }

  revalidatePath('/admin/rooms')
  return { success: true }
}

export async function toggleRoomStatus(roomId: number, currentStatus: string) {
  const supabase = await createClient()
  
  // Logic ƒë∆°n gi·∫£n: switch gi·ªØa available <-> maintenance
  const newStatus = currentStatus === 'available' ? 'maintenance' : 'available'

  const { error } = await supabase
    .from('rooms')
    .update({ status: newStatus as 'available' | 'maintenance' | 'inactive' })
    .eq('room_id', roomId)

  if (error) return { success: false, error: error.message }
  
  revalidatePath('/admin/rooms')
  return { success: true }
}

// ==============================================================================
// 3. D·ªäCH V·ª§ & PH·ª§ THU (SERVICES)
// ==============================================================================

export async function getServices() {
  const supabase = await createClient()
  
  const { data, error } = await supabase
    .from('services')
    .select('*')
    .eq('is_active', true)
    .order('type') // Gom nh√≥m theo: service, surcharge, compensation
    .order('name')

  if (error) return []
  return data
}

export async function createService(formData: FormData) {
  const supabase = await createClient()

  const rawData = {
    name: formData.get('name') as string,
    price: Number(formData.get('price')),
    // √âp ki·ªÉu ENUM service_type
    type: formData.get('type') as 'service' | 'surcharge' | 'compensation',
    unit: formData.get('unit') as string || 'item'
  }

  const { error } = await supabase.from('services').insert(rawData)

  if (error) return { success: false, error: error.message }

  revalidatePath('/admin/services')
  return { success: true }
}

export async function deleteService(serviceId: number) {
    const supabase = await createClient()
    
    // Soft delete: Ch·ªâ t·∫Øt active ch·ª© kh√¥ng x√≥a vƒ©nh vi·ªÖn ƒë·ªÉ gi·ªØ l·ªãch s·ª≠ booking
    const { error } = await supabase
      .from('services')
      .update({ is_active: false })
      .eq('service_id', serviceId)
  
    if (error) return { success: false, error: error.message }
  
    revalidatePath('/admin/services')
    return { success: true }
}
```

## File: src/lib/constants.ts
```typescript
// src/lib/constants.ts

/**
 * C√†i ƒë·∫∑t chung cho c√°c layout d·∫°ng grid
 */

// S·ªë l∆∞·ª£ng item gi·∫£ c·∫ßn cho m·ªói trang
export const DESIRED_PROJECT_COUNT = 48;

// S·ªë l∆∞·ª£ng item t·∫£i ban ƒë·∫ßu khi v√†o trang
export const INITIAL_LOAD_COUNT = 8;

// S·ªë l∆∞·ª£ng item t·∫£i th√™m m·ªói l·∫ßn cu·ªôn
export const LOAD_MORE_COUNT = 8;

export const SLUG_CATE_PERSONAL = 'ca-nhan';
export const SLUG_CATE_COMMERCIAL = 'thuong-mai';
export const SLUG_CATE_FASHION = 'thoi-trang';


export const ROOM_COLORS = [
  '#4285F4', // Xanh d∆∞∆°ng (Google)
  '#34A853', // Xanh l√°
  '#EA4335', // ƒê·ªè
  '#FBBC05', // V√†ng
  '#8E24AA', // T√≠m
  '#F6BF26', // Cam
  '#06b6d4', // Cyan
  '#ec4899', // Pink
];
```

## File: src/lib/utils.ts
```typescript
// src/lib/utils.ts
import { type ClassValue, clsx } from "clsx"
import { twMerge } from "tailwind-merge"
import { differenceInMinutes } from 'date-fns';

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}

// H√†m format ti·ªÅn t·ªá cho g·ªçn
export const fmtMoney = (amount: number) => {
  return new Intl.NumberFormat('vi-VN').format(amount) + ' VNƒê';
};

export const formatDuration = (minutes: number) => {
    const h = Math.floor(minutes / 60);
    const m = minutes % 60;
    
    if (h > 0) {
        return `${h}h${m > 0 ? `${m}p` : ''}`; // V√≠ d·ª•: 2h39p ho·∫∑c 2h
    }
    return `${m}p`; // V√≠ d·ª•: 45p
};
export const calculateBilling = (
    bookedStart: Date,
    bookedEnd: Date,
    actualIn: Date | null,
    actualOut: Date | null,
    pricePerHour: number,
    settings: { earlyGrace: number; otFree: number }
) => {
    let totalSurcharge = 0;

    const earlyFee = {
        isBillable: false,
        minutes: 0,
        billableHours: 0,
        amount: 0,
        message: ''
    };

    const otFee = {
        isBillable: false,
        minutes: 0,
        billableHours: 0,
        amount: 0,
        message: ''
    };

    // 1. Logic Check-in S·ªõm
    if (actualIn) {
        const earlyMinutes = differenceInMinutes(bookedStart, actualIn);
        earlyFee.minutes = earlyMinutes;

        if (earlyMinutes > settings.earlyGrace) {
            // Logic: L√†m tr√≤n l√™n m·ªói 15p
            const billableMinutes = Math.ceil(earlyMinutes / 15) * 15;
            const billableHours = billableMinutes / 60;
            
            earlyFee.isBillable = true;
            earlyFee.billableHours = billableHours;
            earlyFee.amount = billableHours * pricePerHour;
            
            // S·ª¨ D·ª§NG formatDuration ƒë·ªÉ hi·ªÉn th·ªã
            earlyFee.message = `S·ªõm ${formatDuration(earlyMinutes)} (T√≠nh ${billableHours}h)`;
            
            totalSurcharge += earlyFee.amount;
        }
    }

    // 2. Logic OT (Check-out Tr·ªÖ)
    const checkOutTime = actualOut || new Date(); 
    if (checkOutTime > bookedEnd) {
        const otMinutes = differenceInMinutes(checkOutTime, bookedEnd);
        otFee.minutes = otMinutes;

        if (otMinutes > settings.otFree) {
            // Logic: T√≠nh tr√≤n gi·ªù (l√†m tr√≤n xu·ªëng)
            const otHours = Math.floor(otMinutes / 60);
            
            if (otHours > 0) {
                otFee.isBillable = true;
                otFee.billableHours = otHours;
                otFee.amount = otHours * pricePerHour;

                // S·ª¨ D·ª§NG formatDuration ƒë·ªÉ hi·ªÉn th·ªã
                otFee.message = `Tr·ªÖ ${formatDuration(otMinutes)} (T√≠nh ${otHours}h)`;
                
                totalSurcharge += otFee.amount;
            }
        }
    }

    return { 
        totalSurcharge, 
        earlyFee, 
        otFee 
    };
};
```

## File: src/types/supabase.ts
```typescript
export type Json =
  | string
  | number
  | boolean
  | null
  | { [key: string]: Json | undefined }
  | Json[]

export type Database = {
  // Allows to automatically instantiate createClient with right options
  // instead of createClient<Database, { PostgrestVersion: 'XX' }>(URL, KEY)
  __InternalSupabase: {
    PostgrestVersion: "14.1"
  }
  public: {
    Tables: {
      booking_items: {
        Row: {
          booking_id: number
          booking_item_id: number
          cleanup_minutes: number | null
          created_at: string | null
          end_dt: string
          is_all_day: boolean | null
          price_snapshot: number | null
          room_id: number
          start_dt: string
        }
        Insert: {
          booking_id: number
          booking_item_id?: number
          cleanup_minutes?: number | null
          created_at?: string | null
          end_dt: string
          is_all_day?: boolean | null
          price_snapshot?: number | null
          room_id: number
          start_dt: string
        }
        Update: {
          booking_id?: number
          booking_item_id?: number
          cleanup_minutes?: number | null
          created_at?: string | null
          end_dt?: string
          is_all_day?: boolean | null
          price_snapshot?: number | null
          room_id?: number
          start_dt?: string
        }
        Relationships: [
          {
            foreignKeyName: "booking_items_booking_id_fkey"
            columns: ["booking_id"]
            isOneToOne: false
            referencedRelation: "bookings"
            referencedColumns: ["booking_id"]
          },
          {
            foreignKeyName: "booking_items_room_id_fkey"
            columns: ["room_id"]
            isOneToOne: false
            referencedRelation: "rooms"
            referencedColumns: ["room_id"]
          },
        ]
      }
      booking_services: {
        Row: {
          booking_id: number
          booking_service_id: number
          computed_amount: number | null
          created_at: string | null
          quantity: number
          service_id: number
          type: Database["public"]["Enums"]["service_type"]
          unit_price_snapshot: number
        }
        Insert: {
          booking_id: number
          booking_service_id?: number
          computed_amount?: number | null
          created_at?: string | null
          quantity?: number
          service_id: number
          type?: Database["public"]["Enums"]["service_type"]
          unit_price_snapshot?: number
        }
        Update: {
          booking_id?: number
          booking_service_id?: number
          computed_amount?: number | null
          created_at?: string | null
          quantity?: number
          service_id?: number
          type?: Database["public"]["Enums"]["service_type"]
          unit_price_snapshot?: number
        }
        Relationships: [
          {
            foreignKeyName: "booking_services_booking_id_fkey"
            columns: ["booking_id"]
            isOneToOne: false
            referencedRelation: "bookings"
            referencedColumns: ["booking_id"]
          },
          {
            foreignKeyName: "booking_services_service_id_fkey"
            columns: ["service_id"]
            isOneToOne: false
            referencedRelation: "services"
            referencedColumns: ["service_id"]
          },
        ]
      }
      bookings: {
        Row: {
          booking_id: number
          booking_type: string | null
          check_in_at: string | null
          check_out_at: string | null
          created_at: string | null
          created_by: number | null
          customer_id: number | null
          deposit_amount: number | null
          deposit_paid: number | null
          discount_amount: number | null
          discount_reason: string | null
          notes: string | null
          status: Database["public"]["Enums"]["booking_status"] | null
          title: string | null
          total_actual: number | null
          total_estimate: number | null
          updated_at: string | null
          vat_percent_snapshot: number | null
          voucher_code: string | null
        }
        Insert: {
          booking_id?: number
          booking_type?: string | null
          check_in_at?: string | null
          check_out_at?: string | null
          created_at?: string | null
          created_by?: number | null
          customer_id?: number | null
          deposit_amount?: number | null
          deposit_paid?: number | null
          discount_amount?: number | null
          discount_reason?: string | null
          notes?: string | null
          status?: Database["public"]["Enums"]["booking_status"] | null
          title?: string | null
          total_actual?: number | null
          total_estimate?: number | null
          updated_at?: string | null
          vat_percent_snapshot?: number | null
          voucher_code?: string | null
        }
        Update: {
          booking_id?: number
          booking_type?: string | null
          check_in_at?: string | null
          check_out_at?: string | null
          created_at?: string | null
          created_by?: number | null
          customer_id?: number | null
          deposit_amount?: number | null
          deposit_paid?: number | null
          discount_amount?: number | null
          discount_reason?: string | null
          notes?: string | null
          status?: Database["public"]["Enums"]["booking_status"] | null
          title?: string | null
          total_actual?: number | null
          total_estimate?: number | null
          updated_at?: string | null
          vat_percent_snapshot?: number | null
          voucher_code?: string | null
        }
        Relationships: [
          {
            foreignKeyName: "bookings_created_by_fkey"
            columns: ["created_by"]
            isOneToOne: false
            referencedRelation: "users"
            referencedColumns: ["user_id"]
          },
          {
            foreignKeyName: "bookings_customer_id_fkey"
            columns: ["customer_id"]
            isOneToOne: false
            referencedRelation: "customers"
            referencedColumns: ["customer_id"]
          },
        ]
      }
      branches: {
        Row: {
          address: string | null
          branch_code: string
          branch_id: number
          created_at: string | null
          is_active: boolean | null
          name: string
          phone: string | null
          timezone: string | null
        }
        Insert: {
          address?: string | null
          branch_code: string
          branch_id?: number
          created_at?: string | null
          is_active?: boolean | null
          name: string
          phone?: string | null
          timezone?: string | null
        }
        Update: {
          address?: string | null
          branch_code?: string
          branch_id?: number
          created_at?: string | null
          is_active?: boolean | null
          name?: string
          phone?: string | null
          timezone?: string | null
        }
        Relationships: []
      }
      customers: {
        Row: {
          address: string | null
          cccd: string | null
          company_name: string | null
          created_at: string
          customer_id: number
          customer_type: Database["public"]["Enums"]["customer_type"]
          discount_rate: number | null
          email: string | null
          full_name: string
          is_active: boolean
          note: string | null
          phone: string | null
          tax_code: string | null
        }
        Insert: {
          address?: string | null
          cccd?: string | null
          company_name?: string | null
          created_at?: string
          customer_id?: number
          customer_type?: Database["public"]["Enums"]["customer_type"]
          discount_rate?: number | null
          email?: string | null
          full_name: string
          is_active?: boolean
          note?: string | null
          phone?: string | null
          tax_code?: string | null
        }
        Update: {
          address?: string | null
          cccd?: string | null
          company_name?: string | null
          created_at?: string
          customer_id?: number
          customer_type?: Database["public"]["Enums"]["customer_type"]
          discount_rate?: number | null
          email?: string | null
          full_name?: string
          is_active?: boolean
          note?: string | null
          phone?: string | null
          tax_code?: string | null
        }
        Relationships: []
      }
      employee_profiles: {
        Row: {
          base_salary: number | null
          contract_type: string | null
          created_at: string
          dob: string | null
          employee_id: number
          employment_status:
            | Database["public"]["Enums"]["employment_status"]
            | null
          hire_date: string | null
          salary_type: string | null
          user_id: number
        }
        Insert: {
          base_salary?: number | null
          contract_type?: string | null
          created_at?: string
          dob?: string | null
          employee_id?: number
          employment_status?:
            | Database["public"]["Enums"]["employment_status"]
            | null
          hire_date?: string | null
          salary_type?: string | null
          user_id: number
        }
        Update: {
          base_salary?: number | null
          contract_type?: string | null
          created_at?: string
          dob?: string | null
          employee_id?: number
          employment_status?:
            | Database["public"]["Enums"]["employment_status"]
            | null
          hire_date?: string | null
          salary_type?: string | null
          user_id?: number
        }
        Relationships: [
          {
            foreignKeyName: "employee_profiles_user_id_fkey"
            columns: ["user_id"]
            isOneToOne: true
            referencedRelation: "users"
            referencedColumns: ["user_id"]
          },
        ]
      }
      equipment_items: {
        Row: {
          condition: Database["public"]["Enums"]["item_condition"] | null
          created_at: string | null
          current_room_id: number | null
          item_id: number
          model_id: number
          qr_code: string
          serial_number: string | null
          status: Database["public"]["Enums"]["item_status"]
        }
        Insert: {
          condition?: Database["public"]["Enums"]["item_condition"] | null
          created_at?: string | null
          current_room_id?: number | null
          item_id?: number
          model_id: number
          qr_code: string
          serial_number?: string | null
          status?: Database["public"]["Enums"]["item_status"]
        }
        Update: {
          condition?: Database["public"]["Enums"]["item_condition"] | null
          created_at?: string | null
          current_room_id?: number | null
          item_id?: number
          model_id?: number
          qr_code?: string
          serial_number?: string | null
          status?: Database["public"]["Enums"]["item_status"]
        }
        Relationships: [
          {
            foreignKeyName: "equipment_items_current_room_id_fkey"
            columns: ["current_room_id"]
            isOneToOne: false
            referencedRelation: "rooms"
            referencedColumns: ["room_id"]
          },
          {
            foreignKeyName: "equipment_items_model_id_fkey"
            columns: ["model_id"]
            isOneToOne: false
            referencedRelation: "equipment_models"
            referencedColumns: ["model_id"]
          },
        ]
      }
      equipment_models: {
        Row: {
          available_quantity: number | null
          created_at: string | null
          default_hourly_price: number | null
          description: string | null
          is_active: boolean | null
          model_id: number
          name: string
          sku: string | null
          total_quantity: number | null
        }
        Insert: {
          available_quantity?: number | null
          created_at?: string | null
          default_hourly_price?: number | null
          description?: string | null
          is_active?: boolean | null
          model_id?: number
          name: string
          sku?: string | null
          total_quantity?: number | null
        }
        Update: {
          available_quantity?: number | null
          created_at?: string | null
          default_hourly_price?: number | null
          description?: string | null
          is_active?: boolean | null
          model_id?: number
          name?: string
          sku?: string | null
          total_quantity?: number | null
        }
        Relationships: []
      }
      files: {
        Row: {
          file_id: number
          file_name: string
          file_type: string | null
          file_url: string
          is_archive: boolean | null
          uploaded_at: string | null
          uploaded_by: number | null
        }
        Insert: {
          file_id?: number
          file_name: string
          file_type?: string | null
          file_url: string
          is_archive?: boolean | null
          uploaded_at?: string | null
          uploaded_by?: number | null
        }
        Update: {
          file_id?: number
          file_name?: string
          file_type?: string | null
          file_url?: string
          is_archive?: boolean | null
          uploaded_at?: string | null
          uploaded_by?: number | null
        }
        Relationships: [
          {
            foreignKeyName: "files_uploaded_by_fkey"
            columns: ["uploaded_by"]
            isOneToOne: false
            referencedRelation: "users"
            referencedColumns: ["user_id"]
          },
        ]
      }
      invoices: {
        Row: {
          booking_id: number
          created_at: string | null
          customer_id: number
          invoice_id: number
          issue_date: string | null
          paid_status: Database["public"]["Enums"]["invoice_status"] | null
          pdf_url: string | null
          qr_code_url: string | null
          subtotal: number
          total_amount: number
          vat_amount: number | null
        }
        Insert: {
          booking_id: number
          created_at?: string | null
          customer_id: number
          invoice_id?: number
          issue_date?: string | null
          paid_status?: Database["public"]["Enums"]["invoice_status"] | null
          pdf_url?: string | null
          qr_code_url?: string | null
          subtotal: number
          total_amount: number
          vat_amount?: number | null
        }
        Update: {
          booking_id?: number
          created_at?: string | null
          customer_id?: number
          invoice_id?: number
          issue_date?: string | null
          paid_status?: Database["public"]["Enums"]["invoice_status"] | null
          pdf_url?: string | null
          qr_code_url?: string | null
          subtotal?: number
          total_amount?: number
          vat_amount?: number | null
        }
        Relationships: [
          {
            foreignKeyName: "invoices_booking_id_fkey"
            columns: ["booking_id"]
            isOneToOne: false
            referencedRelation: "bookings"
            referencedColumns: ["booking_id"]
          },
          {
            foreignKeyName: "invoices_customer_id_fkey"
            columns: ["customer_id"]
            isOneToOne: false
            referencedRelation: "customers"
            referencedColumns: ["customer_id"]
          },
        ]
      }
      notifications: {
        Row: {
          body: string | null
          created_at: string | null
          is_read: boolean | null
          notification_id: number
          title: string
          type: string | null
          user_id: number | null
        }
        Insert: {
          body?: string | null
          created_at?: string | null
          is_read?: boolean | null
          notification_id?: number
          title: string
          type?: string | null
          user_id?: number | null
        }
        Update: {
          body?: string | null
          created_at?: string | null
          is_read?: boolean | null
          notification_id?: number
          title?: string
          type?: string | null
          user_id?: number | null
        }
        Relationships: [
          {
            foreignKeyName: "notifications_user_id_fkey"
            columns: ["user_id"]
            isOneToOne: false
            referencedRelation: "users"
            referencedColumns: ["user_id"]
          },
        ]
      }
      payments: {
        Row: {
          amount: number
          booking_id: number | null
          created_at: string | null
          customer_id: number | null
          method: Database["public"]["Enums"]["payment_method"] | null
          note: string | null
          parent_payment_id: number | null
          payment_id: number
          status: Database["public"]["Enums"]["payment_status"] | null
        }
        Insert: {
          amount: number
          booking_id?: number | null
          created_at?: string | null
          customer_id?: number | null
          method?: Database["public"]["Enums"]["payment_method"] | null
          note?: string | null
          parent_payment_id?: number | null
          payment_id?: number
          status?: Database["public"]["Enums"]["payment_status"] | null
        }
        Update: {
          amount?: number
          booking_id?: number | null
          created_at?: string | null
          customer_id?: number | null
          method?: Database["public"]["Enums"]["payment_method"] | null
          note?: string | null
          parent_payment_id?: number | null
          payment_id?: number
          status?: Database["public"]["Enums"]["payment_status"] | null
        }
        Relationships: [
          {
            foreignKeyName: "payments_booking_id_fkey"
            columns: ["booking_id"]
            isOneToOne: false
            referencedRelation: "bookings"
            referencedColumns: ["booking_id"]
          },
          {
            foreignKeyName: "payments_customer_id_fkey"
            columns: ["customer_id"]
            isOneToOne: false
            referencedRelation: "customers"
            referencedColumns: ["customer_id"]
          },
          {
            foreignKeyName: "payments_parent_payment_id_fkey"
            columns: ["parent_payment_id"]
            isOneToOne: false
            referencedRelation: "payments"
            referencedColumns: ["payment_id"]
          },
        ]
      }
      portfolio_categories: {
        Row: {
          category_id: number
          display_order: number | null
          is_active: boolean | null
          name: string
          slug: string
        }
        Insert: {
          category_id?: number
          display_order?: number | null
          is_active?: boolean | null
          name: string
          slug: string
        }
        Update: {
          category_id?: number
          display_order?: number | null
          is_active?: boolean | null
          name?: string
          slug?: string
        }
        Relationships: []
      }
      project_images: {
        Row: {
          alt_text: string | null
          created_by: number | null
          display_order: number | null
          height: number | null
          image_id: number
          image_url: string
          project_id: number
          width: number | null
        }
        Insert: {
          alt_text?: string | null
          created_by?: number | null
          display_order?: number | null
          height?: number | null
          image_id?: number
          image_url: string
          project_id: number
          width?: number | null
        }
        Update: {
          alt_text?: string | null
          created_by?: number | null
          display_order?: number | null
          height?: number | null
          image_id?: number
          image_url?: string
          project_id?: number
          width?: number | null
        }
        Relationships: [
          {
            foreignKeyName: "project_images_created_by_fkey"
            columns: ["created_by"]
            isOneToOne: false
            referencedRelation: "users"
            referencedColumns: ["user_id"]
          },
          {
            foreignKeyName: "project_images_project_id_fkey"
            columns: ["project_id"]
            isOneToOne: false
            referencedRelation: "projects"
            referencedColumns: ["project_id"]
          },
        ]
      }
      projects: {
        Row: {
          category_id: number
          client_name: string | null
          col_span: number | null
          content: Json | null
          cover_url: string | null
          created_at: string | null
          created_by: number | null
          credits: Json | null
          description: string | null
          display_order: number | null
          is_demo: boolean | null
          is_featured: boolean | null
          project_id: number
          published_at: string | null
          row_span: number | null
          slug: string
          thumbnail_url: string | null
          title: string
          updated_at: string | null
        }
        Insert: {
          category_id: number
          client_name?: string | null
          col_span?: number | null
          content?: Json | null
          cover_url?: string | null
          created_at?: string | null
          created_by?: number | null
          credits?: Json | null
          description?: string | null
          display_order?: number | null
          is_demo?: boolean | null
          is_featured?: boolean | null
          project_id?: number
          published_at?: string | null
          row_span?: number | null
          slug: string
          thumbnail_url?: string | null
          title: string
          updated_at?: string | null
        }
        Update: {
          category_id?: number
          client_name?: string | null
          col_span?: number | null
          content?: Json | null
          cover_url?: string | null
          created_at?: string | null
          created_by?: number | null
          credits?: Json | null
          description?: string | null
          display_order?: number | null
          is_demo?: boolean | null
          is_featured?: boolean | null
          project_id?: number
          published_at?: string | null
          row_span?: number | null
          slug?: string
          thumbnail_url?: string | null
          title?: string
          updated_at?: string | null
        }
        Relationships: [
          {
            foreignKeyName: "projects_category_id_fkey"
            columns: ["category_id"]
            isOneToOne: false
            referencedRelation: "portfolio_categories"
            referencedColumns: ["category_id"]
          },
          {
            foreignKeyName: "projects_created_by_fkey"
            columns: ["created_by"]
            isOneToOne: false
            referencedRelation: "users"
            referencedColumns: ["user_id"]
          },
        ]
      }
      rooms: {
        Row: {
          branch_id: number
          capacity: number | null
          code: string
          created_at: string | null
          is_equipment_room: boolean | null
          is_rentable: boolean | null
          name: string | null
          price_per_hour: number | null
          room_id: number
          status: Database["public"]["Enums"]["room_status"]
        }
        Insert: {
          branch_id: number
          capacity?: number | null
          code: string
          created_at?: string | null
          is_equipment_room?: boolean | null
          is_rentable?: boolean | null
          name?: string | null
          price_per_hour?: number | null
          room_id?: number
          status?: Database["public"]["Enums"]["room_status"]
        }
        Update: {
          branch_id?: number
          capacity?: number | null
          code?: string
          created_at?: string | null
          is_equipment_room?: boolean | null
          is_rentable?: boolean | null
          name?: string | null
          price_per_hour?: number | null
          room_id?: number
          status?: Database["public"]["Enums"]["room_status"]
        }
        Relationships: [
          {
            foreignKeyName: "rooms_branch_id_fkey"
            columns: ["branch_id"]
            isOneToOne: false
            referencedRelation: "branches"
            referencedColumns: ["branch_id"]
          },
        ]
      }
      services: {
        Row: {
          category: string | null
          is_active: boolean | null
          name: string
          price: number
          service_id: number
          type: Database["public"]["Enums"]["service_type"]
          unit: string | null
        }
        Insert: {
          category?: string | null
          is_active?: boolean | null
          name: string
          price?: number
          service_id?: number
          type?: Database["public"]["Enums"]["service_type"]
          unit?: string | null
        }
        Update: {
          category?: string | null
          is_active?: boolean | null
          name?: string
          price?: number
          service_id?: number
          type?: Database["public"]["Enums"]["service_type"]
          unit?: string | null
        }
        Relationships: []
      }
      settings: {
        Row: {
          description: string | null
          key: string
          updated_at: string | null
          value: string | null
        }
        Insert: {
          description?: string | null
          key: string
          updated_at?: string | null
          value?: string | null
        }
        Update: {
          description?: string | null
          key?: string
          updated_at?: string | null
          value?: string | null
        }
        Relationships: []
      }
      users: {
        Row: {
          auth_id: string | null
          created_at: string
          email: string | null
          full_name: string | null
          is_active: boolean | null
          phone: string | null
          role: Database["public"]["Enums"]["user_role"]
          status: Database["public"]["Enums"]["user_status"]
          updated_at: string | null
          user_id: number
          username: string
        }
        Insert: {
          auth_id?: string | null
          created_at?: string
          email?: string | null
          full_name?: string | null
          is_active?: boolean | null
          phone?: string | null
          role?: Database["public"]["Enums"]["user_role"]
          status?: Database["public"]["Enums"]["user_status"]
          updated_at?: string | null
          user_id?: number
          username: string
        }
        Update: {
          auth_id?: string | null
          created_at?: string
          email?: string | null
          full_name?: string | null
          is_active?: boolean | null
          phone?: string | null
          role?: Database["public"]["Enums"]["user_role"]
          status?: Database["public"]["Enums"]["user_status"]
          updated_at?: string | null
          user_id?: number
          username?: string
        }
        Relationships: []
      }
    }
    Views: {
      [_ in never]: never
    }
    Functions: {
      [_ in never]: never
    }
    Enums: {
      booking_status:
        | "pending"
        | "confirmed"
        | "checked_in"
        | "checked_out"
        | "completed"
        | "cancelled"
        | "paid"
      customer_type: "regular" | "vip" | "corporate"
      employment_status: "active" | "inactive" | "terminated"
      invoice_status: "unpaid" | "partial" | "paid"
      item_condition: "new" | "good" | "fair" | "damaged"
      item_status:
        | "available"
        | "in_studio_assigned"
        | "rented_out"
        | "under_maintenance"
        | "retired"
        | "lost"
      payment_method: "cash" | "transfer" | "qr" | "card"
      payment_status: "pending" | "completed" | "failed" | "refunded"
      room_status: "available" | "maintenance" | "inactive"
      service_type: "service" | "surcharge" | "compensation"
      user_role: "Admin" | "Staff"
      user_status: "active" | "inactive" | "banned"
    }
    CompositeTypes: {
      [_ in never]: never
    }
  }
}

type DatabaseWithoutInternals = Omit<Database, "__InternalSupabase">

type DefaultSchema = DatabaseWithoutInternals[Extract<keyof Database, "public">]

export type Tables<
  DefaultSchemaTableNameOrOptions extends
    | keyof (DefaultSchema["Tables"] & DefaultSchema["Views"])
    | { schema: keyof DatabaseWithoutInternals },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof (DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"] &
        DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Views"])
    : never = never,
> = DefaultSchemaTableNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? (DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"] &
      DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Views"])[TableName] extends {
      Row: infer R
    }
    ? R
    : never
  : DefaultSchemaTableNameOrOptions extends keyof (DefaultSchema["Tables"] &
        DefaultSchema["Views"])
    ? (DefaultSchema["Tables"] &
        DefaultSchema["Views"])[DefaultSchemaTableNameOrOptions] extends {
        Row: infer R
      }
      ? R
      : never
    : never

export type TablesInsert<
  DefaultSchemaTableNameOrOptions extends
    | keyof DefaultSchema["Tables"]
    | { schema: keyof DatabaseWithoutInternals },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"]
    : never = never,
> = DefaultSchemaTableNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"][TableName] extends {
      Insert: infer I
    }
    ? I
    : never
  : DefaultSchemaTableNameOrOptions extends keyof DefaultSchema["Tables"]
    ? DefaultSchema["Tables"][DefaultSchemaTableNameOrOptions] extends {
        Insert: infer I
      }
      ? I
      : never
    : never

export type TablesUpdate<
  DefaultSchemaTableNameOrOptions extends
    | keyof DefaultSchema["Tables"]
    | { schema: keyof DatabaseWithoutInternals },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"]
    : never = never,
> = DefaultSchemaTableNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"][TableName] extends {
      Update: infer U
    }
    ? U
    : never
  : DefaultSchemaTableNameOrOptions extends keyof DefaultSchema["Tables"]
    ? DefaultSchema["Tables"][DefaultSchemaTableNameOrOptions] extends {
        Update: infer U
      }
      ? U
      : never
    : never

export type Enums<
  DefaultSchemaEnumNameOrOptions extends
    | keyof DefaultSchema["Enums"]
    | { schema: keyof DatabaseWithoutInternals },
  EnumName extends DefaultSchemaEnumNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[DefaultSchemaEnumNameOrOptions["schema"]]["Enums"]
    : never = never,
> = DefaultSchemaEnumNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[DefaultSchemaEnumNameOrOptions["schema"]]["Enums"][EnumName]
  : DefaultSchemaEnumNameOrOptions extends keyof DefaultSchema["Enums"]
    ? DefaultSchema["Enums"][DefaultSchemaEnumNameOrOptions]
    : never

export type CompositeTypes<
  PublicCompositeTypeNameOrOptions extends
    | keyof DefaultSchema["CompositeTypes"]
    | { schema: keyof DatabaseWithoutInternals },
  CompositeTypeName extends PublicCompositeTypeNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[PublicCompositeTypeNameOrOptions["schema"]]["CompositeTypes"]
    : never = never,
> = PublicCompositeTypeNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[PublicCompositeTypeNameOrOptions["schema"]]["CompositeTypes"][CompositeTypeName]
  : PublicCompositeTypeNameOrOptions extends keyof DefaultSchema["CompositeTypes"]
    ? DefaultSchema["CompositeTypes"][PublicCompositeTypeNameOrOptions]
    : never

export const Constants = {
  public: {
    Enums: {
      booking_status: [
        "pending",
        "confirmed",
        "checked_in",
        "checked_out",
        "completed",
        "cancelled",
        "paid",
      ],
      customer_type: ["regular", "vip", "corporate"],
      employment_status: ["active", "inactive", "terminated"],
      invoice_status: ["unpaid", "partial", "paid"],
      item_condition: ["new", "good", "fair", "damaged"],
      item_status: [
        "available",
        "in_studio_assigned",
        "rented_out",
        "under_maintenance",
        "retired",
        "lost",
      ],
      payment_method: ["cash", "transfer", "qr", "card"],
      payment_status: ["pending", "completed", "failed", "refunded"],
      room_status: ["available", "maintenance", "inactive"],
      service_type: ["service", "surcharge", "compensation"],
      user_role: ["Admin", "Staff"],
      user_status: ["active", "inactive", "banned"],
    },
  },
} as const
```

## File: README.md
```markdown
# Photographer Portfolio Website

Website Portfolio c√° nh√¢n d√†nh cho nhi·∫øp ·∫£nh gia chuy√™n nghi·ªáp, t·∫≠p trung v√†o tr·∫£i nghi·ªám th·ªã gi√°c, k·ªÉ chuy·ªán (storytelling) v√† t·ªëi ∆∞u h√≥a hi·ªáu nƒÉng.

**Live Demo:** [https://dangk3.github.io/Photographer-Portfolio/](https://dangk3.github.io/Photographer-Portfolio/)

![Project Screenshot](https://dangk3.github.io/Photographer-Portfolio/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fhero-background.webp&w=3840&q=90) 
*(B·∫°n c√≥ th·ªÉ thay link ·∫£nh tr√™n b·∫±ng ·∫£nh ch·ª•p m√†n h√¨nh th·ª±c t·∫ø sau n√†y)*

## üöÄ T√≠nh nƒÉng n·ªïi b·∫≠t (Version 1.0)

* **Tr·∫£i nghi·ªám ƒëi·ªán ·∫£nh:** Hero Section v·ªõi hi·ªáu ·ª©ng Ken Burns v√† Typography ƒë·ªông.
* **Editorial Layout:** Trang chi ti·∫øt d·ª± √°n ƒë∆∞·ª£c tr√¨nh b√†y nh∆∞ m·ªôt b√†i t·∫°p ch√≠ (Magazine style) thay v√¨ ch·ªâ l√† gallery ·∫£nh ƒë∆°n thu·∫ßn.
* **Smart Navigation:**
    * Menu ƒëi·ªÅu h∆∞·ªõng d√≠nh (Sticky Nav) th√¥ng minh.
    * Chuy·ªÉn ƒë·ªïi giao di·ªán S√°ng/T·ªëi (Dark/Light Mode).
    * Infinite Scroll (Cu·ªôn v√¥ t·∫≠n) cho c√°c trang danh m·ª•c.
* **Layout linh ho·∫°t:**
    * Masonry Grid (x·∫øp g·∫°ch) cho m·ª•c C√° nh√¢n.
    * Editorial Grid cho m·ª•c Th·ªùi trang & Th∆∞∆°ng m·∫°i.
* **Hi·ªáu nƒÉng cao:** T·ªëi ∆∞u h√≥a SEO ƒë·ªông, Static Site Generation (SSG) t·∫£i trang c·ª±c nhanh.

## üõ† C√¥ng ngh·ªá s·ª≠ d·ª•ng

* **Core:** [Next.js 15](https://nextjs.org/) (App Router), [React 19](https://react.dev/), [TypeScript](https://www.typescriptlang.org/).
* **Styling:** [Tailwind CSS v4](https://tailwindcss.com/).
* **Animation:** [Framer Motion](https://www.framer.com/motion/).
* **Components:** * `yet-another-react-lightbox` (Gallery).
    * `react-type-animation` (Hi·ªáu ·ª©ng ch·ªØ).
* **Deployment:** GitHub Pages (Static Export).
```

## File: src/app/admin/projects/new/page.tsx
```typescript
// src/app/admin/projects/new/page.tsx
'use client';

import ProjectForm from '@/components/admin/ProjectForm';

export default function NewProjectPage() {
  return <ProjectForm mode="create" />;
}
```

## File: src/app/error.tsx
```typescript
// src/app/error.tsx
'use client';

import Container from '@/components/Container';
import Link from 'next/link';
export default function Error({
  reset,
}: {
  error: Error & { digest?: string };
  reset: () => void;
}) {

  return (
    <Container>
      <div className="flex flex-col items-center justify-center text-center py-24 md:py-32 min-h-[calc(100vh_-_250px)]">
        
        {/* M√£ l·ªói */}
        <span className="text-7xl md:text-9xl font-light tracking-tighter text-[var(--foreground)]">
          L·ªói
        </span>
        
        {/* Ti√™u ƒë·ªÅ */}
        <h1 className="mt-4 text-3xl md:text-4xl font-light tracking-tight">
          ƒê√£ c√≥ l·ªói x·∫£y ra
        </h1>
        
        {/* M√¥ t·∫£ */}
        <p className="mt-2 text-lg text-[var(--sub-text)]">
          R·∫•t ti·∫øc, ƒë√£ c√≥ s·ª± c·ªë ngo√†i √Ω mu·ªën. B·∫°n c√≥ th·ªÉ th·ª≠ l·∫°i.
        </p>

        {/* N√∫t "Th·ª≠ L·∫°i"
          H√†m reset() s·∫Ω c·ªë g·∫Øng render l·∫°i trang m·ªôt l·∫ßn n·ªØa.
        */}
        <div className="mt-10 flex flex-col md:flex-row justify-center gap-4">
          
          {/* N√∫t 1: Th·ª≠ L·∫°i */}
          <button
            onClick={() => reset()}
            className="py-3 px-8 bg-transparent 
                       border border-[var(--foreground)] 
                       text-[var(--foreground)] 
                       hover:bg-[var(--foreground)] hover:text-[var(--background)] 
                       transition-colors duration-300 cursor-pointer"
          >
            Th·ª≠ L·∫°i
          </button>
          
          {/* N√∫t 2: Trang ch·ªß*/}
          <Link
            href="/"
            className="py-3 px-8 bg-transparent 
                       border border-[var(--foreground)] 
                       text-[var(--foreground)] 
                       hover:bg-[var(--foreground)] hover:text-[var(--background)] 
                       transition-colors duration-300 cursor-pointer"
          >
            Quay v·ªÅ Trang ch·ªß
          </Link>
        </div>
      </div>
    </Container>
  );
}
```

## File: src/app/gioi-thieu/page.tsx
```typescript
// src/app/gioi-thieu/page.tsx
import type { Metadata } from 'next';
import AboutMilestonesSection from '@/components/AboutMilestonesSection';
import AboutPhilosophySection from '@/components/AboutPhilosophySection';

// 1. Th√™m Metadata (SEO) cho trang Gi·ªõi Thi·ªáu
export const metadata: Metadata = {
  title: 'Gi·ªõi Thi·ªáu | Oni Studio',
  description: 'T√¨m hi·ªÉu v·ªÅ h√†nh tr√¨nh, ƒë·ªôi ng≈© v√† tri·∫øt l√Ω s√°ng t·∫°o ƒë·∫±ng sau Oni Studio, t·ª´ nh·ªØng ph√°c th·∫£o ƒë·∫ßu ti√™n ƒë·∫øn m·ªôt x∆∞·ªüng ·∫£nh chuy√™n nghi·ªáp.',
  openGraph: {
    title: 'Gi·ªõi Thi·ªáu | Oni Studio',
    description: 'T√¨m hi·ªÉu v·ªÅ h√†nh tr√¨nh v√† tri·∫øt l√Ω s√°ng t·∫°o c·ªßa Oni Studio.',
    // B·∫°n n√™n thay th·∫ø b·∫±ng m·ªôt ·∫£nh ƒë·∫°i di·ªán cho trang Gi·ªõi Thi·ªáu
    images: ['/assets/about/carousel_04_2025.jpg'], 
  },
};

// 2. N·ªôi dung trang
export default function GioiThieuPage() {
  return (
    <main>
      {/* Section 1: H√†nh tr√¨nh (Carousel) */}
      <AboutMilestonesSection />

      <AboutPhilosophySection />

    </main>
  );
}
```

## File: src/app/login/page.tsx
```typescript
// src/app/login/page.tsx
'use client';

import React, { useState, useEffect, Suspense } from 'react';
import { useRouter, useSearchParams } from 'next/navigation';
// 1. X√ìA d√≤ng import supabase c≈© n√†y ƒëi
// import { supabase } from '@/lib/supabase'; 

// 2. TH√äM import n√†y ƒë·ªÉ t·∫°o client h·ªó tr·ª£ Cookie
import { createBrowserClient } from '@supabase/ssr';

import { toast } from 'sonner';
import { Mail, Lock, Loader2, ArrowRight } from 'lucide-react';
import localFont from 'next/font/local'; 

const logoFont = localFont({
  src: '../../fonts/cameliya-regular.ttf',
  display: 'swap',
  variable: '--font-logo',
});
function LoginFormContent() {
  const router = useRouter();
  const searchParams = useSearchParams();
  
  // 3. Kh·ªüi t·∫°o Supabase Client c√≥ kh·∫£ nƒÉng ghi Cookie
  const supabase = createBrowserClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
  );

  const [formData, setFormData] = useState({
    email: '',
    password: ''
  });
  const [isLoading, setIsLoading] = useState(false);

  // Check login
  useEffect(() => {
    const checkUser = async () => {
      const { data: { session } } = await supabase.auth.getSession();
      if (session) {
        // Refresh router ƒë·ªÉ ƒë·∫£m b·∫£o Server Component nh·∫≠n ƒë∆∞·ª£c cookie m·ªõi
        router.refresh();
        router.replace('/admin');
      }
    };
    checkUser();
  }, [router, supabase]);

const handleLogin = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsLoading(true);

    try {
      // 1. ƒêƒÉng nh·∫≠p v·ªõi Supabase Auth
      const { data, error } = await supabase.auth.signInWithPassword({
        email: formData.email,
        password: formData.password,
      });

      if (error) throw error;
      if (!data.user) throw new Error("Kh√¥ng t√¨m th·∫•y th√¥ng tin ng∆∞·ªùi d√πng.");

      // 2. KI·ªÇM TRA TR·∫†NG TH√ÅI 'IS_ACTIVE'
      const { data: userProfile, error: profileError } = await supabase
        .from('users')
        .select('is_active, role')
        .eq('auth_id', data.user.id)
        .single();

      // N·∫øu kh√¥ng t√¨m th·∫•y profile ho·∫∑c b·ªã kh√≥a
      if (profileError || (userProfile && !userProfile.is_active)) {
        await supabase.auth.signOut();
        throw new Error("T√†i kho·∫£n c·ªßa b·∫°n ƒë√£ b·ªã KH√ìA. Vui l√≤ng li√™n h·ªá Admin.");
      }

      // 3. N·∫øu m·ªçi th·ª© OK -> Cho v√†o
      toast.success(`Ch√†o m·ª´ng tr·ªü l·∫°i, ${userProfile?.role === 'Admin' ? 'S·∫øp' : 'b·∫°n'}!`);
      
      const nextUrl = searchParams.get('next');
      router.refresh(); 
      router.replace(nextUrl || '/admin');
      
    } catch (error: unknown) { // D√πng 'any' ƒë·ªÉ d·ªÖ truy c·∫≠p .message
      console.error("Login error:", error);
      
      // --- X·ª¨ L√ù D·ªäCH L·ªñI T·∫†I ƒê√ÇY ---
      let msg = (error as Error).message || 'ƒêƒÉng nh·∫≠p th·∫•t b·∫°i';

      // 1. L·ªói sai m·∫≠t kh·∫©u ho·∫∑c email kh√¥ng t·ªìn t·∫°i
      if (msg === 'Invalid login credentials') {
        msg = 'Email ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ch√≠nh x√°c.';
      } 
      // 2. L·ªói ch∆∞a x√°c th·ª±c email (n·∫øu c√≥ b·∫≠t confirm)
      else if (msg.includes('Email not confirmed')) {
        msg = 'Email ch∆∞a ƒë∆∞·ª£c x√°c th·ª±c. Vui l√≤ng ki·ªÉm tra h·ªôp th∆∞.';
      }
      // 3. L·ªói qu√° nhi·ªÅu l·∫ßn th·ª≠ (Rate limit)
      else if (msg.includes('Too many requests') || msg.includes('rate limit')) {
        msg = 'B·∫°n ƒë√£ th·ª≠ qu√° nhi·ªÅu l·∫ßn. Vui l√≤ng ƒë·ª£i gi√¢y l√°t.';
      }
      
      // N·∫øu l√† l·ªói do m√¨nh t·ª± throw ·ªü tr√™n ("T√†i kho·∫£n b·ªã kh√≥a...") th√¨ n√≥ s·∫Ω gi·ªØ nguy√™n ti·∫øng Vi·ªát
      toast.error(msg);
    } finally {
      setIsLoading(false);
    }
  };

  // ... (PH·∫¶N GIAO DI·ªÜN RETURN GI·ªÆ NGUY√äN KH√îNG ƒê·ªîI) ...
  return (
    <div className="min-h-screen flex items-center justify-center bg-[var(--admin-bg)] p-4 transition-colors duration-300">
      <div className="w-full max-w-md bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-2xl shadow-xl p-8 animate-fade-in-up">
        
        {/* Logo / Header */}
        <div className="text-center mb-8">
          <div className={`w-12 h-12 bg-[var(--admin-primary)] rounded-xl flex items-center justify-center text-white font-bold text-2xl mx-auto mb-4 shadow-lg shadow-indigo-500/30 ${logoFont.className}`}>
            O
          </div>
          <h1 className="text-2xl font-bold text-[var(--admin-fg)]">Oni Studio Admin</h1>
          <p className="text-[var(--admin-sub)] mt-2">ƒêƒÉng nh·∫≠p ƒë·ªÉ qu·∫£n l√Ω h·ªá th·ªëng</p>
        </div>

        {/* Form */}
        <form onSubmit={handleLogin} className="space-y-5">
          <div>
            <label className="block text-sm font-medium text-[var(--admin-fg)] mb-1.5">Email</label>
            <div className="relative">
              <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <Mail size={18} className="text-[var(--admin-sub)]" />
              </div>
              <input
                type="email"
                required
                className="w-full pl-10 pr-4 py-2.5 bg-[var(--admin-bg)] border border-[var(--admin-border)] text-[var(--admin-fg)] rounded-lg focus:ring-2 focus:ring-[var(--admin-primary)] focus:border-transparent outline-none transition-all"
                placeholder="admin@onistudio.com"
                value={formData.email}
                onChange={(e) => setFormData({ ...formData, email: e.target.value })}
              />
            </div>
          </div>

          <div>
            <label className="block text-sm font-medium text-[var(--admin-fg)] mb-1.5">M·∫≠t kh·∫©u</label>
            <div className="relative">
              <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <Lock size={18} className="text-[var(--admin-sub)]" />
              </div>
              <input
                type="password"
                required
                className="w-full pl-10 pr-4 py-2.5 bg-[var(--admin-bg)] border border-[var(--admin-border)] text-[var(--admin-fg)] rounded-lg focus:ring-2 focus:ring-[var(--admin-primary)] focus:border-transparent outline-none transition-all"
                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                value={formData.password}
                onChange={(e) => setFormData({ ...formData, password: e.target.value })}
              />
            </div>
          </div>

          <button
            type="submit"
            disabled={isLoading}
            className="w-full py-2.5 cursor-pointer bg-[var(--admin-primary)] text-[var(--admin-primary-fg)] rounded-lg font-medium hover:opacity-90 transition-all shadow-md shadow-indigo-500/25 flex items-center justify-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed"
          >
            {isLoading ? (
              <>
                <Loader2 size={20} className="animate-spin" />
                ƒêang x√°c th·ª±c...
              </>
            ) : (
              <>
                ƒêƒÉng nh·∫≠p
                <ArrowRight size={18} />
              </>
            )}
          </button>
        </form>

        {/* Footer Text */}
        <div className="mt-6 text-center text-xs text-[var(--admin-sub)]">
          <p>Ch·ªâ d√†nh cho nh√¢n vi√™n ƒë∆∞·ª£c c·∫•p quy·ªÅn.</p>
        </div>
      </div>
    </div>
  );
}

// === COMPONENT CH√çNH (WRAPPER ƒê·ªÇ FIX L·ªñI BUILD) ===
export default function LoginPage() {
  return (
    <Suspense fallback={
      <div className="min-h-screen flex items-center justify-center bg-gray-100 dark:bg-neutral-950">
        <Loader2 className="animate-spin text-indigo-600" size={32} />
      </div>
    }>
      <LoginFormContent />
    </Suspense>
  );
}
```

## File: src/app/providers.tsx
```typescript
// src/app/providers.tsx
'use client';

import { ThemeProvider } from 'next-themes';
import { ReactNode } from 'react';

export function Providers({ children }: { children: ReactNode }) {
  return (
    <ThemeProvider attribute="class" storageKey="client-theme" defaultTheme="system" enableSystem>
      {children}
    </ThemeProvider>
  );
}
```

## File: src/components/AboutMilestonesSection.tsx
```typescript
// src/components/AboutMilestonesSection.tsx
'use client';

import Image from 'next/image';
import {
  SliderBtnGroup,
  ProgressSlider,
  SliderBtn,
  SliderContent,
  SliderWrapper,
} from '@/components/progressive-carousel'; // ƒê·∫£m b·∫£o ƒë∆∞·ªùng d·∫´n n√†y ch√≠nh x√°c
import carousel_01_2020 from '../assets/about/carousel_01_2020.webp';
import carousel_02_2022 from '../assets/about/carousel_02_2022.webp';
import carousel_03_2024 from '../assets/about/carousel_03_2024.webp';
import carousel_04_2025 from '../assets/about/carousel_04_2025.webp';    
import Container from '@/components/Container';


// 1. D·ªÆ LI·ªÜU C√ÅC C·ªòT M·ªêC
// Ch√∫ng ta s·∫Ω thay th·∫ø d·ªØ li·ªáu m·∫´u b·∫±ng n·ªôi dung c√¢u chuy·ªán c·ªßa Oni Studio
const items = [
  {
    // S·ª≠ d·ª•ng ƒë∆∞·ªùng d·∫´n ·∫£nh t·ª´ th∆∞ m·ª•c /public
    img: carousel_01_2020,
    year: '2020',
    title: 'Ph√°c Th·∫£o Gi·∫•c M∆°',
    desc: 'NƒÉm 2020, √Ω t∆∞·ªüng v·ªÅ Oni Studio ƒë∆∞·ª£c ph√°c th·∫£o, mang theo gi·∫•c m∆° v·ªÅ m·ªôt kh√¥ng gian s√°ng t·∫°o k·∫øt h·ª£p gi·ªØa studio v√† caf√©.',
    sliderName: 'milestone-2020', // T√™n ƒë·ªãnh danh duy nh·∫•t
  },
  {
    img: carousel_02_2022,
    year: '2022',
    title: 'Kh√¥ng Gian ƒê·∫ßu Ti√™n',
    desc: 'Studio v·∫≠t l√Ω ƒë·∫ßu ti√™n ra ƒë·ªùi. M·ªôt kh√¥ng gian t·ªëi gi·∫£n, tinh kh√¥i, t·∫≠p trung v√†o vi·ªác khai th√°c v·∫ª ƒë·∫πp c·ªßa √°nh s√°ng t·ª± nhi√™n.',
    sliderName: 'milestone-2022',
  },
  {
    img: carousel_03_2024,
    year: '2024',
    title: 'N√¢ng C·∫•p To√†n Di·ªán',
    desc: 'Studio ƒë∆∞·ª£c m·ªü r·ªông v√† trang b·ªã chuy√™n nghi·ªáp. T·ª´ √°nh s√°ng, ph√¥ng n·ªÅn ƒë·∫øn thi·∫øt b·ªã, t·∫•t c·∫£ s·∫µn s√†ng cho c√°c d·ª± √°n l·ªõn v√† d·ªãch v·ª• cho thu√™.',
    sliderName: 'milestone-2024',
  },
  {
    img: carousel_04_2025,
    year: '2025',
    title: 'ƒê·ªãnh H√¨nh D·ªãch V·ª•',
    desc: 'Oni Studio kh·∫≥ng ƒë·ªãnh v·ªã th·∫ø v·ªõi d·ªãch v·ª• cho thu√™ studio v√† thi·∫øt b·ªã chuy√™n nghi·ªáp, tr·ªü th√†nh m·ªôt ƒë·ªãa ch·ªâ tin c·∫≠y cho c·ªông ƒë·ªìng s√°ng t·∫°o.',
    sliderName: 'milestone-2025',
  },
];

export default function AboutMilestonesSection() {
  return (
    // B·ªçc trong 1 <section> ƒë·ªÉ d·ªÖ qu·∫£n l√Ω
    <section id="milestones" className="py-16 md:py-24">
    <Container>
        <div className="container mx-auto px-4 text-center mb-10">
            <h2 className="text-4xl md:text-5xl font-light tracking-tighter">
            H√†nh Tr√¨nh C·ªßa Oni
            </h2>
            <p className="text-lg text-[var(--foreground)] mt-2">
            T·ª´ √Ω t∆∞·ªüng ƒë·∫øn m·ªôt studio chuy√™n nghi·ªáp.
            </p>
        </div>

        {/* 2. √ÅP D·ª§NG COMPONENT CAROUSEL */}
        {/* ƒê·∫∑t activeSlider m·∫∑c ƒë·ªãnh l√† c·ªôt m·ªëc ƒë·∫ßu ti√™n */}
        <ProgressSlider vertical={false} activeSlider="milestone-2020">
            
            {/* PH·∫¶N HI·ªÇN TH·ªä H√åNH ·∫¢NH */}
            <SliderContent>
            {items.map((item, index) => (
                <SliderWrapper key={index} value={item.sliderName}>
                <Image
                    // ƒê·∫∑t chi·ªÅu cao c·ªë ƒë·ªãnh v√† object-cover ƒë·ªÉ ·∫£nh ƒë·ªìng ƒë·ªÅu
                    className="rounded-xl h-[400px] md:h-[700px] w-full object-cover"
                    src={item.img}
                    width={1920} // Gi·ªØ chi·ªÅu r·ªông l·ªõn
                    height={1080} // Gi·ªØ chi·ªÅu cao l·ªõn
                    alt={item.title} // D√πng title cho alt text
                    priority={index === 0} // ∆Øu ti√™n t·∫£i ·∫£nh ƒë·∫ßu ti√™n
                    sizes="(max-width: 768px) 100vw, 100vw"
                />
                </SliderWrapper>
            ))}
            </SliderContent>

            {/* PH·∫¶N HI·ªÇN TH·ªä N·ªòI DUNG (N√öT B·∫§M) */}
            {/* T√πy ch·ªânh styling t·ª´ code m·∫´u cho ph√π h·ª£p */}
            <SliderBtnGroup className="relative md:absolute bottom-0 h-fit dark:text-white text-black dark:bg-black/40 bg-white/40 backdrop-blur-md overflow-hidden grid grid-cols-2 md:grid-cols-4 rounded-md mt-4 md:mt-0">
            {items.map((item, index) => (
                <SliderBtn
                key={index}
                value={item.sliderName}
                className="text-left p-4 md:p-6 border-r border-white/20"
                progressBarClass="dark:bg-gray-900 bg-black h-full" // ƒê·ªïi m√†u thanh progress
                >
                {/* S·ª≠ d·ª•ng 'year' cho th·∫ª badge */}
                <h3 className="relative px-4 py-1 rounded-full w-fit dark:bg-white dark:text-black text-white bg-gray-900 mb-3 text-sm font-semibold">
                    {item.year}
                </h3>
                {/* S·ª≠ d·ª•ng 'title' cho ti√™u ƒë·ªÅ ch√≠nh */}
                <h2 className="text-lg md:text-xl font-semibold mb-1">
                    {item.title}
                </h2>
                {/* S·ª≠ d·ª•ng 'desc' cho m√¥ t·∫£ */}
                <p className="text-sm font-medium line-clamp-3 md:line-clamp-2">
                    {item.desc}
                </p>
                </SliderBtn>
            ))}
            </SliderBtnGroup>
        </ProgressSlider>
    </Container>
  </section>
);
}
```

## File: src/components/admin/DashboardActions.tsx
```typescript
// src/components/admin/DashboardActions.tsx
'use client';

import { toast } from 'sonner';
import Link from 'next/link';
import { Printer, Plus } from 'lucide-react';

export default function DashboardActions() {
  return (
    <div className="flex gap-3">
      <button onClick={() => toast.info('T√≠nh nƒÉng Xu·∫•t b√°o c√°o ƒëang ph√°t tri·ªÉn')}
      className="
        flex-1 md:flex-none
        inline-flex items-center justify-center gap-2 
        bg-[var(--admin-card)] border border-[var(--admin-border)] 
        text-[var(--admin-fg)] hover:bg-[var(--admin-hover)] 
        px-4 py-2 rounded-md text-sm font-medium transition-colors
        whitespace-nowrap truncate
      ">
        <Printer size={16} />          {/* 2. Icon M√°y in */}
        <span>Xu·∫•t b√°o c√°o</span>
      </button>
      <Link 
        href="/admin/projects/new"
        className="flex-1 md:flex-none
        inline-flex items-center justify-center gap-2 
        bg-[var(--admin-primary)] text-[var(--admin-primary-fg)] 
        hover:opacity-90 px-4 py-2 rounded-md text-sm font-medium transition-colors 
        shadow-sm whitespace-nowrap truncate"
      >
        <Plus size={16} />
        <span>T·∫°o d·ª± √°n m·ªõi</span>
      </Link>
    </div>
  );
}
```

## File: src/components/admin/DashboardCalendar.tsx
```typescript
// src/components/admin/DashboardCalendar.tsx
'use client'

import { useEffect, useState, useCallback, useMemo } from 'react';
import { toast } from 'sonner';
import { RoomWithBranch, ServiceItem } from '@/lib/actions/studio';
import { EventInteractionArgs } from 'react-big-calendar/lib/addons/dragAndDrop';
import { useCalendar } from '@/context/CalendarContext'; 
import moment from 'moment';
import BookingDetailModal from './calendar/BookingDetailModal';
import BookingCalendar, { BookingItem, CalendarEvent } from './calendar/BookingCalendar'; 
import BookingCreateModal from './calendar/BookingCreateModal';
import { updateBookingTime } from '@/lib/actions/bookings';

interface DashboardCalendarProps {
  rooms: RoomWithBranch[];
  bookings: BookingItem[]; 
  services: ServiceItem[];
  currentUserId: number;
  cleanupMinutes: number; 
}

export default function DashboardCalendar({
  rooms,
  bookings: initialBookings,
  services,
  currentUserId,
  cleanupMinutes
}: DashboardCalendarProps) {
  

   const { 
      date, setDate, 
      visibleRoomIds, setVisibleRoomIds, 
      isCreateModalOpen, setCreateModalOpen
  } = useCalendar();

  const availableRooms = useMemo(() => {
    return rooms.filter(r => r.status === 'available' && !r.is_equipment_room);
  }, [rooms]);

  // --- SYNC VISIBLE ROOMS L·∫¶N ƒê·∫¶U (N·∫øu Nav ch∆∞a ch·∫°y k·ªãp) ---
  useEffect(() => {
      // D√πng logic set 1 l·∫ßn (Bulk Set) thay v√¨ forEach loop
      if (availableRooms.length > 0 && visibleRoomIds.length === 0) {
          const allIds = availableRooms.map(r => r.room_id);
          setVisibleRoomIds(allIds);
      }
  }, [availableRooms, visibleRoomIds.length, setVisibleRoomIds]);

  // 3. STATE LOCAL DATA
  const [localBookings, setLocalBookings] = useState<BookingItem[]>(initialBookings);
  useEffect(() => {
    setLocalBookings(initialBookings);
  }, [initialBookings]);

  // 4. L·ªåC D·ªÆ LI·ªÜU HI·ªÇN TH·ªä
  // L·ªçc Booking: Ch·ªâ hi·ªán booking c·ªßa c√°c ph√≤ng ƒë∆∞·ª£c check
  const filteredBookings = localBookings.filter(b => visibleRoomIds.includes(b.room_id));
  
  // L·ªçc C·ªôt Ph√≤ng: Ch·ªâ hi·ªán c√°c c·ªôt ƒë∆∞·ª£c check (cho giao di·ªán Day view ƒë·ª° r·ªëi)
  const filteredRooms = rooms.filter(r => visibleRoomIds.includes(r.room_id));

  // State local cho slot ƒë∆∞·ª£c ch·ªçn (ƒë·ªÉ truy·ªÅn v√†o Modal)
  const [selectedSlot, setSelectedSlot] = useState<{
    start: Date;
    end: Date;
    roomId: number;
  } | null>(null);

  // --- LOGIC EVENT HANDLERS (Drag, Drop, Resize) ---
  const handleEventChange = useCallback(async ({ event, start, end, resourceId }: EventInteractionArgs<CalendarEvent>) => {
    const lockedStatuses = ['checked_in', 'checked_out', 'completed', 'paid', 'cancelled'];  
    if (event.status && lockedStatuses.includes(event.status)) {
    toast.error(`Kh√¥ng th·ªÉ s·ª≠a l·ªãch khi tr·∫°ng th√°i l√† ${event.status}`);
    return;
    }
    const bookingItemId = Number(event.id);
      if (isNaN(bookingItemId)) return;

      const newStartDate = new Date(start);
      const newEndDate = new Date(end);
      const newRoomId = resourceId ? Number(resourceId) : event.resourceId;

      // Optimistic Update
      setLocalBookings((prev) => prev.map((b) => {
        if (b.booking_item_id === bookingItemId) {
          return { ...b, start_dt: newStartDate.toISOString(), end_dt: newEndDate.toISOString(), room_id: newRoomId };
        }
        return b;
      }));

      try {
        const res = await updateBookingTime(bookingItemId, newStartDate.toISOString(), newEndDate.toISOString(), newRoomId);
        if (res.success) toast.success("ƒê√£ c·∫≠p nh·∫≠t l·ªãch!");
        else {
            toast.error(res.error);
            setLocalBookings(initialBookings);
        }
      } catch (error) { 
          toast.error("L·ªói k·∫øt n·ªëi" + (error instanceof Error ? error.message : ""));
          setLocalBookings(initialBookings);
      }
  }, [initialBookings]); 

  // --- CLICK EMPTY SLOT ---
  const handleSlotSelect = ({ start, end, resourceId }: { start: Date; end: Date; resourceId: number }) => {
    setSelectedSlot({ start, end, roomId: resourceId });
    setCreateModalOpen(true); // M·ªü Modal th√¥ng qua Context
  };

  // --- MAPPING DATA CHO CALENDAR ---
  const calendarRooms = filteredRooms.map(r => ({
    room_id: r.room_id,
    name: r.name,
    code: r.code,
    status: r.status
  }));

  const defaultStartTime = useMemo(() => {
    const now = new Date();
    if (now.getMinutes() > 0) {
        now.setMinutes(now.getMinutes() + (15 - now.getMinutes() % 15)); // L√†m tr√≤n l√™n 15p
    }
    now.setSeconds(0);
    now.setMilliseconds(0);
    return now;
  }, []);
  // Initial Data cho Modal (X·ª≠ l√Ω tr∆∞·ªùng h·ª£p m·ªü t·ª´ n√∫t "T·∫°o m·ªõi" ·ªü Widget -> ch∆∞a c√≥ slot)
  const modalInitialData = useMemo(() => {
    if (selectedSlot) {
      return {
        start: selectedSlot.start,
        end: selectedSlot.end,
        roomId: selectedSlot.roomId
      };
    }
    // N·∫øu t·∫°o m·ªõi th·ªß c√¥ng: D√πng m·ªëc th·ªùi gian c·ªë ƒë·ªãnh
    return {
      start: defaultStartTime, 
      end: moment(defaultStartTime).add(1, 'hours').toDate(),
      roomId: rooms[0]?.room_id || 0
    };
  }, [selectedSlot, rooms, defaultStartTime]);

  const [selectedBookingId, setSelectedBookingId] = useState<number | null>(null);
  const [isDetailOpen, setIsDetailOpen] = useState(false);

  // Handler khi click v√†o event
  const handleSelectEvent = (event: CalendarEvent) => {
      if (event.type === 'cleanup') return;
      
      // L·∫•y booking_id t·ª´ field resource ta ƒë√£ th√™m ·ªü BookingCalendar
      const bId = event.resource?.bookingId;
      if (bId) {
          setSelectedBookingId(bId);
          setIsDetailOpen(true);
      }
  };

  return (
    <div className="h-full border border-[var(--admin-border)] rounded-2xl overflow-hidden shadow-sm bg-[var(--admin-card)] flex flex-col">
      <div className="px-6 py-4 border-b border-[var(--admin-border)] flex items-center justify-between">
         <h3 className="font-bold text-[var(--admin-fg)]">L·ªãch ƒê·∫∑t Ph√≤ng</h3>
      </div>

      <div className="flex-1 min-h-0">
        <BookingCalendar 
            bookings={filteredBookings} 
            rooms={calendarRooms} 
            date={date} 
            cleanupMinutes={cleanupMinutes} // 3. TRUY·ªÄN XU·ªêNG
            onNavigate={setDate} 
            onSelectSlot={handleSlotSelect} 
            onEventDrop={(args) => handleEventChange(args)}   
            onEventResize={(args) => handleEventChange(args)}
            onSelectEvent={handleSelectEvent}
        />
      </div>
      <BookingDetailModal 
            isOpen={isDetailOpen}
            onClose={() => setIsDetailOpen(false)}
            bookingId={selectedBookingId}
            servicesList={services} // Truy·ªÅn list d·ªãch v·ª• ƒë·ªÉ ch·ªçn OT/Ph√≠
        />
      <BookingCreateModal
        isOpen={isCreateModalOpen}
        onClose={() => setCreateModalOpen(false)}
        initialData={modalInitialData}
        rooms={rooms}
        services={services}
        currentUserId={currentUserId}
      />
    </div>
  );
}
```

## File: src/components/admin/DashboardFilter.tsx
```typescript
// src/components/admin/DashboardFilter.tsx
'use client';

import { useState, useRef, useEffect, useTransition } from 'react';
import { useRouter, useSearchParams } from 'next/navigation';
import { CalendarDays, ChevronDown, Check, Loader2 } from 'lucide-react';

const OPTIONS = [
  { value: '7d', label: '7 ng√†y qua (Tu·∫ßn)' },
  { value: '30d', label: '30 ng√†y qua (Th√°ng)' },
  { value: '90d', label: '3 th√°ng qua (Qu√Ω)' },
  { value: '12m', label: '1 nƒÉm qua' },
  { value: 'all', label: 'T·∫•t c·∫£ th·ªùi gian' },
];

export default function DashboardFilter() {
  const router = useRouter();
  const searchParams = useSearchParams();
  const [isOpen, setIsOpen] = useState(false);
  const [isPending, startTransition] = useTransition();
  const containerRef = useRef<HTMLDivElement>(null);
  
  const currentRange = searchParams.get('range') || '30d';
  const activeLabel = OPTIONS.find(opt => opt.value === currentRange)?.label || 'Ch·ªçn th·ªùi gian';

  const handleSelect = (value: string) => {
    setIsOpen(false);
    startTransition(() => {
      const params = new URLSearchParams(searchParams);
      params.set('range', value);
      router.push(`?${params.toString()}`, { scroll: false });
      router.refresh(); 
    });
  };

  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {
        setIsOpen(false);
      }
    };
    document.addEventListener('mousedown', handleClickOutside);
    return () => document.removeEventListener('mousedown', handleClickOutside);
  }, []);

  return (
    // [1] Container: w-full tr√™n mobile, w-auto tr√™n desktop
    <div className="relative w-full md:w-auto" ref={containerRef}>
      
      {/* TRIGGER BUTTON */}
      <button
        onClick={() => setIsOpen(!isOpen)}
        disabled={isPending}
        className={`
          flex items-center justify-between gap-2 px-4 py-2 rounded-lg border transition-all duration-200 whitespace-nowrap
          text-sm font-medium bg-[var(--admin-card)] hover:bg-[var(--admin-hover)]
          w-full md:w-auto
          ${isOpen 
            ? 'border-[var(--admin-primary)] ring-2 ring-[var(--admin-primary)]/10 text-[var(--admin-fg)]' 
            : 'border-[var(--admin-border)] text-[var(--admin-sub)] hover:text-[var(--admin-fg)]'
          }
          ${isPending ? 'opacity-70 cursor-wait' : ''}
        `}
      >
        <div className="flex items-center gap-2">
            {isPending ? (
            <Loader2 size={16} className="animate-spin text-[var(--admin-primary)]" />
            ) : (
            <CalendarDays size={16} className={isOpen ? 'text-[var(--admin-primary)]' : 'text-[var(--admin-sub)]'} />
            )}
            
            <span className="text-left truncate">
            {isPending ? 'ƒêang t·∫£i...' : activeLabel}
            </span>
        </div>
        
        <ChevronDown 
          size={16} 
          className={`transition-transform duration-200 ml-2 ${isOpen ? 'rotate-180' : ''}`} 
        />
      </button>

      {/* DROPDOWN MENU */}
      {isOpen && (
        <div className="
            absolute right-0 mt-2 
            bg-[var(--admin-card)] border border-[var(--admin-border)] 
            rounded-xl shadow-xl z-50 
            animate-in fade-in zoom-in-95 duration-100 origin-top-right overflow-hidden
            w-full md:w-56
        ">
          <div className="p-1.5">
            <div className="px-3 py-2 text-[10px] font-bold text-[var(--admin-sub)] uppercase tracking-wider">
              Kho·∫£ng th·ªùi gian
            </div>
            {OPTIONS.map((opt) => {
              const isActive = opt.value === currentRange;
              return (
                <button
                  key={opt.value}
                  onClick={() => handleSelect(opt.value)}
                  className={`
                    w-full flex items-center justify-between px-3 py-2 rounded-lg text-sm transition-colors
                    ${isActive 
                      ? 'bg-[var(--admin-primary)]/10 text-[var(--admin-primary)] font-medium' 
                      : 'text-[var(--admin-fg)] hover:bg-[var(--admin-hover)]'
                    }
                  `}
                >
                  <span>{opt.label}</span>
                  {isActive && <Check size={16} />}
                </button>
              );
            })}
          </div>
        </div>
      )}
    </div>
  );
}
```

## File: src/components/admin/ProjectTable.tsx
```typescript
// src/components/admin/ProjectTable.tsx
'use client';

import React, { useState, useEffect, useMemo } from 'react';
import Image from 'next/image';
import Link from 'next/link';
import { Edit, Eye, Trash2, Search, Loader2, ArrowUpDown, ArrowDown, ArrowUp } from 'lucide-react';
import { useInView } from 'react-intersection-observer'; // C·∫ßn c√†i: npm install react-intersection-observer
import { toast } from 'sonner';
import { deleteProject, UserProfile } from '@/lib/actions';
import { createBrowserClient } from '@supabase/ssr';
import ConfirmModal from '@/components/ui/ConfirmModal';
import { ProjectData } from '@/data/projects-master-data';

interface ProjectTableProps {
  initialProjects: ProjectData[];
  itemsPerPage: number;
  userProfile: UserProfile | null;
}
// ƒê·ªãnh nghƒ©a c√°c ki·ªÉu sort
type SortKey = 'id' | 'title' | 'categoryName' | 'isFeatured';
type SortDirection = 'asc' | 'desc';

interface SortConfig {
  key: SortKey;
  direction: SortDirection;
}

export default function ProjectTable({ initialProjects, itemsPerPage, userProfile }: ProjectTableProps) {
  // State Data
  const [projects, setProjects] = useState<ProjectData[]>(initialProjects);
  const [searchQuery, setSearchQuery] = useState('');
  // State Sort
  const [sortConfig, setSortConfig] = useState<SortConfig>({ key: 'id', direction: 'desc' });
  // State Pagination
  const [visibleCount, setVisibleCount] = useState(itemsPerPage);
  const { ref, inView } = useInView(); // Ref ƒë·ªÉ g·∫Øn v√†o element ƒë√°y trang

  // State Delete Modal
  const [deleteModalOpen, setDeleteModalOpen] = useState(false);
  const [projectToDelete, setProjectToDelete] = useState<{ id: number, title: string } | null>(null);
  const [isDeleting, setIsDeleting] = useState(false);

  const supabase = createBrowserClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
  );

  // H√†m x·ª≠ l√Ω s·∫Øp x·∫øp
  const handleSort = (key: SortKey) => {
    setSortConfig((current) => {
      if (current.key === key) {
        // N·∫øu ƒëang click c·ªôt hi·ªán t·∫°i -> ƒê·∫£o chi·ªÅu
        return { key, direction: current.direction === 'asc' ? 'desc' : 'asc' };
      }
      // N·∫øu click c·ªôt m·ªõi -> M·∫∑c ƒë·ªãnh tƒÉng d·∫ßn (A-Z)
      return { key, direction: 'asc' };
    });
  };
  // 3. LOGIC L·ªåC & S·∫ÆP X·∫æP (D√πng useMemo ƒë·ªÉ t·ªëi ∆∞u)
  const processedProjects = useMemo(() => {
    // A. L·ªçc theo Search
    const result = projects.filter(p => 
      p.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
      p.client_name?.toLowerCase().includes(searchQuery.toLowerCase()) ||
      p.categoryName?.toLowerCase().includes(searchQuery.toLowerCase())
    );

    // B. S·∫Øp x·∫øp
    result.sort((a, b) => {
      const aValue = a[sortConfig.key];
      const bValue = b[sortConfig.key];

      // X·ª≠ l√Ω tr∆∞·ªùng h·ª£p null/undefined
      if (aValue === undefined || aValue === null) return 1;
      if (bValue === undefined || bValue === null) return -1;

      // So s√°nh
      if (aValue < bValue) return sortConfig.direction === 'asc' ? -1 : 1;
      if (aValue > bValue) return sortConfig.direction === 'asc' ? 1 : -1;
      return 0;
    });

    return result;
  }, [projects, searchQuery, sortConfig]);

  // 2. C·∫Øt danh s√°ch ƒë·ªÉ hi·ªÉn th·ªã (Infinite Scroll)
  const visibleProjects = processedProjects.slice(0, visibleCount);

  // 3. T·ª± ƒë·ªông load th√™m khi cu·ªôn xu·ªëng ƒë√°y
  useEffect(() => {
    if (inView && visibleCount < processedProjects.length) {
      // Delay nh·∫π ƒë·ªÉ t·∫°o c·∫£m gi√°c ƒëang load (optional)
      const timer = setTimeout(() => {
        setVisibleCount(prev => prev + itemsPerPage);
      }, 300);
      return () => clearTimeout(timer);
    }
  }, [inView, visibleCount, processedProjects.length, itemsPerPage]);

  // Reset pagination khi search thay ƒë·ªïi
  useEffect(() => {
    setVisibleCount(itemsPerPage);
  }, [searchQuery, itemsPerPage]);

  // 4. Logic X√≥a D·ª± √°n
  const openDeleteModal = (id: number, title: string) => {
    setProjectToDelete({ id, title });
    setDeleteModalOpen(true);
  };

  const handleDeleteConfirm = async () => {
    if (!projectToDelete) return;
    setIsDeleting(true);
    try {
      const { data: { session } } = await supabase.auth.getSession();
      if (!session) {
        toast.error("H·∫øt phi√™n ƒëƒÉng nh·∫≠p");
        return;
      }

      const res = await deleteProject(session.access_token, projectToDelete.id);
      if (res.success) {
        toast.success("ƒê√£ x√≥a d·ª± √°n");
        // C·∫≠p nh·∫≠t UI ngay l·∫≠p t·ª©c (Kh√¥ng c·∫ßn reload trang)
        setProjects(prev => prev.filter(p => p.id !== projectToDelete.id));
        setDeleteModalOpen(false);
      } else {
        toast.error(res.error);
      }
    } catch (error) {
        const msg = error instanceof Error ? error.message : "L·ªói h·ªá th·ªëng";
        toast.error(msg);
    } finally {
      setIsDeleting(false);
    }
  };
  // Component Header nh·ªè ƒë·ªÉ t√°i s·ª≠ d·ª•ng
  const SortableHeader = ({ label, colKey, className = "" }: { label: string, colKey: SortKey, className?: string }) => {
    const isActive = sortConfig.key === colKey;
    return (
      <th 
        className={`p-4 cursor-pointer hover:bg-[var(--admin-hover)] transition-colors group select-none ${className}`}
        onClick={() => handleSort(colKey)}
      >
        <div className={`flex items-center gap-2 ${className.includes('text-center') ? 'justify-center' : ''}`}>
          {label}
          <span className={`text-[var(--admin-sub)] transition-opacity ${isActive ? 'opacity-100 text-[var(--admin-primary)]' : 'opacity-0 group-hover:opacity-50'}`}>
            {isActive ? (
              sortConfig.direction === 'asc' ? <ArrowUp size={14} /> : <ArrowDown size={14} />
            ) : (
              <ArrowUpDown size={14} />
            )}
          </span>
        </div>
      </th>
    );
  };
  return (
    <div className="space-y-6">
      
      {/* Toolbar */}
      <div className="flex gap-3 p-1 bg-[var(--admin-card)] rounded-xl border border-[var(--admin-border)] p-4 shadow-sm">
        <div className="relative flex-1">
            <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-[var(--admin-sub)]" size={18} />
            <input 
              type="text" 
              placeholder="T√¨m ki·∫øm d·ª± √°n, kh√°ch h√†ng..." 
              className="w-full pl-10 pr-4 py-2.5 bg-[var(--admin-bg)] border border-[var(--admin-border)] rounded-lg text-sm outline-none focus:border-[var(--admin-primary)] text-[var(--admin-fg)] transition-all" 
              value={searchQuery}
              onChange={(e) => setSearchQuery(e.target.value)}
            />
        </div>
        <div className="text-sm text-[var(--admin-sub)] flex items-center px-3 bg-[var(--admin-bg)] rounded-lg border border-[var(--admin-border)]">
            {processedProjects.length} k·∫øt qu·∫£
        </div>
      </div>

      {/* Table */}
      <div className="bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-xl overflow-hidden shadow-sm">
        <div className="overflow-x-auto">
          <table className="w-full text-left border-collapse">
            <thead>
              <tr className="bg-[var(--admin-bg)] border-b border-[var(--admin-border)] text-[var(--admin-sub)] text-xs uppercase tracking-wider">
                {/* 4. √ÅP D·ª§NG SORTABLE HEADER */}
                <SortableHeader label="#ID" colKey="id" className="w-20 font-mono" />
                <th className="p-4 w-24">·∫¢nh</th>
                <SortableHeader label="T√™n D·ª± √Ån" colKey="title" />
                <SortableHeader label="Danh M·ª•c" colKey="categoryName" />
                <SortableHeader label="Tr·∫°ng Th√°i" colKey="isFeatured" className="text-center" />
                <th className="p-4 text-right">H√†nh ƒë·ªông</th>
              </tr>
            </thead>
            <tbody className="divide-y divide-[var(--admin-border)]">
              {visibleProjects.length === 0 ? (
                <tr>
                    <td colSpan={6} className="p-12 text-center text-[var(--admin-sub)] italic">
                        Kh√¥ng t√¨m th·∫•y d·ª± √°n n√†o.
                    </td>
                </tr>
              ) : (
                visibleProjects.map((project, index) => (
                  <tr key={project.id} className="hover:bg-[var(--admin-hover)] transition-colors group animate-fade-in-row"
                    // 3. T√çNH TO√ÅN ƒê·ªò TR·ªÑ (STAGGER DELAY)
                    // index % itemsPerPage gi√∫p reset delay khi qua trang m·ªõi (n·∫øu c√≥ pagination) 
                    // ho·∫∑c ch·ªâ ƒë∆°n gi·∫£n l√† index * 50ms
                    style={{ 
                      animationDelay: `${(index % itemsPerPage) * 0.05}s` 
                    }}>
                    <td className="p-4 text-xs text-[var(--admin-sub)] font-mono">#{project.id}</td>
                    <td className="p-4">
                      <div className="relative w-16 h-10 bg-gray-200 rounded overflow-hidden border border-[var(--admin-border)]">
                        {project.image ? (
                           <Image 
                             src={typeof project.image === 'string' ? project.image : project.image.src} 
                             alt={project.title} 
                             fill 
                             className="object-cover" 
                           />
                        ) : <div className="w-full h-full flex items-center justify-center text-[8px]">NO IMG</div>}
                      </div>
                    </td>
                    <td className="p-4">
                      <Link href={`/admin/projects/${project.id}`} className="font-medium text-[var(--admin-fg)] hover:text-[var(--admin-primary)] transition-colors block mb-0.5">
                        {project.title}
                      </Link>
                      <span className="text-xs text-[var(--admin-sub)]">{project.client_name}</span>
                    </td>
                    <td className="p-4">
                      <span className="inline-flex px-2.5 py-1 rounded-full text-xs font-medium bg-[var(--admin-bg)] border border-[var(--admin-border)] text-[var(--admin-fg)]">
                        {project.categoryName}
                      </span>
                    </td>
                    <td className="p-4 text-center">
                      {project.isFeatured && (
                        <span className="inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold bg-yellow-100 text-yellow-800 border border-yellow-200 shadow-sm">
                          N·ªîI B·∫¨T
                        </span>
                      )}
                    </td>
                    <td className="p-4 text-right">
                      <div className="flex items-center justify-end gap-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity">
                        <Link 
                          href={`/du-an/${project.slug}`} 
                          target="_blank"
                          className="p-2 text-[var(--admin-sub)] hover:text-[var(--admin-fg)] hover:bg-[var(--admin-card)] rounded-lg"
                          title="Xem trang web"
                        >
                          <Eye size={18} />
                        </Link>
                        
                        <Link 
                          href={`/admin/projects/${project.id}`} 
                          className="p-2 text-blue-500 hover:bg-[var(--admin-edit)] rounded-lg"
                          title="Ch·ªânh s·ª≠a"
                        >
                          <Edit size={18} />
                        </Link>
                        {/* CH·ªà ADMIN M·ªöI TH·∫§Y */}
                        {userProfile?.role === 'Admin' && (
                          <>
                            <button 
                              onClick={() => openDeleteModal(Number(project.id), project.title)}
                              className="p-2 text-red-500 hover:bg-[var(--admin-delete)] rounded-lg cursor-pointer"
                              title="X√≥a"
                            >
                              <Trash2 size={18} />
                            </button>
                           </>
                        )}
                        
                      </div>
                    </td>
                  </tr>
                ))
              )}
            </tbody>
          </table>
          
          {/* LOADER D∆Ø·ªöI C√ôNG ƒê·ªÇ K√çCH HO·∫†T LOAD MORE */}
          {visibleProjects.length < processedProjects.length && (
             <div ref={ref} className="p-4 flex justify-center">
                <Loader2 className="animate-spin text-[var(--admin-sub)]" />
             </div>
          )}
        </div>
      </div>

      {/* DELETE CONFIRM MODAL */}
      <ConfirmModal 
        isOpen={deleteModalOpen}
        onClose={() => !isDeleting && setDeleteModalOpen(false)}
        onConfirm={handleDeleteConfirm}
        title="X√≥a d·ª± √°n n√†y?"
        description={`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a d·ª± √°n "${projectToDelete?.title}"? H√†nh ƒë·ªông n√†y s·∫Ω x√≥a vƒ©nh vi·ªÖn to√†n b·ªô th√¥ng tin v√† h√¨nh ·∫£nh li√™n quan.`}
        confirmText={isDeleting ? "ƒêang x√≥a..." : "X√≥a vƒ©nh vi·ªÖn"}
        cancelText="ƒê√≥ng"
        variant="danger"
        isLoading={isDeleting}
      />
    </div>
  );
}
```

## File: src/components/admin/StaffPageHeader.tsx
```typescript
'use client';

import { useState } from 'react';
import { Plus } from 'lucide-react';
import CreateStaffModal from './CreateStaffModal';

export default function StaffPageHeader({ total }: { total: number }) {
  const [isModalOpen, setIsModalOpen] = useState(false);

  return (
    <>
      <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
        <div>
          <h1 className="text-3xl font-bold text-[var(--admin-fg)]">Nh√¢n s·ª± Studio</h1>
          <p className="text-[var(--admin-sub)] mt-1">T·ªïng s·ªë: {total} th√†nh vi√™n</p>
        </div>
        <button 
          onClick={() => setIsModalOpen(true)}
          className="flex items-center justify-center gap-2 px-5 py-2.5 bg-[var(--admin-primary)] text-[var(--admin-bg)] 
          rounded-lg hover:opacity-90 transition-all shadow-lg shadow-indigo-500/30 font-medium cursor-pointer"
        >
          <Plus size={20} /> Th√™m Nh√¢n vi√™n
        </button>
      </div>

      <CreateStaffModal isOpen={isModalOpen} onClose={() => setIsModalOpen(false)} />
    </>
  );
}
```

## File: src/components/AnimatedProfileImage.tsx
```typescript
// src/components/AnimatedProfileImage.tsx
'use client'; 

import { motion } from 'framer-motion';
import React from 'react';

export default function AnimatedProfileImage({ children }: { children: React.ReactNode }) {
  return (
    <motion.div
      className="w-full max-w-sm md:max-w-none bg-[var(--background)] shadow-2x"
      initial={{ opacity: 0, y: 20 }}
      whileInView={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.5 }}
      viewport={{ once: true, amount: 0.3 }}
    >
      {children}
    </motion.div>
  );
}
```

## File: src/components/BrandScroller.tsx
```typescript
// src/components/BrandScroller.tsx
import React from 'react';
import Container from './Container';

// 1. C·∫¨P NH·∫¨T M√ÄU S·∫ÆC ICON
const brands = [
  {
    href: 'https://x.com',
    svg: (
      <svg width="120" height="109" viewBox="0 0 120 109" fill="none" xmlns="http://www.w3.org/2000/svg" 
           className="fill-[#ebebeb] dark:fill-gray-950 w-8 h-8"> {/* <-- THAY ƒê·ªîI M√ÄU FILL */}
        <path d="M94.5068 0H112.907L72.7076 46.172L120 109H82.9692L53.9674 70.8942L20.7818 109H2.3693L45.3666 59.6147L0 0H37.9685L64.1848 34.8292L94.5068 0ZM88.0484 97.9318H98.2448L32.4288 10.4872H21.4882L88.0484 97.9318Z" />
      </svg>
    ),
  },
  {
    href: 'https://www.youtube.com',
    svg: (
      <svg width="206" height="143" viewBox="0 0 206 143" fill="none" xmlns="http://www.w3.org/2000/svg" 
           className="fill-[#ebebeb] dark:fill-gray-950 w-9 h-9"> {/* <-- THAY ƒê·ªîI M√ÄU FILL */}
        <path fillRule="evenodd" clipRule="evenodd" d="M82.4536 97.9153V40.5946C102.803 50.1698 118.563 59.4196 137.202 69.3921C121.829 77.9181 102.803 87.4845 82.4536 97.9153ZM195.858 12.0864C192.348 7.46178 186.366 3.86191 179.996 2.6701C161.275 -0.884977 44.4825 -0.895089 25.7716 2.6701C20.664 3.62759 16.1159 5.94198 12.2089 9.53781C-4.25342 24.8174 0.905084 106.757 4.87314 120.03C6.54174 125.775 8.69882 129.918 11.4154 132.638C14.9154 136.234 19.7075 138.709 25.2119 139.82C40.6263 143.008 120.038 144.791 179.671 140.299C185.165 139.341 190.028 136.785 193.864 133.037C209.085 117.818 208.047 31.2775 195.858 12.0864Z" />
      </svg>
    ),
  },
  {
    href: 'https://github.com',
    svg: (
      <svg width="202" height="202" viewBox="0 0 202 202" fill="none" xmlns="http://www.w3.org/2000/svg" 
           className="fill-[#ebebeb] dark:fill-gray-950 w-9 h-9"> {/* <-- THAY ƒê·ªîI M√ÄU FILL */}
        <path fillRule="evenodd" clipRule="evenodd" d="M101 0C156.782 0 202 46.3583 202 103.555C202 149.297 173.094 188.102 132.987 201.808C127.866 202.828 126.048 199.594 126.048 196.837C126.048 193.423 126.169 182.273 126.169 168.416C126.169 158.76 122.937 152.458 119.311 149.246C141.804 146.681 165.438 137.923 165.438 98.1495C165.438 86.8375 161.519 77.6066 155.035 70.3548C156.085 67.7389 159.55 57.2059 154.045 42.9447C154.045 42.9447 145.581 40.1699 126.3 53.5625C118.231 51.2698 109.585 50.1163 101 50.0759C92.415 50.1163 83.7795 51.2698 75.7197 53.5625C56.4186 40.1699 47.9346 42.9447 47.9346 42.9447C42.4503 57.2059 45.9146 67.7389 46.9549 70.3548C40.501 77.6066 36.5519 86.8375 36.5519 98.1495C36.5519 137.822 60.1354 146.714 82.5675 149.33C79.6789 151.916 77.063 156.477 76.154 163.173C70.397 165.819 55.7722 170.399 46.763 154.572C46.763 154.572 41.4201 144.623 31.2797 143.895C31.2797 143.895 21.4322 143.765 30.5929 150.188C30.5929 150.188 37.2084 153.37 41.8039 165.338C41.8039 165.338 47.7326 183.821 75.8308 177.559C75.8813 186.214 75.9722 194.372 75.9722 196.837C75.9722 199.574 74.1138 202.777 69.0739 201.818C28.9365 188.132 0 149.308 0 103.555C0 46.3583 45.2278 0 101 0Z" />
      </svg>
    ),
  },
  {
    href: 'https://instagram.com', // <-- Thay link
    svg: (
      <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
           className="fill-[#ebebeb] dark:fill-gray-950 w-8 h-8">
        <path fillRule="evenodd" clipRule="evenodd" d="M12 7.00004C9.23858 7.00004 7 9.23862 7 12.0001C7 14.7615 9.23858 17.0001 12 17.0001C14.7614 17.0001 17 14.7615 17 12.0001C17 9.23862 14.7614 7.00004 12 7.00004ZM9 12.0001C9 10.3432 10.3431 9.00004 12 9.00004C13.6569 9.00004 15 10.3432 15 12.0001C15 13.6569 13.6569 15.0001 12 15.0001C10.3431 15.0001 9 13.6569 9 12.0001Z" />
        <path d="M18 5.00002C17.4477 5.00002 17 5.44774 17 6.00002C17 6.5523 17.4477 7.00002 18 7.00002C18.5523 7.00002 19 6.5523 19 6.00002C19 5.44774 18.5523 5.00002 18 5.00002Z" />
        <path fillRule="evenodd" clipRule="evenodd" d="M5 1.00002C2.79086 1.00002 1 2.79088 1 5.00002V19.0001C1 21.2092 2.79086 23.0001 5 23.0001H19C21.2091 23.0001 23 21.2092 23 19.0001V5.00002C23 2.79088 21.2091 1.00002 19 1.00002H5ZM5 3.00002C3.89543 3.00002 3 3.89545 3 5.00002V19.0001C3 20.1046 3.89543 21.0001 5 21.0001H19C20.1046 21.0001 21 20.1046 21 19.0001V5.00002C21 3.89545 20.1046 3.00002 19 3.00002H5Z" />
      </svg>
    ),
  },
 {
    href: 'https://facebook.com', // <-- Thay link
    svg: (
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"
           className="fill-[#ebebeb] dark:fill-gray-950 w-8 h-8">
        <path d="M14,6h3a1,1,0,0,0,1-1V3a1,1,0,0,0-1-1H14A5,5,0,0,0,9,7v3H7a1,1,0,0,0-1,1v2a1,1,0,0,0,1,1H9v7a1,1,0,0,0,1,1h2a1,1,0,0,0,1-1V14h2.22a1,1,0,0,0,1-.76l.5-2a1,1,0,0,0-1-1.24H13V7A1,1,0,0,1,14,6Z"></path>
      </svg>
    )
  },
    {
    href: 'https://tiktok.com', // <-- Thay link
    svg: (
      <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"
           className="fill-[#ebebeb] dark:fill-gray-950 w-8 h-8">
        <path d="M16.656 1.029c1.637-0.025 3.262-0.012 4.886-0.025 0.054 2.031 0.878 3.859 2.189 5.213l-0.002-0.002c1.411 1.271 3.247 2.095 5.271 2.235l0.028 0.002v5.036c-1.912-0.048-3.71-0.489-5.331-1.247l0.082 0.034c-0.784-0.377-1.447-0.764-2.077-1.196l0.052 0.034c-0.012 3.649 0.012 7.298-0.025 10.934-0.103 1.853-0.719 3.543-1.707 4.954l0.020-0.031c-1.652 2.366-4.328 3.919-7.371 4.011l-0.014 0c-0.123 0.006-0.268 0.009-0.414 0.009-1.73 0-3.347-0.482-4.725-1.319l0.040 0.023c-2.508-1.509-4.238-4.091-4.558-7.094l-0.004-0.041c-0.025-0.625-0.037-1.25-0.012-1.862 0.49-4.779 4.494-8.476 9.361-8.476 0.547 0 1.083 0.047 1.604 0.136l-0.056-0.008c0.025 1.849-0.050 3.699-0.050 5.548-0.423-0.153-0.911-0.242-1.42-0.242-1.868 0-3.457 1.194-4.045 2.861l-0.009 0.030c-0.133 0.427-0.21 0.918-0.21 1.426 0 0.206 0.013 0.41 0.037 0.61l-0.002-0.024c0.332 2.046 2.086 3.59 4.201 3.59 0.061 0 0.121-0.001 0.181-0.004l-0.009 0c1.463-0.044 2.733-0.831 3.451-1.994l0.010-0.018c0.267-0.372 0.45-0.822 0.511-1.311l0.001-0.014c0.125-2.237 0.075-4.461 0.087-6.698 0.012-5.036-0.012-10.060 0.025-15.083z"></path>
      </svg>
    )
  },
  {
    href: 'https://behance.net', // <-- Thay link
    svg: (
      <svg viewBox="0 0 95.802 95.802" xmlns="http://www.w3.org/2000/svg"
           className="fill-[#ebebeb] dark:fill-gray-950 w-9 h-9"> {/* <-- C·ª° w-9 h-9 cho c√¢n ƒë·ªëi */}
        <g>
          <path d="M38.664,44.689c0,0,9.065-0.673,9.065-11.306c0-10.632-7.417-15.819-16.813-15.819H13.622h-0.508H0v59.414h13.114h0.508 h17.294c0,0,18.873,0.597,18.873-17.536C49.79,59.442,50.613,44.689,38.664,44.689z M13.622,28.125h15.069h2.226 c0,0,4.203,0,4.203,6.181c0,6.181-2.473,7.077-5.275,7.077H13.622V28.125z M30.119,66.42H13.622V50.541h17.294 c0,0,6.264-0.08,6.264,8.16C37.18,65.572,32.599,66.351,30.119,66.42z"></path>
          <rect x="62.18" y="21.064" width="24.514" height="7.317"></rect>
          <path d="M74.961,32.682c-22.848,0-22.828,22.826-22.828,22.826s-1.566,22.713,22.829,22.713c0,0,20.331,1.162,20.331-15.801 H84.837c0,0,0.349,6.391-9.526,6.391c0,0-10.455,0.699-10.455-10.34h30.785C95.641,58.471,99.009,32.682,74.961,32.682z M84.255,50.541H64.738c0,0,1.277-9.158,10.455-9.158C84.372,41.382,84.255,50.541,84.255,50.541z"></path>
        </g>
      </svg>
    )
  }
];

const repeatedBrands = [...brands, ...brands];

// 2. C·∫¨P NH·∫¨T N·ªÄN C·ª¶A ICON
const BrandList = ({ 'aria-hidden': ariaHidden = false }) => (
  <ul
    className="flex items-center justify-center md:justify-start [&_li]:mx-4 sm:[&_li]:mx-8 animate-infinite-scroll"
    aria-hidden={ariaHidden}
  >
    {repeatedBrands.map((brand, index) => (
      <li key={index}>
        <a
          target="_blank"
          rel="noopener noreferrer"
          href={brand.href}
          className="border border-[var(--foreground)]
                     bg-white 
                     grid place-content-center p-3 rounded-md
                     transition-opacity hover:opacity-70" /* <-- THAY ƒê·ªîI N·ªÄN ICON */
        >
          {brand.svg}
        </a>
      </li>
    ))}
  </ul>
);

export default function BrandScroller() {
  return (
    <Container>
      <div
        className="w-full py-8 inline-flex flex-nowrap overflow-hidden 
                  mask-[linear-gradient(to_right,transparent_0,black_128px,black_calc(100%-200px),transparent_100%)]"
      >
        <BrandList />
        <BrandList aria-hidden={true} />
      </div>
    </Container>
  );
}
```

## File: src/components/BtsSection.tsx
```typescript
// src/components/BtsSection.tsx
'use client';

import React, { useState, useEffect, useRef } from 'react';
import Image from 'next/image';
import Container from './Container'; // T·∫≠n d·ª•ng Container b·∫°n ƒë√£ c√≥
import projects from '../data/bts'; // Import d·ªØ li·ªáu Section 04
import styles from '../app/styles/BtsSection.module.css'; // File CSS module m·ªõi

// Component con cho t·ª´ng "c·∫£nh" text
interface SceneProps {
  project: (typeof projects)[0];
  onVisible: () => void; // H√†m callback khi scene n√†y active
  isActive: boolean;
}

const Scene: React.FC<SceneProps> = ({ project, onVisible, isActive }) => {
  const ref = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const node = ref.current;
    if (!node) return;

    // K√≠ch ho·∫°t khi scene ƒëi v√†o gi·ªØa m√†n h√¨nh
    const observer = new IntersectionObserver(
      (entries) => {
        const [entry] = entries;
        if (entry.isIntersecting) {
          onVisible(); // G·ªçi h√†m callback ƒë·ªÉ c·∫≠p nh·∫≠t activeIndex
        }
      },
      {
        threshold: 0.5, // K√≠ch ho·∫°t khi 50% n·ªôi dung l·ªçt v√†o
        rootMargin: '0px 0px -40% 0px', // Thu h·∫πp v√πng trigger v√†o gi·ªØa
      }
    );

    observer.observe(node);
    return () => observer.disconnect();
  }, [onVisible]);

  return (
      // Scene b√¢y gi·ªù l√† m·ªôt "m√†n h√¨nh" full-height
      <div ref={ref} className={styles.scene}>
        {/* B·ªçc n·ªôi dung text trong Container ƒë·ªÉ gi·ªØ chi·ªÅu r·ªông */}
        <Container>
          <div className={`${styles.sceneContent} ${isActive ? styles.sceneActive : ''}`}>
            <span className={styles.sceneCategory}>
              {project.client} / {project.year}
            </span>
            <h3 className={styles.sceneTitle}>{project.title}</h3>
            <p className={styles.sceneDescription}>{project.description}</p>
          </div>
        </Container>
      </div>
    );
};

export default function BtsSection() {
  const [activeIndex, setActiveIndex] = useState(0);
  const btsProjects = projects.slice(0, 6);

  return (
    <section id="case-studies" className={styles.btsSection}>
      {/* 1. PH·∫¶N H√åNH ·∫¢NH (STICKY ·ªû N·ªÄN) */}
      <div className={styles.stickyImageWrapper}>
        {btsProjects.map((project, index) => (
          <div
            key={project.title}
            className={`${styles.imageContainer} ${
              activeIndex === index ? styles.imageActive : ''
            }`}
          >
            <Image
              src={project.imageUrl} // ·∫¢nh ngang c·ªßa b·∫°n
              alt={project.title}
              fill
              objectFit="cover" // object-fit: cover b√¢y gi·ªù s·∫Ω ho·∫°t ƒë·ªông T·ªêT
              quality={90}
              priority={index === 0}
              className={styles.image}
            />
            <div className={styles.imageOverlay} /> {/* Th√™m l·ªõp ph·ªß m·ªù */}
          </div>
        ))}
      </div>

      {/* 2. PH·∫¶N N·ªòI DUNG (CU·ªòN L√äN TR√äN) */}
      {/* Ti√™u ƒë·ªÅ cho Section (cu·ªôn b√¨nh th∆∞·ªùng) */}
      <div className={styles.sectionHeader}>
        <Container>
          <h2 className={styles.sectionTitle}>H·∫≠u tr∆∞·ªùng</h2>
          <p className={styles.sectionSubtitle}>
            C√¢u chuy·ªán v√† b·ªëi c·∫£nh ƒë·∫±ng sau nh·ªØng t√°c ph·∫©m ch·ªçn l·ªçc.
          </p>
        </Container>
      </div>

      {/* C·ªôt text cu·ªôn (ƒë√® l√™n tr√™n ·∫£nh) */}
      <div className={styles.textColumn}>
        {btsProjects.map((project, index) => (
          <Scene
           key={project.title}
            project={project}
            onVisible={() => setActiveIndex(index)}
            isActive={activeIndex === index}
          />
        ))}
      </div>
    </section>
  );
}
```

## File: src/components/project-grid.tsx
```typescript
// app/thoi-trang/project-grid.tsx
'use client';

import { useState, useEffect, useRef, useCallback } from 'react';
import Link from 'next/link';
import Image from 'next/image';
import type { Project } from '@/lib/seed-helpers';
import Spinner from '@/components/Spinner';
import {
  INITIAL_LOAD_COUNT,
  LOAD_MORE_COUNT,
  SLUG_CATE_PERSONAL,
  SLUG_CATE_COMMERCIAL,
  SLUG_CATE_FASHION,
} from '@/lib/constants';

interface ProjectGridProps {
  allProjects: Project[];
}

export default function ProjectGrid({ allProjects }: ProjectGridProps) {
  const [displayedProjects, setDisplayedProjects] = useState<Project[]>(
    allProjects.slice(0, INITIAL_LOAD_COUNT)
  );
  const [currentIndex, setCurrentIndex] = useState(INITIAL_LOAD_COUNT);
  const [hasMore, setHasMore] = useState(
    allProjects.length > INITIAL_LOAD_COUNT
  );
  const [isLoading, setIsLoading] = useState(false);
  const loaderRef = useRef<HTMLDivElement>(null);

  const loadMoreProjects = useCallback(() => {
    if (isLoading || !hasMore) return;
    setIsLoading(true);
    setTimeout(() => {
      const nextIndex = currentIndex + LOAD_MORE_COUNT;
      const newProjects = allProjects.slice(currentIndex, nextIndex);
      setDisplayedProjects((prev) => [...prev, ...newProjects]);
      setCurrentIndex(nextIndex);
      setHasMore(nextIndex < allProjects.length);
      setIsLoading(false);
    }, 500);
  }, [isLoading, hasMore, currentIndex, allProjects]);

  // ... (useEffect cho IntersectionObserver gi·ªØ nguy√™n) ...
  useEffect(() => {
    const observer = new IntersectionObserver(
      (entries) => {
        const firstEntry = entries[0];
        if (firstEntry.isIntersecting && hasMore && !isLoading) {
          loadMoreProjects();
        }
      },
      { threshold: 1.0 }
    );
    const currentLoader = loaderRef.current;
    if (currentLoader) {
      observer.observe(currentLoader);
    }
    return () => {
      if (currentLoader) {
        observer.unobserve(currentLoader);
      }
    };
  }, [hasMore, isLoading, loadMoreProjects]);

  // 3. (M·ªöI) L·∫•y category c·ªßa grid n√†y
  // (Gi·∫£ ƒë·ªãnh t·∫•t c·∫£ project trong `allProjects` ƒë·ªÅu c√πng 1 category)
  const gridCategory = allProjects[0]?.cateSlug;

  // 4. (M·ªöI) Helper function ƒë·ªÉ l·∫•y class cho item <Link>
  const getLinkClassName = (project: Project, index: number): string => {
    const baseClasses = 'relative group rounded-sm';

    switch (gridCategory) {
      case SLUG_CATE_FASHION:
        // Logic cho 'thoi-trang': th√™m top-[24px] cho ·∫£nh ch·∫µn
        const fashionClass = index % 2 !== 0 ? 'top-[24px]' : '';
        return `${baseClasses} ${fashionClass}`;

      case SLUG_CATE_PERSONAL:
        const colSpan = project.colSpan || 'col-span-1'; // Fallback
        const rowSpan = project.rowSpan || 'row-span-1'; // Fallback
        return `${baseClasses} ${colSpan} ${rowSpan}`;

      case SLUG_CATE_COMMERCIAL:
      default:
        // 'thuong-mai' v√† m·∫∑c ƒë·ªãnh: kh√¥ng c√≥ class ƒë·∫∑c bi·ªát
        return baseClasses;
    }
  };

  // 5. (M·ªöI) Helper function ƒë·ªÉ l·∫•y class cho grid wrapper <div>
  const getGridWrapperClassName = (category: string | undefined): string => {
    const baseGap = 'gap-3 md:gap-4';

    switch (category) {
      case SLUG_CATE_PERSONAL:
      case SLUG_CATE_FASHION:
      case SLUG_CATE_COMMERCIAL:
      default:
        // Layout 4 c·ªôt, auto-rows nh∆∞ c≈©
        return `grid grid-cols-2 md:grid-cols-4 auto-rows-[200px] md:auto-rows-[300px] ${baseGap}`;
    }
  };

  // 6. Render
  return (
    <>
      {/* (C·∫¨P NH·∫¨T) D√πng class wrapper ƒë·ªông */}
      <div className={getGridWrapperClassName(gridCategory)}>
        {displayedProjects.map((project, index) => {
          let imageSizes: string;
          const colSpan = project.colSpan || '';

          if (gridCategory === SLUG_CATE_PERSONAL) {
            // Logic cho grid 'ca-nhan' (12 c·ªôt)
            if (colSpan.includes('md:col-span-6')) { // 6/12 c·ªôt
              imageSizes = '(max-width: 768px) 50vw, 50vw';
            } else if (colSpan.includes('md:col-span-4')) { // 4/12 c·ªôt
              imageSizes = '(max-width: 768px) 50vw, 33vw';
            } else {
              imageSizes = '(max-width: 768px) 50vw, 25vw'; // Fallback
            }
          } else {
            // Logic cho 'thoi-trang' v√† 'thuong-mai' (4 c·ªôt)
            // (Hi·ªán t·∫°i layout 2 trang n√†y ƒë∆°n gi·∫£n, n√™n d√πng chung 1 sizes)
            imageSizes = '(max-width: 768px) 50vw, 25vw';
          }

          return (
          <Link
            key={project.id}
            href={`/du-an/${project.slug}`}
            // (C·∫¨P NH·∫¨T) D√πng class item ƒë·ªông
            className={getLinkClassName(project, index)}
          >
            <Image
              src={project.src}
              alt={project.title}
              fill
              sizes={imageSizes}
              className="object-cover transition-transform duration-700 ease-in-out group-hover:scale-105"
            />
            <div className="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 transition-opacity duration-500 group-hover:opacity-100" />
            <div className="absolute inset-0 p-4 flex flex-col justify-end translate-y-4 opacity-0 transition-all duration-500 group-hover:translate-y-0 group-hover:opacity-100">
              <span className="text-[10px] md:text-xs text-white/80 uppercase tracking-widest mb-2">
                {project.category || 'Project'}
              </span>
              <h3 className="text-white text-lg md:text-xl font-medium flex items-center gap-2">
                {project.title}
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  strokeWidth={2}
                  stroke="currentColor"
                  className="w-4 h-4 opacity-0 -translate-x-2 transition-all duration-500 group-hover:opacity-100 group-hover:translate-x-0"
                >
                  <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"
                  />
                </svg>
              </h3>
            </div>
            {/* --- H·∫øt n·ªôi dung b√™n trong Link --- */}
          </Link>
        );
      })}
      </div>

      {/* --- PH·∫¶N LOADER (Gi·ªØ nguy√™n) --- */}
      <div
        ref={loaderRef}
        className="col-span-2 md:col-span-4 h-24 flex justify-center items-center"
      >
        {hasMore && <Spinner />}
        {!hasMore && (
          <p className="text-[var(--sub-text)]">ƒê√£ t·∫£i h·∫øt d·ª± √°n.</p>
        )}
      </div>
    </>
  );
}
```

## File: src/components/ScrollToTopButton.tsx
```typescript
//ScrollToTopButton.tsx
'use client'; // B·∫Øt bu·ªôc v√¨ d√πng hooks

import { useEffect, useState } from 'react';

export default function ScrollToTopButton() {
  const [isVisible, setIsVisible] = useState(false);

  // 1. Hook ƒë·ªÉ theo d√µi v·ªã tr√≠ cu·ªôn
  useEffect(() => {
    const toggleVisibility = () => {
      // Hi·ªÉn th·ªã n√∫t khi cu·ªôn qua 400px
      if (window.scrollY > 400) {
        setIsVisible(true);
      } else {
        setIsVisible(false);
      }
    };

    window.addEventListener('scroll', toggleVisibility);

    // D·ªçn d·∫πp listener khi component b·ªã h·ªßy
    return () => {
      window.removeEventListener('scroll', toggleVisibility);
    };
  }, []); // Ch·ªâ ch·∫°y 1 l·∫ßn khi mount

  // 2. H√†m x·ª≠ l√Ω khi click
  const scrollToTop = () => {
    window.scrollTo({
      top: 0,
      behavior: 'smooth', // Cu·ªôn m∆∞·ª£t
    });
  };

  return (
    <button
      onClick={scrollToTop}
      className={`fixed bottom-6 right-6 z-30 p-3
                 bg-[var(--foreground)] text-[var(--background)] hover:text-[var(--foreground)] rounded-full
                 shadow-lg cursor-pointer
                 transition-all duration-300 ease-in-out
                 hover:bg-[var(--background)] border-3 border-[var(--background)] hover:border-[var(--foreground)]
                 ${
                   isVisible
                     ? 'opacity-100 translate-y-0'
                     : 'opacity-0 translate-y-4 pointer-events-none'
                 }
                `}
      aria-label="Cu·ªôn l√™n ƒë·∫ßu trang"
    >
      {/* ƒê√¢y l√† SVG m≈©i t√™n l√™n */}
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        strokeWidth={2}
        stroke="currentColor"
        className="w-5 h-5"
      >
        <path
          strokeLinecap="round"
          strokeLinejoin="round"
          d="m4.5 15.75 7.5-7.5 7.5 7.5"
        />
      </svg>
    </button>
  );
}
```

## File: src/components/ui/ConfirmModal.tsx
```typescript
// src/components/ui/ConfirmModal.tsx
'use client';

import React from 'react';
import { AlertTriangle, Loader2 } from 'lucide-react';
import ModalPortal from './ModalPortal';

interface ConfirmModalProps {
  isOpen: boolean;
  onClose: () => void;
  onConfirm: () => void;
  title: string;
  description: string;
  confirmText?: string;
  cancelText?: string;
  isLoading?: boolean;
  variant?: 'danger' | 'warning' | 'info';
}

export default function ConfirmModal({
  isOpen,
  onClose,
  onConfirm,
  title,
  description,
  confirmText = 'X√°c nh·∫≠n',
  cancelText = 'H·ªßy b·ªè',
  isLoading = false,
  variant = 'danger'
}: ConfirmModalProps) {

  return (
    <ModalPortal isOpen={isOpen} onClose={isLoading ? () => {} : onClose} className="max-w-md">
        
        {/* Header Area */}
        <div className="p-6 pb-2 flex gap-5">
          <div className={`w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0 ${
            variant === 'danger' ? 'bg-red-100 text-red-600 dark:bg-red-900/30' : 
            variant === 'warning' ? 'bg-yellow-100 text-yellow-600' : 'bg-blue-100 text-blue-600'
          }`}>
            <AlertTriangle size={24} />
          </div>
          
          <div className="flex-1 pt-1 pr-6">
            <h3 className="text-lg font-bold text-[var(--admin-fg)] leading-tight mb-2">
              {title}
            </h3>
            <p className="text-sm text-[var(--admin-sub)] leading-relaxed">
              {description}
            </p>
          </div>
        </div>

        {/* Footer Buttons */}
        <div className="p-6 pt-6 flex justify-end gap-3 bg-[var(--admin-bg)]/50 border-t border-[var(--admin-border)]">
          <button
            onClick={onClose}
            disabled={isLoading}
            className="px-5 py-2.5 rounded-xl text-sm font-medium text-[var(--admin-fg)] border border-[var(--admin-border)] hover:bg-[var(--admin-hover)] transition-colors disabled:opacity-50 cursor-pointer"
          >
            {cancelText}
          </button>
          
          <button
            onClick={onConfirm}
            disabled={isLoading}
            className={`
              px-5 py-2.5 rounded-xl text-sm font-medium text-white shadow-lg flex items-center gap-2 transition-all hover:translate-y-[-1px] cursor-pointer
              ${variant === 'danger' ? 'bg-red-600 hover:bg-red-700 shadow-red-500/20' : 'bg-indigo-600 hover:bg-indigo-700'}
              disabled:opacity-70 disabled:cursor-not-allowed disabled:transform-none
            `}
          >
            {isLoading && <Loader2 size={16} className="animate-spin" />}
            {confirmText}
          </button>
        </div>
    </ModalPortal>
  );
}
```

## File: src/lib/seed-helpers.ts
```typescript
// src/lib/seed-helpers.ts
import { StaticImageData } from 'next/image';

// ƒê·ªãnh nghƒ©a l·∫°i Project ƒë·ªÉ bao g·ªìm 'originalSlug' (cho m·ª•c ƒë√≠ch demo)
export interface Project {
  id: number;
  slug: string;
  title: string;
  description?: string;
  src: StaticImageData;
  category: string;
  cateSlug: string;
  credits?: { label: string; value: string }[];
  articleBody?: ArticleBlock[];
  colSpan: string;
  rowSpan: string;
  // Th√™m c√°c tr∆∞·ªùng t√πy ch·ªçn cho demo
  isMock?: boolean;
  originalSlug?: string; // S·∫Ω l∆∞u slug g·ªëc ·ªü ƒë√¢y
}

export type ArticleBlock =
  | { type: 'heading'; content: string }
  | { type: 'paragraph'; content: string }
  | { type: 'imageRow'; images: StaticImageData[] };

export function seedProjectsByCategory(
  allActualProjects: Project[],
  category: string,
  targetCount: number
): Project[] {
  
  const sourceProjects = allActualProjects.filter(
    (p) => p.category === category
  );

  if (sourceProjects.length === 0) {
    console.warn(`[seedProjects] Kh√¥ng t√¨m th·∫•y d·ª± √°n n√†o cho danh m·ª•c: ${category}`);
    return [];
  }

  const seededList: Project[] = [];
  const numSourceProjects = sourceProjects.length;

  for (let i = 0; i < targetCount; i++) {
    const projectToCopy = sourceProjects[i % numSourceProjects];
    const mockId = 10000 + i;

    const newProject: Project = { // S·ª≠ d·ª•ng ki·ªÉu Project ƒë√£ ƒë·ªãnh nghƒ©a
      ...projectToCopy,
      
      // 1. T·∫°o ID v√† Slug GI·∫¢ (ch·ªâ ƒë·ªÉ d√πng l√†m 'key' trong React)
      id: mockId,
      slug: `${projectToCopy.slug}-${i}`, // Slug gi·∫£ duy nh·∫•t (v√≠ d·ª•: ca-nhan-01-0, ca-nhan-01-1)
      
      // 2. L∆∞u l·∫°i Slug G·ªêC (ƒë·ªÉ d√πng cho href)
      originalSlug: projectToCopy.slug, // ƒê√¢y l√† slug th·∫≠t (v√≠ d·ª•: ca-nhan-01)
      cateSlug : projectToCopy.cateSlug,
      isMock: true,
      colSpan: projectToCopy.colSpan,
      rowSpan: projectToCopy.rowSpan,
    };

    seededList.push(newProject);
  }

  return seededList;
}
```

## File: .gitignore
```
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# env files (can opt-in for committing if needed)
.env*

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts

# Local documentation with secrets
/docs/
```

## File: src/app/admin/page.tsx
```typescript
'use client';

import { useEffect, useState } from 'react';
import { 
  getDashboardStats, 
  getTodaySchedule, 
  getGrowthChartData 
} from '@/lib/actions/stats';
import { 
  FolderOpen, 
  Image as ImageIcon, 
  Users, 
  CalendarCheck,
  TrendingUp,
  ArrowUpRight
} from 'lucide-react';
import Spinner from '@/components/Spinner';
import TodaySchedule from '@/components/admin/TodaySchedule';
import DashboardActions from '@/components/admin/DashboardActions';
import DashboardFilter from '@/components/admin/DashboardFilter';
import GrowthChart from '@/components/admin/GrowthChart';
import { useSearchParams } from 'next/navigation';

// --- 1. ƒê·ªäNH NGHƒ®A TYPE CHU·∫®N ---

// Type cho bi·ªÉu ƒë·ªì (kh·ªõp v·ªõi getGrowthChartData)
interface ChartItem {
  name: string;
  total: number;
}

// Type cho l·ªãch tr√¨nh (kh·ªõp v·ªõi getTodaySchedule)
// D·ª±a tr√™n query select trong stats.ts
export interface ScheduleItem {
  booking_item_id: number;
  start_dt: string;
  end_dt: string;
  rooms: { 
    name: string | null; 
    code: string | null; 
  } | null;
  bookings: {
    status: 'pending' | 'confirmed' | 'checked_in' | 'completed' | 'cancelled' | null;
    customers: { 
      full_name: string | null; 
      phone: string | null; 
    } | null;
  } | null;
}

interface DashboardStats {
  totalProjects: number;
  newProjects: number;
  totalStaff: number;
  todayBookings: number;
}

interface StatCardProps {
  title: string;
  value: string;
  trend: string;
  trendLabel: string;
  icon: React.ReactNode;
  colorClass: string;
}

// --- 2. COMPONENT CH√çNH ---

export default function AdminDashboard() {
  const searchParams = useSearchParams();
  const currentRange = searchParams.get('range') || '30d';

  const [stats, setStats] = useState<DashboardStats>({
    totalProjects: 0,
    newProjects: 0,
    totalStaff: 0,
    todayBookings: 0
  });

  // --- √ÅP D·ª§NG TYPE ·ªû ƒê√ÇY ---
  const [todaySchedule, setTodaySchedule] = useState<ScheduleItem[]>([]); 
  const [chartData, setChartData] = useState<ChartItem[]>([]);
  // ---------------------------

  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const fetchData = async () => {
      setLoading(true);
      try {
        // G·ªçi song song ƒë·ªÉ t·ªëi ∆∞u t·ªëc ƒë·ªô
        const [dashboardStats, schedule, chart] = await Promise.all([
          getDashboardStats(currentRange),
          getTodaySchedule(),
          getGrowthChartData(currentRange)
        ]);

        setStats(dashboardStats);
        
        // √âp ki·ªÉu an to√†n (n·∫øu DB tr·∫£ v·ªÅ field null kh√¥ng mong mu·ªën)
        setTodaySchedule(schedule as unknown as ScheduleItem[]);
        setChartData(chart);
        
      } catch (error) {
        console.error("L·ªói t·∫£i dashboard:", error);
      } finally {
        setLoading(false);
      }
    };

    fetchData();
  }, [currentRange]); // Re-fetch khi ƒë·ªïi filter

  // Helper hi·ªÉn th·ªã text
  const getTrendLabel = () => {
    if (currentRange === 'today') return 'h√¥m nay';
    if (currentRange === '7d') return 'trong tu·∫ßn qua';
    if (currentRange === '30d') return 'trong th√°ng n√†y';
    if (currentRange === '90d') return 'trong qu√Ω n√†y';
    if (currentRange === '12m') return 'trong nƒÉm nay';
    return 't·ª´ tr∆∞·ªõc ƒë·∫øn nay';
  };

  if (loading) return <div className="h-96 flex items-center justify-center"><Spinner /></div>;

  return (
    <div className="space-y-8 pb-10">
      <div className="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-6">
        <div className="min-w-0 flex-1"> 
          <h1 className="text-3xl font-bold text-[var(--admin-fg)] truncate">
            Dashboard
          </h1>
          <p className="text-[var(--admin-sub)] truncate max-w-[500px] md:max-w-none">
            Ch√†o m·ª´ng tr·ªü l·∫°i, qu·∫£n tr·ªã vi√™n.
          </p>
        </div>

        <div className="flex flex-col lg:flex-row gap-3 w-full lg:w-auto shrink-0">
            <DashboardFilter />
            <DashboardActions />
        </div>
      </div>

      {/* Stats Cards Grid */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <StatCard 
          title="Booking H√¥m Nay"
          value={stats.todayBookings.toString()}
          trend="Today"
          trendLabel="ca ch·ª•p trong ng√†y"
          icon={<CalendarCheck size={24} className="text-orange-600 dark:text-orange-400" />}
          colorClass="bg-orange-50 dark:bg-orange-900/20"
        />
        <StatCard 
          title="T·ªïng D·ª± √Ån"
          value={stats.totalProjects.toString()}
          trend={`+${stats.newProjects}`}
          trendLabel={getTrendLabel()}
          icon={<FolderOpen size={24} className="text-blue-600 dark:text-blue-400" />}
          colorClass="bg-blue-50 dark:bg-blue-900/20"
        />
        <StatCard 
          title="D·ª± √Ån M·ªõi"
          value={stats.newProjects.toString()}
          trend="New"
          trendLabel={getTrendLabel()}
          icon={<ImageIcon size={24} className="text-green-600 dark:text-green-400" />}
          colorClass="bg-green-50 dark:bg-green-900/20"
        />
        <StatCard 
          title="Nh√¢n S·ª±"
          value={stats.totalStaff.toString()}
          trend="Active"
          trendLabel="ƒëang ho·∫°t ƒë·ªông"
          icon={<Users size={24} className="text-purple-600 dark:text-purple-400" />}
          colorClass="bg-purple-50 dark:bg-purple-900/20"
        />
      </div>

      {/* Main Content Grid */}
      <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
        
        {/* C·ªòT TR√ÅI (2/3): Bi·ªÉu ƒë·ªì */}
        <div className="lg:col-span-2 bg-[var(--admin-card)] p-6 rounded-2xl border border-[var(--admin-border)] shadow-sm min-h-[400px]">
           <div className="flex items-center gap-3 mb-4">
              <div className="p-2 bg-[var(--admin-primary)]/10 rounded-lg text-[var(--admin-primary)]">
                  <TrendingUp size={20} />
              </div>
              <div>
                  <h3 className="text-lg font-bold text-[var(--admin-fg)]">TƒÉng tr∆∞·ªüng Booking</h3>
                  <p className="text-xs text-[var(--admin-sub)]">S·ªë li·ªáu {getTrendLabel()}.</p>
              </div>
           </div>
           
           {chartData.length > 0 ? (
              <GrowthChart data={chartData} />
           ) : (
              <div className="h-[300px] flex items-center justify-center text-[var(--admin-sub)] italic">
                Ch∆∞a c√≥ d·ªØ li·ªáu trong kho·∫£ng th·ªùi gian n√†y.
              </div>
           )}
        </div>

        {/* C·ªòT PH·∫¢I (1/3): L·ªãch tr√¨nh h√¥m nay */}
        <div className="bg-[var(--admin-card)] p-6 rounded-2xl border border-[var(--admin-border)] shadow-sm flex flex-col h-full max-h-[500px]">
           <div className="flex items-center justify-between mb-6">
              <h3 className="font-bold text-[var(--admin-fg)] text-lg">L·ªãch tr√¨nh h√¥m nay</h3>
              <span className="text-xs bg-[var(--admin-primary)]/10 text-[var(--admin-primary)] px-2 py-1 rounded font-bold">
                {new Date().toLocaleDateString('vi-VN', { weekday: 'short', day: 'numeric', month: 'numeric' })}
              </span>
           </div>
           
           <div className="flex-1 overflow-y-auto pr-1 table-scrollbar">
              <TodaySchedule bookings={todaySchedule} />
           </div>
        </div>
      </div>
    </div>
  );
}

// Sub-component StatCard (Gi·ªØ nguy√™n UI)
function StatCard({ title, value, trend, trendLabel, icon, colorClass }: StatCardProps) {
  return (
    <div className="bg-[var(--admin-card)] p-6 rounded-2xl border border-[var(--admin-border)] shadow-sm hover:shadow-md transition-all duration-300 group">
      <div className="flex items-start justify-between mb-4">
        <div className={`p-3 rounded-xl ${colorClass} group-hover:scale-110 transition-transform duration-300`}>
          {icon}
        </div>
        <span className="flex items-center text-xs font-medium text-green-600 bg-green-50 dark:bg-green-900/20 px-2 py-1 rounded-full border border-green-100 dark:border-green-900">
          <ArrowUpRight size={12} className="mr-1" />
          {trend}
        </span>
      </div>
      <div>
        <h3 className="text-sm font-medium text-[var(--admin-sub)]">{title}</h3>
        <div className="mt-1 text-3xl font-bold text-[var(--admin-fg)] tracking-tight">{value}</div>
        <p className="text-xs text-[var(--admin-sub)]/80 mt-2 capitalize">{trendLabel}</p>
      </div>
    </div>
  );
}
```

## File: src/app/not-found.tsx
```typescript
// src/app/not-found.tsx

import Link from 'next/link';
import Container from '@/components/Container'; // T√°i s·ª≠ d·ª•ng Container
import type { Metadata } from 'next';

export const metadata: Metadata = {
  title: '404 - Kh√¥ng t√¨m th·∫•y | Oni Studio',
  description: 'Trang b·∫°n ƒëang t√¨m ki·∫øm kh√¥ng t·ªìn t·∫°i.',
};

export default function NotFound() {
  return (
    <Container>
      <div className="flex flex-col items-center justify-center text-center py-24 md:py-32 min-h-[calc(100vh_-_250px)]">
        
        {/* M√£ l·ªói 404 */}
        <span className="text-7xl md:text-9xl font-light tracking-tighter text-[var(--foreground)]">
          404
        </span>
        
        {/* Ti√™u ƒë·ªÅ */}
        <h1 className="mt-4 text-3xl md:text-4xl font-light tracking-tight">
          Kh√¥ng t√¨m th·∫•y trang
        </h1>
        
        {/* M√¥ t·∫£ */}
        <p className="mt-2 text-lg text-[var(--sub-text)]">
          R·∫•t ti·∫øc, ch√∫ng t√¥i kh√¥ng th·ªÉ t√¨m th·∫•y trang b·∫°n y√™u c·∫ßu.
        </p>

        <Link
          href="/"
          className="mt-10 py-3 px-8 bg-transparent 
                     border border-[var(--foreground)] 
                     text-[var(--foreground)] hover:text-[var(--background)]
                     hover:bg-[var(--foreground)]
                     transition-colors duration-300 cursor-pointer"
        >
          Quay v·ªÅ Trang ch·ªß
        </Link>
      </div>
    </Container>
  );
}
```

## File: src/components/admin/PortfolioGridEditor.tsx
```typescript
// src/components/admin/PortfolioGridEditor.tsx
'use client';

import { useState } from 'react';
import Image, { StaticImageData } from 'next/image';
import { toast } from 'sonner';
// Th√™m GripVertical v√†o import
import { Save, RotateCcw, Edit3, Check, MousePointerClick, GripVertical } from 'lucide-react';
import { ProjectData } from '@/data/projects-master-data';
import { updatePortfolioLayout, ProjectGridUpdate } from '@/lib/actions';
//import { supabase } from '../../../lib/supabase';
import { createBrowserClient } from '@supabase/ssr';

// --- IMPORT DND KIT ---
import {
  DndContext,
  closestCenter,
  KeyboardSensor,
  PointerSensor,
  useSensor,
  useSensors,
  DragEndEvent
} from '@dnd-kit/core';
import {
  arrayMove,
  SortableContext,
  rectSortingStrategy
} from '@dnd-kit/sortable';
import { SortableProjectItem } from './SortableProjectItem'; // Component v·ª´a t·∫°o ·ªü B1



interface EditorProps {
  initialProjects: ProjectData[];
}

export default function PortfolioGridEditor({ initialProjects }: EditorProps) {
  const [projects, setProjects] = useState<ProjectData[]>(initialProjects);
  const [supabase] = useState(() => createBrowserClient(
      process.env.NEXT_PUBLIC_SUPABASE_URL!,
      process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
    ));
  const [isEditing, setIsEditing] = useState(false);
  const [isSaving, setIsSaving] = useState(false);
  // C·∫•u h√¨nh c·∫£m bi·∫øn k√©o th·∫£
  // activationConstraint: distance 5px -> Ph·∫£i k√©o 5px m·ªõi t√≠nh l√† drag (tr√°nh click nh·∫ßm n√∫t resize)
  const sensors = useSensors(
    useSensor(PointerSensor, {
      activationConstraint: {
        distance: 5,
      },
    }),
    useSensor(KeyboardSensor)
  );

  const getImageSrc = (img: string | StaticImageData) => {
    return typeof img === 'string' ? img : img.src;
  };

  // --- LOGIC X·ª¨ L√ù KHI TH·∫¢ CHU·ªòT (DRAG END) ---
  const handleDragEnd = (event: DragEndEvent) => {
    const { active, over } = event;

    if (active.id !== over?.id) {
      setProjects((items) => {
        const oldIndex = items.findIndex((i) => i.id === active.id);
        const newIndex = items.findIndex((i) => i.id === over?.id);
        
        // H√†m n√†y c·ªßa dnd-kit s·∫Ω ƒë·ªïi ch·ªó ph·∫ßn t·ª≠ trong m·∫£ng
        return arrayMove(items, oldIndex, newIndex);
      });
    }
  };

  // Logic Resize (Gi·ªØ nguy√™n)
  const handleResize = (id: number, type: 'col' | 'row', delta: number) => {
    setProjects(prev => prev.map(p => {
      if (p.id !== id) return p;
      let newVal = 0;
      if (type === 'col') {
        newVal = Math.max(1, Math.min(3, (p.colSpan || 1) + delta));
        return { ...p, colSpan: newVal };
      } else {
        newVal = Math.max(1, Math.min(4, (p.rowSpan || 1) + delta));
        return { ...p, rowSpan: newVal };
      }
    }));
  };

  // Logic L∆∞u
  const handleSave = async () => {
    setIsSaving(true);
    try {
      const { data: { session } } = await supabase.auth.getSession();
      
      if (!session) {
        toast.error('Kh√¥ng t√¨m th·∫•y phi√™n ƒëƒÉng nh·∫≠p. Vui l√≤ng F5.');
        return;
      }      
      // Chu·∫©n b·ªã d·ªØ li·ªáu (Bao g·ªìm c·∫£ displayOrder m·ªõi d·ª±a tr√™n v·ªã tr√≠ index)
      const updates: ProjectGridUpdate[] = projects.map((p, index) => ({
        id: p.id,
        colSpan: p.colSpan || 1,
        rowSpan: p.rowSpan || 1,
        displayOrder: index + 1 // Quan tr·ªçng: Index trong m·∫£ng state ch√≠nh l√† th·ª© t·ª± hi·ªÉn th·ªã
      }));

      const res = await updatePortfolioLayout(session.access_token, updates);

      if (res.success) {
        toast.success('ƒê√£ l∆∞u b·ªë c·ª•c & th·ª© t·ª± th√†nh c√¥ng!');
        setIsEditing(false);
      } else {
        toast.error(`L·ªói: ${res.error}`);
      }
    } catch (err) {
      const error = err as Error;
      toast.error(`L·ªói k·∫øt n·ªëi: ${error.message}`);
    } finally {
      setIsSaving(false);
    }
  };

  const handleReset = () => {
    if (confirm('Kh√¥i ph·ª•c l·∫°i ban ƒë·∫ßu?')) setProjects(initialProjects);
  };

  return (
    <div className="space-y-6">
      {/* TOOLBAR */}
      <div className="sticky top-4 z-50 bg-[var(--admin-card)] border border-[var(--admin-border)] p-4 rounded-xl shadow-lg flex flex-col sm:flex-row justify-between items-center gap-4">
        <div className="flex items-center gap-3">
            <div className={`p-2 rounded-lg ${isEditing ? 'bg-indigo-100 text-indigo-600' : 'bg-green-100 text-green-600'}`}>
                {isEditing ? <Edit3 size={20} /> : <Check size={20} />}
            </div>
            <div>
                <h3 className="font-bold text-[var(--admin-fg)]">
                    {isEditing ? 'Ch·∫ø ƒë·ªô Ch·ªânh s·ª≠a' : 'Ch·∫ø ƒë·ªô Xem tr∆∞·ªõc'}
                </h3>
                <p className="text-xs text-[var(--admin-sub)]">
                    {isEditing ? 'K√©o th·∫£ ƒë·ªÉ s·∫Øp x·∫øp. B·∫•m +/- ƒë·ªÉ ch·ªânh size.' : 'Giao di·ªán hi·ªÉn th·ªã gi·ªëng h·ªát trang ch·ªß.'}
                </p>
            </div>
        </div>

        <div className="flex gap-2">
          {!isEditing ? (
            <button
              onClick={() => setIsEditing(true)}
              className="px-6 py-2 bg-[var(--admin-primary)] text-[var(--admin-bg)] 
              rounded-lg text-sm font-medium hover:opacity-90 flex items-center gap-2 shadow-md cursor-pointer"
            >
              <MousePointerClick size={18} /> B·∫Øt ƒë·∫ßu s·ª≠a
            </button>
          ) : (
            <>
              <button onClick={handleReset} className="px-3 py-2 text-[var(--admin-sub)] hover:bg-[var(--admin-hover)] rounded-lg border border-transparent hover:border-[var(--admin-border)] cursor-pointer"><RotateCcw size={18} /></button>
              <button onClick={() => setIsEditing(false)} className="px-4 py-2 border border-[var(--admin-border)] text-[var(--admin-fg)] rounded-lg text-sm cursor-pointer">H·ªßy</button>
              <button onClick={handleSave} disabled={isSaving} className="px-6 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 shadow-md flex items-center gap-2 cursor-pointer">
                {isSaving ? '...' : <><Save size={18} /> L∆∞u thay ƒë·ªïi</>}
              </button>
            </>
          )}
        </div>
      </div>

      {/* GRID AREA */}
      <div className="border-2 border-dashed border-[var(--admin-border)] p-4 md:p-8 rounded-2xl bg-[var(--background)] min-h-[500px]">
        
        {/* --- DND CONTEXT WRAPPER --- */}
        <DndContext sensors={sensors} collisionDetection={closestCenter} onDragEnd={handleDragEnd}>
          <SortableContext items={projects.map(p => p.id)} strategy={rectSortingStrategy}>
            
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4 auto-rows-[300px] md:auto-rows-[400px]">
              {projects.map((project) => (
                
                // S·ª≠ d·ª•ng Component Sortable Item
                <SortableProjectItem 
                    key={project.id} 
                    id={project.id} 
                    colSpan={project.colSpan || 1} 
                    rowSpan={project.rowSpan || 1}
                >
                  <div className={`relative w-full h-full rounded-lg overflow-hidden transition-all duration-300 ${isEditing ? 'ring-2 ring-offset-2 ring-indigo-500 z-10' : 'border border-transparent'}`}>
                    
                    {/* H√¨nh ·∫£nh */}
                    <div className="relative w-full h-full bg-gray-200 dark:bg-gray-800">
                      {project.image ? (
                          <Image
                          src={getImageSrc(project.image)}
                          alt={project.title}
                          fill
                          className={`object-cover transition-opacity ${isEditing ? 'opacity-40 grayscale' : 'opacity-100'}`}
                          />
                      ) : (
                          <div className="flex items-center justify-center h-full text-xs text-gray-500">No Image</div>
                      )}
                    </div>

                    {/* View Mode Overlay */}
                    {!isEditing && (
                      <div className="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col justify-end p-6 pointer-events-none">
                          <h3 className="text-xl font-bold text-white line-clamp-2">{project.title}</h3>
                      </div>
                    )}

                    {/* EDIT MODE CONTROLS */}
                    {isEditing && (
                      <div className="absolute inset-0 flex flex-col">
                         {/* --- N√öT K√âO TH·∫¢ (DRAG HANDLE) --- */}
                         {/* Class cursor-grab l√† quan tr·ªçng ƒë·ªÉ b√°o hi·ªáu c√≥ th·ªÉ k√©o */}
                         <div className="absolute top-2 right-2 p-2 bg-white text-black rounded cursor-grab active:cursor-grabbing shadow-lg hover:bg-gray-100 z-50">
                            <GripVertical size={20} />
                         </div>

                         {/* Info Badge */}
                         <div className="absolute top-2 left-2 bg-white/90 text-black px-2 py-1 rounded text-[10px] font-mono font-bold shadow-sm border border-gray-200">
                            W:{project.colSpan || 1} | H:{project.rowSpan || 1}
                         </div>

                         {/* Resize Controls (Kh√¥ng b·ªã ·∫£nh h∆∞·ªüng b·ªüi drag) */}
                         <div className="flex-1 flex items-center justify-center gap-4" onPointerDown={(e) => e.stopPropagation()}> 
                            {/* e.stopPropagation() ƒë·ªÉ ngƒÉn vi·ªác b·∫•m n√∫t +/- b·ªã hi·ªÉu nh·∫ßm l√† b·∫Øt ƒë·∫ßu k√©o */}
                            
                            {/* Width Control */}
                            <div className="flex flex-col items-center gap-1 bg-white/10 backdrop-blur-md p-2 rounded-lg border border-white/20">
                               <span className="text-[10px] font-bold text-white uppercase">R·ªông</span>
                               <div className="flex gap-1">
                                  <button onClick={() => handleResize(project.id, 'col', -1)} disabled={(project.colSpan || 1) <= 1} className="w-8 h-8 bg-white text-black rounded font-bold hover:bg-indigo-50">-</button>
                                  <button onClick={() => handleResize(project.id, 'col', 1)} disabled={(project.colSpan || 1) >= 3} className="w-8 h-8 bg-white text-black rounded font-bold hover:bg-indigo-50">+</button>
                               </div>
                            </div>
                            {/* Height Control */}
                            <div className="flex flex-col items-center gap-1 bg-white/10 backdrop-blur-md p-2 rounded-lg border border-white/20">
                               <span className="text-[10px] font-bold text-white uppercase">Cao</span>
                               <div className="flex gap-1">
                                  <button onClick={() => handleResize(project.id, 'row', -1)} disabled={(project.rowSpan || 1) <= 1} className="w-8 h-8 bg-white text-black rounded font-bold hover:bg-indigo-50">-</button>
                                  <button onClick={() => handleResize(project.id, 'row', 1)} disabled={(project.rowSpan || 1) >= 4} className="w-8 h-8 bg-white text-black rounded font-bold hover:bg-indigo-50">+</button>
                               </div>
                            </div>
                         </div>
                         
                         <div className="absolute bottom-2 inset-x-0 text-center text-[10px] text-white/70 font-mono pointer-events-none">
                            {project.title}
                         </div>
                      </div>
                    )}
                  </div>
                </SortableProjectItem>
              ))}
            </div>

          </SortableContext>
        </DndContext>
      </div>
    </div>
  );
}
```

## File: src/components/admin/ProjectForm.tsx
```typescript
// src/components/admin/ProjectForm.tsx
'use client';

import React, { useEffect, useState } from 'react';
import { useRouter } from 'next/navigation';
import Image from 'next/image';
import { createBrowserClient } from '@supabase/ssr'; 
import { compressImage } from '@/lib/image-utils';
import { toast } from 'sonner';
import { 
  ArrowLeft, Upload, X, Save, Loader2, ImagePlus, Plus, Type, AlignLeft, Trash2 
} from 'lucide-react';
import SelectBox from '@/components/ui/SelectBox';
import { Layers } from 'lucide-react'; // Icon cho ƒë·∫πp

export type FormMode = 'create' | 'edit';

interface Category {
  category_id: number;
  name: string;
}

interface CreditItem {
  label: string;
  value: string;
}

export interface BlockDB {
  type: 'heading' | 'paragraph' | 'imageRow';
  content?: string;
  images?: string[]; 
}

interface ContentBlockState {
  id: string;
  type: 'heading' | 'paragraph' | 'imageRow';
  content: string;
  existingImages: string[]; 
  newFiles: File[];         
  previews: string[];       
}

export interface ProjectInitialData {
  id?: number;
  title: string;
  client_name: string;
  description: string;
  category_id: string; 
  is_featured: boolean;
  thumbnail_url: string;
  credits: CreditItem[];
  content: BlockDB[];
}

interface ProjectFormProps {
  mode: FormMode;
  initialData?: ProjectInitialData;
}

// --- 2. COMPONENT CH√çNH ---

export default function ProjectForm({ mode, initialData }: ProjectFormProps) {
  // 2. KH·ªûI T·∫†O CLIENT SUPABASE C√ì COOKIE (ƒê·ªÉ Upload ƒë∆∞·ª£c)
  const [supabase] = useState(() => createBrowserClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
  ));

  const router = useRouter();
  const [isLoading, setIsLoading] = useState(false);
  const [categories, setCategories] = useState<Category[]>([]);

  // State Form
  const [formData, setFormData] = useState({
    title: '',
    client_name: '',
    description: '',
    category_id: '',
    is_featured: false,
  });

  const [thumbnailFile, setThumbnailFile] = useState<File | null>(null);
  const [thumbnailPreview, setThumbnailPreview] = useState<string | null>(null);
  const fillSampleCredits = () => {
    setCredits([
      { label: 'Producer', value: 'Victoria Nguyen' },
      { label: 'Art Director', value: 'Marcus O‚ÄôNeil' },
      { label: 'Photographer', value: 'Lucas Graham' },
      { label: 'Model', value: 'Sophia Miller, Tran Tung Anh, Jessica Liu, Kenji' },
      { label: 'Stylist', value: 'Chloe Anderson' },
      { label: 'Stylist Assistant', value: 'Jamie Le' },
      { label: 'Lighting', value: 'Mike Wilson, Dat Ho, Alex Chen' },
      { label: 'MUA', value: 'Samantha Fox, Tu Anh' },
      { label: 'Set Designer', value: 'Jordan Smith, Harry Le' },
      { label: 'Accessories', value: 'Olivia Brown' },
      { label: 'Support', value: 'Kevin Vo' },
      { label: 'Location', value: 'Oni Studio' },
    ]);
  };
  const [credits, setCredits] = useState<CreditItem[]>([{ label: 'Photographer', value: '' }]);
  const [blocks, setBlocks] = useState<ContentBlockState[]>([]);

  // --- 3. KH·ªûI T·∫†O D·ªÆ LI·ªÜU ---
  useEffect(() => {
    const fetchCategories = async () => {
      const { data } = await supabase
        .from('portfolio_categories')
        .select('category_id, name')
        .eq('is_active', true)
        .order('display_order');
      if (data) setCategories(data as unknown as Category[]);
    };
    fetchCategories();

    if (mode === 'edit' && initialData) {
      setFormData({
        title: initialData.title || '',
        client_name: initialData.client_name || '',
        description: initialData.description || '',
        category_id: initialData.category_id || '',
        is_featured: initialData.is_featured || false,
      });

      if (initialData.thumbnail_url) {
        setThumbnailPreview(initialData.thumbnail_url);
      }

      if (initialData.credits?.length > 0) {
        setCredits(initialData.credits);
      }

      if (initialData.content?.length > 0) {
        const mappedBlocks: ContentBlockState[] = initialData.content.map((b) => ({
          id: Math.random().toString(36).substr(2, 9),
          type: b.type,
          content: b.content || '',
          existingImages: b.images || [],
          newFiles: [],
          previews: []
        }));
        setBlocks(mappedBlocks);
      }
    }
  }, [mode, initialData, supabase]);

  // --- 4. HELPER FUNCTIONS ---

  const addCredit = () => setCredits([...credits, { label: '', value: '' }]);
  const removeCredit = (index: number) => setCredits(credits.filter((_, i) => i !== index));
  const updateCredit = (index: number, field: keyof CreditItem, value: string) => {
    const newCredits = [...credits];
    newCredits[index][field] = value;
    setCredits(newCredits);
  };

  const addBlock = (type: ContentBlockState['type']) => {
    setBlocks([
      ...blocks, 
      { id: Math.random().toString(36).substr(2, 9), type, content: '', existingImages: [], newFiles: [], previews: [] }
    ]);
  };
  
  const removeBlock = (id: string) => setBlocks(blocks.filter(b => b.id !== id));
  
  const updateBlockContent = (id: string, content: string) => {
    setBlocks(blocks.map(b => b.id === id ? { ...b, content } : b));
  };

  const handleBlockImagesChange = (id: string, files: FileList | null) => {
    if (!files) return;
    const newFilesList = Array.from(files);
    const newPreviewsList = newFilesList.map(f => URL.createObjectURL(f));

    setBlocks(blocks.map(b => {
      if (b.id === id) {
        return {
          ...b,
          newFiles: [...b.newFiles, ...newFilesList],
          previews: [...b.previews, ...newPreviewsList]
        };
      }
      return b;
    }));
  };

  const removeImageFromBlock = (blockId: string, imgIndex: number, isExisting: boolean) => {
    setBlocks(blocks.map(b => {
      if (b.id !== blockId) return b;

      if (isExisting) {
        return { ...b, existingImages: b.existingImages.filter((_, i) => i !== imgIndex) };
      } else {
        const updatedFiles = b.newFiles.filter((_, i) => i !== imgIndex);
        const updatedPreviews = b.previews.filter((_, i) => i !== imgIndex);
        return { ...b, newFiles: updatedFiles, previews: updatedPreviews };
      }
    }));
  };

  // H√ÄM UPLOAD (Gi·ªù s·∫Ω ho·∫°t ƒë·ªông v√¨ client 'supabase' ƒë√£ c√≥ Auth Token)
  const uploadImage = async (file: File, folder: string): Promise<string | null> => {
    try {
      const compressedBlob = await compressImage(file);
      const compressedFile = new File([compressedBlob], file.name, { type: 'image/webp' });
      // Th√™m timestamp ƒë·ªÉ tr√°nh tr√πng t√™n
      const fileName = `${folder}/${Date.now()}-${Math.random().toString(36).substring(7)}.webp`;
      
      const { error } = await supabase.storage.from('portfolio-images').upload(fileName, compressedFile);
      if (error) throw error;
      
      const { data } = supabase.storage.from('portfolio-images').getPublicUrl(fileName);
      return data.publicUrl;
    } catch (error) {
      console.error('Upload err:', error);
      return null;
    }
  };

  const generateSlug = (str: string) => {
    return str.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace(/[ƒëƒê]/g, 'd').replace(/[^a-z0-9\s-]/g, '').trim().replace(/\s+/g, '-') + '-' + Date.now();
  };

  // --- 5. SUBMIT FORM ---
  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!formData.title || !formData.category_id || (!thumbnailFile && !thumbnailPreview)) {
      toast.warning('Vui l√≤ng ƒëi·ªÅn t√™n, danh m·ª•c v√† ·∫£nh ƒë·∫°i di·ªán.');
      return;
    }

    setIsLoading(true);
    const toastId = toast.loading('ƒêang x·ª≠ l√Ω d·ªØ li·ªáu...');

    try {
      // A. Upload Thumbnail
      let finalThumbnailUrl = thumbnailPreview; 
      if (thumbnailFile) {
        const url = await uploadImage(thumbnailFile, 'thumbnails');
        if (!url) throw new Error('L·ªói upload thumbnail');
        finalThumbnailUrl = url;
      }

      // B. X·ª≠ l√Ω Content Blocks
      const finalContent = await Promise.all(blocks.map(async (block) => {
        let imageUrls: string[] = [...block.existingImages];

        if (block.type === 'imageRow' && block.newFiles.length > 0) {
          const uploadPromises = block.newFiles.map(file => uploadImage(file, 'gallery'));
          const newUrls = (await Promise.all(uploadPromises)).filter((url): url is string => url !== null);
          imageUrls = [...imageUrls, ...newUrls];
        }

        return {
          type: block.type,
          content: block.content,
          images: imageUrls.length > 0 ? imageUrls : undefined
        };
      }));

      // C. Chu·∫©n b·ªã Payload
      const payload = {
        title: formData.title,
        client_name: formData.client_name,
        description: formData.description,
        category_id: parseInt(formData.category_id),
        is_featured: formData.is_featured,
        thumbnail_url: finalThumbnailUrl,
        credits: credits.filter(c => c.label && c.value), 
        content: finalContent,
        updated_at: new Date().toISOString(),
        ...(mode === 'create' ? { slug: generateSlug(formData.title) } : {}),
      };

      // D. Insert/Update
      if (mode === 'create') {
        const { data: { user } } = await supabase.auth.getUser();
        const { data: profile } = await supabase.from('users').select('user_id').eq('auth_id', user?.id).single();
        
        const { data, error } = await supabase
          .from('projects')
          .insert({ ...payload, created_by: profile?.user_id })
          .select('project_id')
          .single();
          
        if (error) throw error;
        toast.success('T·∫°o d·ª± √°n m·ªõi th√†nh c√¥ng!', { id: toastId });
        
        if (data) router.push(`/admin/projects/${data.project_id}`);

      } else {
        const { error } = await supabase
          .from('projects')
          .update(payload)
          .eq('project_id', initialData?.id);
          
        if (error) throw error;
        toast.success('C·∫≠p nh·∫≠t d·ª± √°n th√†nh c√¥ng!', { id: toastId });
        router.refresh();
      }

    } catch (error: unknown) {
      let msg = 'L·ªói kh√¥ng x√°c ƒë·ªãnh';
      if (error instanceof Error) msg = error.message;
      console.error(error);
      toast.error(`L·ªói: ${msg}`, { id: toastId });
    } finally {
      setIsLoading(false);
    }
  };

  // --- UI RENDER ---
  return (
    <div className="max-w-5xl mx-auto space-y-6 pb-20">
      <div className="flex items-center gap-4 mb-4">
        <button onClick={() => router.push('/admin/projects')} className="p-2 rounded-lg hover:bg-[var(--admin-hover)] text-[var(--admin-sub)] transition-colors">
          <ArrowLeft size={24} />
        </button>
        <div>
            <h1 className="text-2xl font-bold text-[var(--admin-fg)]">
            {mode === 'create' ? 'Th√™m D·ª± √°n M·ªõi' : 'Ch·ªânh s·ª≠a D·ª± √°n'}
            </h1>
            {mode === 'edit' && <p className="text-xs text-[var(--admin-sub)]">ID: {initialData?.id}</p>}
        </div>
      </div>

      <form onSubmit={handleSubmit} className="space-y-8">
        
        {/* INFO CARD */}
        <div className="p-6 bg-[var(--admin-card)] rounded-xl border border-[var(--admin-border)] shadow-sm space-y-6">
          <h2 className="text-lg font-semibold text-[var(--admin-fg)] border-b border-[var(--admin-border)] pb-4">Th√¥ng tin c∆° b·∫£n</h2>
          
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div className="space-y-2">
              <label className="text-sm font-medium text-[var(--admin-fg)]">T√™n D·ª± √°n <span className="text-red-500">*</span></label>
              <input required type="text" className="admin-input" value={formData.title} onChange={e => setFormData({...formData, title: e.target.value})} placeholder="VD: Lookbook Summer 2024"/>
            </div>
            <div className="space-y-2">
              <label className="text-sm font-medium text-[var(--admin-fg)]">Kh√°ch h√†ng</label>
              <input type="text" className="admin-input" value={formData.client_name} onChange={e => setFormData({...formData, client_name: e.target.value})} placeholder="VD: Vogue Vietnam"/>
            </div>
            <SelectBox
              label="Danh m·ª•c"
              required
              placeholder="-- Ch·ªçn danh m·ª•c d·ª± √°n --"
              value={formData.category_id}
              onChange={(val) => setFormData({ ...formData, category_id: val })}
              icon={<Layers size={18} className="text-[var(--admin-sub)]" />}
              options={categories.map(cat => ({
                label: cat.name,
                value: cat.category_id
              }))}
            />
            <div className="flex items-center space-x-3 mt-8">
              <input type="checkbox" id="is_featured" className="w-5 h-5 cursor-pointer accent-[var(--admin-primary)]" checked={formData.is_featured} onChange={e => setFormData({...formData, is_featured: e.target.checked})} />
              <label htmlFor="is_featured" className="text-sm font-medium text-[var(--admin-fg)] cursor-pointer">ƒê√°nh d·∫•u l√† <strong>N·ªïi b·∫≠t</strong></label>
            </div>
          </div>

          <div className="space-y-2">
            <label className="text-sm font-medium text-[var(--admin-fg)]">M√¥ t·∫£ ng·∫Øn</label>
            <textarea rows={3} className="admin-input" value={formData.description} onChange={e => setFormData({...formData, description: e.target.value})} placeholder="Gi·ªõi thi·ªáu s∆° l∆∞·ª£c v·ªÅ d·ª± √°n..."/>
          </div>
          <div className="space-y-2">
            <label className="text-sm font-medium text-[var(--admin-fg)]">·∫¢nh ƒë·∫°i di·ªán (Thumbnail) 
              <span className="text-red-500">*</span>
              </label>
            
            {/* CONTAINER CH√çNH */}
            {/* Logic: N·∫øu c√≥ thumbnailPreview th√¨ d√πng 'h-auto' (cao t·ª± do), ng∆∞·ª£c l·∫°i d√πng 'aspect-video' (c·ªë ƒë·ªãnh) */}
            <div className={`
              relative w-full md:w-1/2 bg-[var(--admin-bg)] border-2 border-dashed border-[var(--admin-border)] rounded-lg overflow-hidden group hover:border-[var(--admin-primary)] transition-all duration-300
              ${thumbnailPreview ? 'h-auto' : 'aspect-video'}
            `}>
              
              {/* INPUT FILE (Lu√¥n ph·ªß l√™n tr√™n c√πng z-20 ƒë·ªÉ click ƒë∆∞·ª£c ·ªü m·ªçi ch·ªó) */}
              <input 
                type="file" 
                accept="image/*" 
                className="absolute inset-0 w-full h-full opacity-0 z-20 cursor-pointer" 
                onChange={(e) => {
                  if(e.target.files?.[0]) {
                    setThumbnailFile(e.target.files[0]);
                    setThumbnailPreview(URL.createObjectURL(e.target.files[0]));
                  }
                }} 
              />

              {thumbnailPreview ? (
                <div className="relative w-full">
                  {/* D√πng th·∫ª <img> th∆∞·ªùng v·ªõi w-full h-auto ƒë·ªÉ container t·ª± gi√£n theo ·∫£nh */}
                  <Image 
                    src={thumbnailPreview} 
                    alt="Thumb" 
                    width={0} 
                    height={0} 
                    sizes="100vw"
                    className="w-full h-auto block" // Gi·ªØ nguy√™n class n√†y ƒë·ªÉ n√≥ co gi√£n
                    unoptimized // QUAN TR·ªåNG: B·∫Øt bu·ªôc c√≥ d√≤ng n√†y
                  />
                  
                  {/* Overlay hi·ªÉn th·ªã khi hover */}
                  <div className="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity z-10">
                    <p className="text-white text-sm font-medium flex items-center gap-2">
                      <Upload size={16}/> Thay ·∫£nh kh√°c
                    </p>
                  </div>
                </div>
              ) : (
                /* Giao di·ªán khi ch∆∞a c√≥ ·∫£nh (CƒÉn gi·ªØa trong khung aspect-video) */
                <div className="flex flex-col items-center justify-center h-full text-[var(--admin-sub)] group-hover:text-[var(--admin-primary)] transition-colors">
                  <ImagePlus size={32} className="mb-2" />
                  <span className="text-sm">B·∫•m ƒë·ªÉ ch·ªçn ·∫£nh</span>
                </div>
              )}
            </div>
          </div>
        </div>

        {/* CREDITS CARD */}
        <div className="p-6 bg-[var(--admin-card)] rounded-xl border border-[var(--admin-border)] shadow-sm space-y-4">
          <div className="flex justify-between items-center border-b border-[var(--admin-border)] pb-4">
          <h2 className="text-lg font-semibold text-[var(--admin-fg)]">Credits</h2>
          <div className="flex gap-2">
              {/* N√∫t ƒëi·ªÅn m·∫´u */}
              <button type="button" onClick={fillSampleCredits} className="cursor-pointer text-sm text-[var(--admin-sub)] hover:text-white px-3 py-1.5 rounded-lg border border-[var(--admin-border)] hover:bg-[var(--admin-hover)] transition-colors">
                ƒêi·ªÅn m·∫´u
              </button>

              {/* N√∫t th√™m d√≤ng c≈© */}
              <button type="button" onClick={addCredit} className="cursor-pointer text-sm text-[var(--admin-primary)] hover:bg-[var(--admin-hover)] px-3 py-1.5 rounded-lg flex items-center gap-1 transition-colors">
                  <Plus size={16}/> Th√™m d√≤ng
              </button>
          </div>
        </div>
          <div className="space-y-3">
            {credits.map((item, idx) => (
              <div key={idx} className="flex gap-4 items-center">
                <input placeholder="Vai tr√≤ (VD: Photo)" className="admin-input w-1/3" value={item.label} onChange={e => updateCredit(idx, 'label', e.target.value)} />
                <input placeholder="T√™n (VD: Dang Tran)" className="admin-input w-1/2" value={item.value} onChange={e => updateCredit(idx, 'value', e.target.value)} />
                <button type="button" onClick={() => removeCredit(idx)} className="text-red-400 cursor-pointer hover:text-red-600 p-2 hover:bg-red-50 rounded-lg transition-colors"><Trash2 size={18} /></button>
              </div>
            ))}
          </div>
        </div>

        {/* CONTENT BUILDER */}
        <div className="p-6 bg-[var(--admin-card)] rounded-xl border border-[var(--admin-border)] shadow-sm space-y-6">
          <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center border-b border-[var(--admin-border)] pb-4 gap-4">
            <h2 className="text-lg font-semibold text-[var(--admin-fg)]">N·ªôi dung b√†i vi·∫øt</h2>
            <div className="flex gap-2">
              <button type="button" onClick={() => addBlock('heading')} className="btn-tool cursor-pointer"><Type size={16}/> Ti√™u ƒë·ªÅ</button>
              <button type="button" onClick={() => addBlock('paragraph')} className="btn-tool cursor-pointer"><AlignLeft size={16}/> ƒêo·∫°n vƒÉn</button>
              <button type="button" onClick={() => addBlock('imageRow')} className="btn-tool cursor-pointer"><ImagePlus size={16}/> H√†ng ·∫£nh</button>
            </div>
          </div>

          <div className="space-y-6 min-h-[200px] bg-[var(--admin-bg)] p-4 rounded-lg border border-[var(--admin-border)]">
             {blocks.length === 0 && (
                <div className="flex flex-col items-center justify-center py-10 text-[var(--admin-sub)] opacity-60">
                    <AlignLeft size={48} className="mb-2" />
                    <p>Ch∆∞a c√≥ n·ªôi dung.</p>
                </div>
             )}
             
             {blocks.map((block, index) => (
               <div key={block.id} className="relative group bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-lg p-6 shadow-sm transition-all hover:shadow-md">
                 <div className="absolute -left-3 -top-3 bg-[var(--admin-fg)] text-[var(--admin-bg)] text-[10px] font-bold px-2 py-1 rounded shadow uppercase tracking-wider">
                   {index + 1}. {block.type}
                 </div>
                 
                 <button type="button" onClick={() => removeBlock(block.id)} className="absolute top-2 right-2 text-[var(--admin-sub)] hover:text-red-500 hover:bg-[var(--admin-bg)] p-1.5 rounded-lg transition-all opacity-0 group-hover:opacity-100">
                    <X size={18}/>
                 </button>

                 <div className="mt-2">
                    {block.type === 'heading' && (
                        <input type="text" placeholder="Nh·∫≠p ti√™u ƒë·ªÅ section..." className="w-full text-xl font-bold bg-transparent border-b border-[var(--admin-border)] focus:border-[var(--admin-primary)] outline-none pb-2 text-[var(--admin-fg)]" value={block.content} onChange={e => updateBlockContent(block.id, e.target.value)} />
                    )}
                    
                    {block.type === 'paragraph' && (
                        <textarea rows={4} placeholder="Nh·∫≠p n·ªôi dung ƒëo·∫°n vƒÉn..." className="w-full bg-[var(--admin-bg)] rounded p-3 resize-y outline-none text-[var(--admin-fg)] border border-transparent focus:border-[var(--admin-border)] transition-colors" value={block.content} onChange={e => updateBlockContent(block.id, e.target.value)} />
                    )}
                    
                    {block.type === 'imageRow' && (
                    <div>
                        <div className="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-5 gap-4">
                            {/* ·∫¢NH C≈® */}
                            {block.existingImages.map((src, i) => (
                                <div key={`exist-${i}`} className="relative aspect-square rounded-lg overflow-hidden border-2 border-green-500/50 group/img">
                                    <Image src={src} alt="exist" fill className="object-cover" />
                                    <div className="absolute inset-0 bg-black/0 group-hover/img:bg-black/20 transition-colors" />
                                    <button type="button" onClick={() => removeImageFromBlock(block.id, i, true)} className="absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover/img:opacity-100 transition-opacity shadow-sm">
                                        <X size={12}/>
                                    </button>
                                </div>
                            ))}
                            {/* ·∫¢NH M·ªöI */}
                            {block.previews.map((src, i) => (
                                <div key={`new-${i}`} className="relative aspect-square rounded-lg overflow-hidden border-2 border-blue-500/50 group/img">
                                    <Image src={src} alt="new" fill className="object-cover" />
                                    <div className="absolute inset-0 bg-black/0 group-hover/img:bg-black/20 transition-colors" />
                                    <button type="button" onClick={() => removeImageFromBlock(block.id, i, false)} className="absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover/img:opacity-100 transition-opacity shadow-sm">
                                        <X size={12}/>
                                    </button>
                                </div>
                            ))}
                            <label className="flex flex-col items-center justify-center aspect-square border-2 border-dashed border-[var(--admin-border)] rounded-lg hover:bg-[var(--admin-hover)] hover:border-[var(--admin-primary)] cursor-pointer transition-all text-[var(--admin-sub)] hover:text-[var(--admin-primary)]">
                                <Upload size={24} className="mb-1"/>
                                <span className="text-xs font-medium">Th√™m ·∫£nh</span>
                                <input type="file" multiple accept="image/*" className="hidden" onChange={e => handleBlockImagesChange(block.id, e.target.files)} />
                            </label>
                        </div>
                    </div>
                    )}
                 </div>
               </div>
             ))}
          </div>
        </div>

        <div className="flex justify-end pt-6 border-t border-[var(--admin-border)] sticky bottom-0 bg-[var(--admin-bg)] py-4 z-20">
          <button type="submit" disabled={isLoading} className="flex items-center gap-2 px-8 py-3 bg-[var(--admin-primary)] text-[var(--admin-primary-fg)] rounded-lg hover:opacity-90 shadow-lg shadow-indigo-500/30 font-medium disabled:opacity-70 transition-all transform hover:-translate-y-0.5 cursor-pointer">
            {isLoading ? <Loader2 className="animate-spin" /> : <Save size={20}/>} 
            {mode === 'create' ? 'L∆∞u & T·∫°o m·ªõi' : 'C·∫≠p nh·∫≠t thay ƒë·ªïi'}
          </button>
        </div>
      </form>

      <style jsx global>{`
        .admin-input { width: 100%; padding: 0.75rem; background-color: var(--admin-bg); border: 1px solid var(--admin-border); border-radius: 0.5rem; outline: none; color: var(--admin-fg); transition: all 0.2s; }
        .admin-input:focus { border-color: var(--admin-primary); ring: 2px solid var(--admin-primary); }
        .btn-tool { display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background-color: var(--admin-bg); border: 1px solid var(--admin-border); border-radius: 0.5rem; font-size: 0.875rem; color: var(--admin-fg); transition: all 0.2s; font-weight: 500; }
        .btn-tool:hover { background-color: var(--admin-hover); border-color: var(--admin-primary); color: var(--admin-primary); transform: translateY(-1px); box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
      `}</style>
    </div>
  );
}
```

## File: src/components/Footer.tsx
```typescript
'use client'; // B·∫Øt bu·ªôc v√¨ d√πng hook client-side

import { useEffect, useRef, useState } from 'react';

export default function Footer() {
  const footerRef = useRef<HTMLDivElement>(null);
  const [visible, setVisible] = useState(false);

  useEffect(() => {
    const footer = footerRef.current;
    if (!footer) return;

    const observer = new IntersectionObserver(
      (entries) => {
        const [entry] = entries;
        setVisible(entry.isIntersecting);
      },
      {
        root: null,
        threshold: 0.2, // hi·ªÉn th·ªã khi 20% footer v√†o khung nh√¨n
      }
    );

    observer.observe(footer);
    return () => observer.disconnect();
  }, []);

  return (
  <footer
      ref={footerRef}
      className={`w-full text-center py-8 transition-all duration-700 ease-out
        ${visible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'}
        
        // M·∫∑c ƒë·ªãnh (Light): n·ªÅn s√°ng, ch·ªØ t·ªëi
        bg-gray-100 text-gray-700 
        
        // Khi Dark: n·ªÅn ƒëen, ch·ªØ tr·∫Øng
        dark:bg-black dark:text-white 
      `}
    >
  ƒê. L√Ω Th∆∞·ªùng Ki·ªát, Ph∆∞·ªùng Ph√∫ Th·ªç, Qu·∫≠n 11, Th√†nh ph·ªë H·ªì Ch√≠ Minh, Vi·ªát Nam </footer>
  );
}
```

## File: src/components/HeroSection.tsx
```typescript
// src/components/HeroSection.tsx

'use client'; // 1. B·∫Øt bu·ªôc ƒë·ªÉ s·ª≠ d·ª•ng th∆∞ vi·ªán animation

import Image from 'next/image';
import Container from './Container';
import Background from '../assets/section_01/hero-background.webp';
import { TypeAnimation } from 'react-type-animation'; // 2. Import th∆∞ vi·ªán

export default function HeroSection() {
  return (
    <section
      id="welcome"
      className="relative h-screen flex items-center justify-center overflow-hidden text-white"
    >
      {/* L·ªõp ch·ª©a h√¨nh ·∫£nh n·ªÅn */}
      <div className="absolute inset-0 z-0">
        <Image
          src={Background}
          fill={true}
          quality={80}
          alt="Background"
          style={{ objectFit: 'cover' }}
          sizes="100vw"   // B√°o cho browser bi·∫øt n√≥ chi·∫øm full m√†n h√¨nh
        />
        <div className="absolute inset-0 bg-black/40"></div>
      </div>
      
      {/* L·ªõp ch·ª©a n·ªôi dung vƒÉn b·∫£n */}
      <Container className="relative z-10 text-center">
        {/* 3. Thay th·∫ø <h1> c≈© b·∫±ng TypeAnimation */}
        <TypeAnimation
          // 'sequence' l√† m·∫£ng ch·ª©a c√°c h√†nh ƒë·ªông
          // [Slogan 1, D·ª´ng 2 gi√¢y, Slogan 2, D·ª´ng 2 gi√¢y, Slogan 3, D·ª´ng...]
          sequence={[
            'Ch·∫°m v√†o v·∫ª ƒë·∫πp qua lƒÉng k√≠nh √°nh s√°ng.', // Slogan 1
            2000, // D·ª´ng 2 gi√¢y
            'Uy t√≠n tr·ªçn t·ª´ng kho·∫£nh kh·∫Øc.', // Slogan 2 (thay th·∫ø Slogan 1)
            2000, // D·ª´ng 2 gi√¢y
            'B·∫£o ch·ª©ng kho·∫£nh kh·∫Øc b·∫±ng uy t√≠n.', // Slogan 3
            2000, // D·ª´ng 2 gi√¢y
          ]}
          wrapper="h1" // 4. B·∫Øt bu·ªôc: Gi·ªØ th·∫ª <h1> ƒë·ªÉ ƒë·∫£m b·∫£o SEO
          cursor={true} // C√≥ hi·ªÉn th·ªã con tr·ªè g√µ ch·ªØ
          repeat={Infinity} // L·∫∑p l·∫°i v√¥ h·∫°n
          // 5. Sao ch√©p to√†n b·ªô class c·ªßa <h1> c≈©,
          //    NH∆ØNG X√ìA 'animate-fade-in-up'
          className="text-4xl md:text-6xl font-light tracking-tighter text-shadow-md text-gray-200"
        />

        {/* --- (PH∆Ø∆†NG √ÅN THAY TH·∫æ) ---
            N·∫øu b·∫°n ch·ªâ mu·ªën 1 slogan l·∫∑p l·∫°i (g√µ ra r·ªìi x√≥a ƒëi)
            H√£y d√πng ƒëo·∫°n code b√™n d∆∞·ªõi v√† x√≥a ƒëo·∫°n TypeAnimation ·ªü tr√™n */}

        {/* <TypeAnimation
          sequence={[
            'Uy t√≠n tr·ªçn t·ª´ng kho·∫£nh kh·∫Øc.',
            4000, // D·ª´ng 4 gi√¢y
            '',     // X√≥a ƒëi
            1000, // D·ª´ng 1 gi√¢y (tr∆∞·ªõc khi g√µ l·∫°i)
          ]}
          wrapper="h1"
          cursor={true}
          repeat={Infinity}
          className="text-4xl md:text-6xl font-light tracking-tighter text-shadow-md text-gray-200"
        /> */}
       
      </Container>

      {/* Ch·ªâ b√°o cu·ªôn xu·ªëng (Gi·ªØ nguy√™n) */}
      <div className="absolute bottom-8 left-1/2 -translate-x-1/2 z-10 animate-bounce">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          strokeWidth={1.5}
          stroke="currentColor"
          className="w-6 h-6 text-white/80"
        >
          <path
            strokeLinecap="round"
            strokeLinejoin="round"
            d="m19.5 8.25-7.5 7.5-7.5-7.5"
          />
        </svg>
      </div>
    </section>
  );
}
```

## File: src/components/LayoutWrapper.tsx
```typescript
// src/components/LayoutWrapper.tsx
'use client'; 
import { useState, useEffect, useRef, ReactNode } from 'react';
import Header from '@/components/Header'; 
import Footer from '@/components/Footer';
import { usePathname } from 'next/navigation';

interface LayoutWrapperProps {
  children: ReactNode;
}

export default function LayoutWrapper({ children }: LayoutWrapperProps) {
  // State ƒë·ªÉ quy·∫øt ƒë·ªãnh c√≥ hi·ªÉn th·ªã header fixed hay kh√¥ng
  const [showFixedHeader, setShowFixedHeader] = useState(false);
  // State ƒë·ªÉ l∆∞u chi·ªÅu cao c·ªßa header g·ªëc
  const [headerHeight, setHeaderHeight] = useState(0);
  // Ref ƒë·ªÉ tham chi·∫øu ƒë·∫øn header g·ªëc v√† ƒëo chi·ªÅu cao
  const originalHeaderRef = useRef<HTMLDivElement>(null);

  const pathname = usePathname();
  // Ki·ªÉm tra xem trang hi·ªán t·∫°i c√≥ ph·∫£i l√† Admin kh√¥ng
  const isAdminPage = pathname?.startsWith('/admin');
  const isAdminLoginPage = pathname === '/login';

  // 1. ƒêo chi·ªÅu cao c·ªßa header g·ªëc sau khi component mount
  useEffect(() => {
    if (originalHeaderRef.current) {
      setHeaderHeight(originalHeaderRef.current.offsetHeight);
    }
  }, []); // Ch·ªâ ch·∫°y 1 l·∫ßn

  // 2. Th√™m listener ƒë·ªÉ theo d√µi s·ª± ki·ªán cu·ªôn
  useEffect(() => {
    // Ch·ªâ ch·∫°y logic n·∫øu ƒë√£ ƒëo ƒë∆∞·ª£c chi·ªÅu cao (headerHeight > 0)
    if (headerHeight === 0) return;

    const handleScroll = () => {
      // N·∫øu v·ªã tr√≠ cu·ªôn (window.scrollY) l·ªõn h∆°n chi·ªÅu cao c·ªßa header
      // -> hi·ªÉn th·ªã header fixed
      if (window.scrollY > headerHeight) {
        setShowFixedHeader(true);
      } else {
        setShowFixedHeader(false);
      }
    };

    // ƒêƒÉng k√Ω s·ª± ki·ªán
    window.addEventListener('scroll', handleScroll);

    // H·ªßy ƒëƒÉng k√Ω s·ª± ki·ªán khi component unmount
    return () => {
      window.removeEventListener('scroll', handleScroll);
    };
  }, [headerHeight]); // Ch·∫°y l·∫°i m·ªói khi headerHeight thay ƒë·ªïi
  if (isAdminPage || isAdminLoginPage) {
    return <>{children}</>;
  }
  return (
    <>
      {/* 1. HEADER G·ªêC (Static) */}
      {/* z-20: N·∫±m d∆∞·ªõi header fixed (z-30) */}
      <div ref={originalHeaderRef} className="relative z-20">
        <Header />
      </div>

      {/* 2. HEADER M·ªöI (Fixed) */}
      {/* Header n√†y lu√¥n ·ªü ƒë√≥, nh∆∞ng ƒë∆∞·ª£c ·∫©n/hi·ªán b·∫±ng 'translate' */}
      <div
        className={`fixed top-0 left-0 right-0 z-50 bg-[var(--background)] 
                      text-[var(--foreground)] border-b border-[var(--foreground)]
                   transition-transform duration-300 ease-in-out 
                   ${
                     showFixedHeader ? 'translate-y-0' : '-translate-y-full'
                   }`}
      >
        <Header />
      </div>

      <main className="flex-1">{children}</main>

      <Footer />
    </>
  );
}
```

## File: src/components/ProjectNavigation.tsx
```typescript
// src/components/ProjectNavigation.tsx
import React from 'react';
import Link from 'next/link';
import styles from '../app/styles/ProjectArticle.module.css';

interface ProjectNavigationProps {
  prevProjectLink: string | null; // <-- ƒê·ªîI T√äN
  nextProjectLink: string | null; // <-- ƒê·ªîI T√äN
}

const ProjectNavigation: React.FC<ProjectNavigationProps> = ({
  prevProjectLink,
  nextProjectLink,
}) => {
  return (
    <div className={styles.projectNavigation}>
      {/* N√∫t Previous */}
      {prevProjectLink ? (
        // Tr∆∞·ªùng h·ª£p 1: C√≥ d·ª± √°n tr∆∞·ªõc -> D√πng link ƒë√£ build
        <Link href={prevProjectLink} className={styles.navLink}>
          &larr; D·ª± √°n tr∆∞·ªõc
        </Link>
      ) : (
        // Tr∆∞·ªùng h·ª£p 2: ƒê√£ ·ªü ƒë·∫ßu -> Link v·ªÅ Trang ch·ªß
        <Link href="/" className={styles.navLink} title="V·ªÅ trang ch·ªß">
          &larr; Trang ch·ªß
        </Link>
      )}

      {/* N√∫t Next */}
      {nextProjectLink ? (
        // Tr∆∞·ªùng h·ª£p 1: C√≥ d·ª± √°n ti·∫øp theo -> D√πng link ƒë√£ build
        <Link href={nextProjectLink} className={styles.navLink}>
          D·ª± √°n ti·∫øp theo &rarr;
        </Link>
      ) : (
        // Tr∆∞·ªùng h·ª£p 2: ƒê√£ ·ªü cu·ªëi -> Link v·ªÅ Trang ch·ªß
        <Link href="/" className={styles.navLink} title="V·ªÅ trang ch·ªß">
          Trang ch·ªß &rarr;
        </Link>
      )}
    </div>
  );
};

export default ProjectNavigation;
```

## File: src/components/ThemeToggle.tsx
```typescript
// src/components/ThemeToggle.tsx
'use client';

import { useState, useEffect } from 'react';
import { useTheme } from 'next-themes';

// Th√™m prop isAdmin
interface ThemeToggleProps {
  isAdmin?: boolean;
}

export default function ThemeToggle({ isAdmin = false }: ThemeToggleProps) {
  const [mounted, setMounted] = useState(false);
  const { theme, setTheme } = useTheme();

  useEffect(() => {
    setMounted(true);
  }, []);

  if (!mounted) {
    return <div className="w-9 h-9" />;
  }

  const toggleTheme = () => {
    setTheme(theme === 'light' ? 'dark' : 'light');
  };

  // C·∫•u h√¨nh m√†u s·∫Øc d·ª±a tr√™n isAdmin
  const buttonClass = isAdmin
    ? "p-1 cursor-pointer rounded-lg transition-all duration-200 bg-[var(--admin-primary)] hover:bg-[var(--admin-hover)] text-[var(--admin-primary-fg)] hover:text-[var(--admin-fg)] border border-transparent border-[var(--admin-border)]"
    : "rounded-md transition-colors cursor-pointer";

  const iconClass = isAdmin
    ? "w-5 h-5" // Icon Admin nh·ªè g·ªçn h∆°n ch√∫t
    : "w-6 h-6 p-1";

  // Icon Admin (D√πng Lucide cho ƒë·ªìng b·ªô v·ªõi Admin Layout)
  // Ho·∫∑c d√πng SVG c≈© nh∆∞ng ƒë·ªïi m√†u theo bi·∫øn admin
  return (
    <button
      onClick={toggleTheme}
      className={buttonClass}
      aria-label="Chuy·ªÉn ch·∫ø ƒë·ªô S√°ng/T·ªëi"
    >
      {theme === 'light' ? (
        // DARK MODE ICON
        isAdmin ? (
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={iconClass}><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>
        ) : (
          // Icon Client c≈© (M·∫∑t trƒÉng)
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" className="w-6 h-6 text-white bg-black/80 rounded-md p-1" fill="currentColor">
             <path d="M12 22C17.5228 22 22 17.5228 22 12C22 11.5373 21.3065 11.4608 21.0672 11.8568C19.9289 13.7406 17.8615 15 15.5 15C11.9101 15 9 12.0899 9 8.5C9 6.13845 10.2594 4.07105 12.1432 2.93276C12.5392 2.69347 12.4627 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"></path>
          </svg>
        )
      ) : (
        // LIGHT MODE ICON
        isAdmin ? (
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={iconClass}><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
        ) : (
           // Icon Client c≈© (M·∫∑t tr·ªùi)
           <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" className="w-6 h-6 text-black bg-white/80 rounded-md p-1">
              <path d="M12 17.75C10.8628 17.75 9.75106 17.4128 8.80547 16.781C7.85989 16.1491 7.1229 15.2511 6.6877 14.2004C6.25249 13.1498 6.13862 11.9936 6.36049 10.8782C6.58235 9.76284 7.12999 8.73829 7.93414 7.93414C8.73829 7.12999 9.76284 6.58235 10.8782 6.36049C11.9936 6.13862 13.1498 6.25249 14.2004 6.6877C15.2511 7.1229 16.1491 7.85989 16.781 8.80547C17.4128 9.75106 17.75 10.8628 17.75 12C17.7474 13.5242 17.1407 14.9852 16.0629 16.0629C14.9852 17.1407 13.5242 17.7474 12 17.75ZM12 7.75C11.1594 7.75 10.3377 7.99926 9.63883 8.46626C8.93992 8.93325 8.39519 9.59701 8.07351 10.3736C7.75184 11.1502 7.66768 12.0047 7.83167 12.8291C7.99565 13.6536 8.40043 14.4108 8.9948 15.0052C9.58917 15.5996 10.3464 16.0044 11.1709 16.1683C11.9953 16.3323 12.8498 16.2482 13.6264 15.9265C14.403 15.6048 15.0668 15.0601 15.5337 14.3612C16.0007 13.6623 16.25 12.8406 16.25 12C16.2474 10.8736 15.7987 9.79417 15.0023 8.99772C14.2058 8.20126 13.1264 7.75264 12 7.75Z"></path>
              <path d="M12 5C11.8019 4.99741 11.6126 4.91756 11.4725 4.77747C11.3324 4.63737 11.2526 4.44811 11.25 4.25V2.75C11.25 2.55109 11.329 2.36032 11.4697 2.21967C11.6103 2.07902 11.8011 2 12 2C12.1989 2 12.3897 2.07902 12.5303 2.21967C12.671 2.36032 12.75 2.55109 12.75 2.75V4.25C12.7474 4.44811 12.6676 4.63737 12.5275 4.77747C12.3874 4.91756 12.1981 4.99741 12 5Z"></path>
              <path d="M12 22C11.8019 21.9974 11.6126 21.9176 11.4725 21.7775C11.3324 21.6374 11.2526 21.4481 11.25 21.25V19.75C11.25 19.5511 11.329 19.3603 11.4697 19.2197C11.6103 19.079 11.8011 19 12 19C12.1989 19 12.3897 19.079 12.5303 19.2197C12.671 19.3603 12.75 19.5511 12.75 19.75V21.25C12.7474 21.4481 12.6676 21.6374 12.5275 21.7775C12.3874 21.9176 12.1981 21.9974 12 22Z"></path>
              <path d="M21.25 12.75H19.75C19.5511 12.75 19.3603 12.671 19.2197 12.5303C19.079 12.3897 19 12.1989 19 12C19 11.8011 19.079 11.6103 19.2197 11.4697C19.3603 11.329 19.5511 11.25 19.75 11.25H21.25C21.4489 11.25 21.6397 11.329 21.7803 11.4697C21.921 11.6103 22 11.8011 22 12C22 12.1989 21.921 12.3897 21.7803 12.5303C21.6397 12.671 21.4489 12.75 21.25 12.75Z"></path>
              <path d="M4.25 12.75H2.75C2.55109 12.75 2.36032 12.671 2.21967 12.5303C2.07902 12.3897 2 12.1989 2 12C2 11.8011 2.07902 11.6103 2.21967 11.4697C2.36032 11.329 2.55109 11.25 2.75 11.25H4.25C4.44891 11.25 4.63968 11.329 4.78033 11.4697C4.92098 11.6103 5 11.8011 5 12C5 12.1989 4.92098 12.3897 4.78033 12.5303C4.63968 12.671 4.44891 12.75 4.25 12.75Z"></path>
              <path d="M6.50001 7.24995C6.30707 7.2352 6.12758 7.14545 6.00001 6.99995L4.91001 5.99995C4.83844 5.92838 4.78167 5.84341 4.74293 5.7499C4.7042 5.65639 4.68427 5.55617 4.68427 5.45495C4.68427 5.35373 4.7042 5.25351 4.74293 5.16C4.78167 5.06649 4.83844 4.98152 4.91001 4.90995C4.98158 4.83838 5.06655 4.78161 5.16006 4.74287C5.25357 4.70414 5.3538 4.6842 5.45501 4.6842C5.55623 4.6842 5.65645 4.70414 5.74996 4.74287C5.84347 4.78161 5.92844 4.83838 6.00001 4.90995L7.00001 5.99995C7.123 6.13746 7.19099 6.31547 7.19099 6.49995C7.19099 6.68443 7.123 6.86244 7.00001 6.99995C6.87244 7.14545 6.69295 7.2352 6.50001 7.24995Z"></path>
              <path d="M18.56 19.31C18.4615 19.3104 18.3638 19.2912 18.2728 19.2534C18.1818 19.2157 18.0993 19.1601 18.03 19.09L17 18C16.9332 17.86 16.9114 17.7028 16.9376 17.5499C16.9638 17.3971 17.0368 17.2561 17.1465 17.1464C17.2561 17.0368 17.3971 16.9638 17.55 16.9376C17.7028 16.9113 17.8601 16.9331 18 17L19.09 18C19.2305 18.1406 19.3094 18.3312 19.3094 18.53C19.3094 18.7287 19.2305 18.9194 19.09 19.06C19.0233 19.1355 18.9419 19.1967 18.8508 19.2397C18.7597 19.2827 18.6607 19.3066 18.56 19.31Z"></path>
              <path d="M17.5 7.24995C17.3071 7.2352 17.1276 7.14545 17 6.99995C16.877 6.86244 16.809 6.68443 16.809 6.49995C16.809 6.31547 16.877 6.13746 17 5.99995L18 4.90995C18.1445 4.76541 18.3406 4.6842 18.545 4.6842C18.7494 4.6842 18.9455 4.76541 19.09 4.90995C19.2345 5.05449 19.3158 5.25054 19.3158 5.45495C19.3158 5.65936 19.2345 5.85541 19.09 5.99995L18 6.99995C17.8724 7.14545 17.6929 7.2352 17.5 7.24995Z"></path>
              <path d="M5.44001 19.31C5.34147 19.3104 5.24383 19.2912 5.15282 19.2534C5.06181 19.2157 4.97926 19.1601 4.91001 19.09C4.76956 18.9494 4.69067 18.7587 4.69067 18.56C4.69067 18.3612 4.76956 18.1706 4.91001 18.03L6.00001 17C6.13997 16.9331 6.2972 16.9113 6.45006 16.9376C6.60293 16.9638 6.7439 17.0368 6.85357 17.1464C6.96324 17.2561 7.03621 17.3971 7.06244 17.5499C7.08866 17.7028 7.06685 17.86 7.00001 18L6.00001 19.09C5.92728 19.1638 5.83985 19.2216 5.74338 19.2595C5.64691 19.2974 5.54356 19.3146 5.44001 19.31Z"></path>
           </svg>
        )
      )}
    </button>
  );
}
```

## File: src/app/admin/staff/page.tsx
```typescript
import { getStaffList } from '@/lib/actions';
import StaffTable from '@/components/admin/StaffTable';
import StaffPageHeader from '@/components/admin/StaffPageHeader';
import { createServerClient } from '@supabase/ssr'; // D√πng c√°i n√†y cho Server Component
import { cookies } from 'next/headers';
import { redirect } from 'next/navigation';

export default async function StaffPage() {
  // 1. Check quy·ªÅn ngay t·∫°i Server Page
  const cookieStore = await cookies(); // Await cookies() (Next.js 15)
  
  const supabase = createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() { return cookieStore.getAll() },
        setAll() {} // Server Component kh√¥ng set cookie
      },
    }
  );

  const { data: { user } } = await supabase.auth.getUser();
  
  if (!user) redirect('/login');

  // L·∫•y Role
  const { data: profile } = await supabase
    .from('users')
    .select('role, user_id')
    .eq('auth_id', user.id)
    .single();

  const currentRole = profile?.role || 'Staff';
  const currentUserId = profile?.user_id || 0; 

  // N·∫øu l√† Staff -> ƒê√° v·ªÅ Dashboard (Ch·∫∑n truy c·∫≠p trang n√†y lu√¥n)
  if (currentRole !== 'Admin') {
    redirect('/admin');
  }

  // 2. L·∫•y danh s√°ch (Ch·ªâ ch·∫°y n·∫øu l√† Admin)
  const staffList = await getStaffList();

  return (
    <div className="max-w-7xl mx-auto pb-20 space-y-6">
      {/* Truy·ªÅn role xu·ªëng n·∫øu mu·ªën ·∫©n hi·ªán n√∫t (tuy nhi√™n ta ƒë√£ ch·∫∑n c·∫£ trang r·ªìi) */}
      <StaffPageHeader total={staffList.length} />
      <StaffTable initialStaff={staffList} 
      currentUserRole={currentRole} currentUserId={currentUserId} />
    </div>
  );
}
```

## File: src/app/du-an/[slug]/page.tsx
```typescript
// src/app/du-an/[slug]/page.tsx
import React from 'react';
import { notFound } from 'next/navigation';
import { getProjects } from '@/lib/actions';
import { Metadata } from 'next';
import ProjectClientPage from './ProjectClientPage';

// 1. ƒê·ªãnh nghƒ©a Props
interface PageProps {
  params: Promise<{ slug: string }>;
}

// 2. Sinh ƒë∆∞·ªùng d·∫´n tƒ©nh (Quan tr·ªçng ƒë·ªÉ kh√¥ng b·ªã 404 khi deploy)
export async function generateStaticParams() {
  const projects = await getProjects();
  
  if (!Array.isArray(projects) || projects.length === 0) return [];

  return projects.map((project) => ({
    slug: project.slug, // Ch·ªâ c·∫ßn slug l√† ƒë·ªß
  }));
}

// 3. SEO Metadata
export async function generateMetadata({ params }: PageProps): Promise<Metadata> {
  const { slug } = await params;
  const projects = await getProjects();
  const project = projects.find((p) => p.slug === slug);

  if (!project) return { title: 'D·ª± √°n kh√¥ng t·ªìn t·∫°i' };

  const ogImage = typeof project.image === 'string' ? project.image : (project.image.src || '');

  return {
    title: `${project.title} | Oni Studio`,
    description: project.description || `Chi ti·∫øt d·ª± √°n ${project.title}`,
    openGraph: {
      images: [ogImage],
    },
  };
}
export const revalidate = 3600; // 1 hour
// 4. Component Ch√≠nh (Server Component)
export default async function ProjectDetailPage({ params }: PageProps) {
  const { slug } = await params;
  const projects = await getProjects();
  
  // T√¨m d·ª± √°n hi·ªán t·∫°i
  const project = projects.find((p) => p.slug === slug);

  if (!project) {
    notFound(); // Chuy·ªÉn h∆∞·ªõng sang trang 404 chu·∫©n
  }

  // Logic t√¨m b√†i Li√™n quan (C√πng danh m·ª•c) ƒë·ªÉ ƒëi·ªÅu h∆∞·ªõng Next/Prev
  // L·ªçc danh s√°ch ch·ªâ g·ªìm c√°c b√†i c√πng category
  const sameCategoryProjects = projects.filter(p => p.category === project.category);
  // T√¨m v·ªã tr√≠ c·ªßa b√†i hi·ªán t·∫°i trong danh s√°ch ƒë√≥
  const currentIndex = sameCategoryProjects.findIndex(p => p.id === project.id);
  
  // L·∫•y b√†i tr∆∞·ªõc v√† sau
  const nextProject = sameCategoryProjects[currentIndex + 1] || null;
  const prevProject = sameCategoryProjects[currentIndex - 1] || null;

  // T·∫°o Link ƒëi·ªÅu h∆∞·ªõng
  const nextLink = nextProject ? `/du-an/${nextProject.slug}` : null;
  const prevLink = prevProject ? `/du-an/${prevProject.slug}` : null;

  return (
    <ProjectClientPage 
      project={project}
      prevProjectLink={prevLink}
      nextProjectLink={nextLink}
    />
  );
}
```

## File: src/components/AboutPhilosophySection.tsx
```typescript
import Image from 'next/image';
import Container from '@/components/Container';
import ProfileImage from '../assets/about/avatar.webp'; 
import PhilosophyBackground from './PhilosophyBackground';
import AnimatedProfileImage from './AnimatedProfileImage';
export default function AboutPhilosophySection() {

  return (
    <section
      id="philosophy"
      className="relative py-24 md:py-32 overflow-hidden bg-[var(--to-linear)]"
    >
      {/* L·ªöP 1: N·ªÄN (HI·ªÜU ·ª®NG SCROLL TEXT) */}
      <PhilosophyBackground />
      {/* L·ªöP 2: N·ªòI DUNG (·∫¢NH & TRI·∫æT L√ù) */}
      <Container className="relative z-20">
        <div className="grid grid-cols-1 md:grid-cols-5 gap-12 md:gap-16 items-center">
          
          {/* C·ªòT TR√ÅI (·∫¢nh) */}
          <div className="md:col-span-2 flex justify-center items-center py-8 md:py-0"> {/* Th√™m padding y ƒë·ªÉ c√¢n ƒë·ªëi n·∫øu c·∫ßn */}
            {/* CONTAINER BAO G·ªíM ·∫¢NH V√Ä KHUNG L·ªÜCH */}
            <div className="relative w-full max-w-sm md:max-w-md lg:max-w-lg xl:max-w-xl mx-auto">
              {/* KHUNG L·ªÜCH (N·∫±m ph√≠a sau ·∫£nh) */}
              <div
                className="absolute bg-transparent border-2 border-[var(--foreground)]"
                style={{
                  width: '100%',     // K√≠ch th∆∞·ªõc c·ªßa khung l·ªách so v·ªõi container
                  height: '100%',    // Chi·ªÅu cao t∆∞∆°ng ƒë∆∞∆°ng ·∫£nh
                  top: '-25px',      // D·ªãch l√™n tr√™n m·ªôt ch√∫t
                  left: '35px',      // D·ªãch sang ph·∫£i m·ªôt ch√∫t
                  zIndex: 0,         // ƒê·∫£m b·∫£o n√≥ n·∫±m ph√≠a sau ·∫£nh ch√≠nh
                }}
              ></div>

              {/* ·∫¢NH CH√çNH (N·∫±m ph√≠a tr∆∞·ªõc khung l·ªách) */}
              <div className="relative z-10"> {/* ƒê·∫£m b·∫£o ·∫£nh n·∫±m tr√™n khung l·ªách */}
              <AnimatedProfileImage>
                        {/* Component <Image> n√†y v·∫´n ƒë∆∞·ª£c render tr√™n SERVER
                          v√† ƒë∆∞·ª£c "truy·ªÅn" v√†o <AnimatedProfileImage> nh∆∞ m·ªôt prop 'children'
                        */}
                        <Image
                          src={ProfileImage}
                          alt="Ch√¢n dung Oni, nhi·∫øp ·∫£nh gia Oni Studio"
                          width={600}
                          height={800}
                          className="object-cover aspect-[3/4] w-full " 
                          placeholder="blur"
                        />
                </AnimatedProfileImage>
              </div>
            </div>
          </div>
        
          {/* C·ªòT PH·∫¢I (Text) */}
          <div className="md:col-span-3">
            <h2 className="text-4xl md:text-5xl font-light tracking-tighter mb-6 text-[var(--foreground)]">
              Tri·∫øt L√Ω C·ªßa T√¥i
            </h2>
            <div className="text-lg md:text-xl space-y-6">
            <p className="leading-relaxed text-[var(--foreground)]">
              <strong>√Ånh s√°ng</strong> l√† n·ªÅn t·∫£ng c·ªßa c√¥ng vi·ªác. Ni·ªÅm say m√™ b·∫•t t·∫≠n n·∫±m ·ªü vi·ªác khai th√°c 
              c√°ch √°nh s√°ng <strong>ƒëi√™u kh·∫Øc</strong>, l√†m n·ªïi b·∫≠t, v√† <strong>t√¥n vinh</strong> m·ªôt ch·ªß th·ªÉ. 
              ƒê√≥ v·ª´a l√† c√¥ng c·ª•, l√† <strong>ng√¥n ng·ªØ</strong>, v·ª´a l√† <strong>ngu·ªìn c·∫£m h·ª©ng ch√≠nh</strong>.
            </p>

            <p className="leading-relaxed text-[var(--foreground)]">
              T√¥i tin r·∫±ng m·ªôt b·ª©c ·∫£nh th√†nh c√¥ng l√† s·ª± <strong>giao thoa h√†i h√≤a</strong> gi·ªØa <strong>t·∫ßm nh√¨n ngh·ªá thu·∫≠t</strong> v√† <strong>k·ªπ thu·∫≠t ch√≠nh x√°c</strong>. 
              T·ª´ d·ª± √°n th∆∞∆°ng m·∫°i ph·ª©c t·∫°p ƒë·∫øn m·ªôt b·ª©c ch√¢n dung t·ªëi gi·∫£n, m·ª•c ti√™u lu√¥n l√† 
              s·ª± <strong>ch·ªân chu trong t·ª´ng chi ti·∫øt</strong>, mang l·∫°i gi√° tr·ªã v∆∞·ª£t tr√™n c·∫£ mong ƒë·ª£i.
            </p>
            </div>
          </div>

        </div>
      </Container>
    </section>
  );
}
```

## File: src/components/admin/SettingsForm.tsx
```typescript
// src/components/admin/SettingsForm.tsx
'use client';

import { useState } from 'react'; // B·ªè useTransition v√¨ kh√¥ng d√πng n√∫t ri√™ng n·ªØa
import { toast } from 'sonner';
import { Save, RotateCcw, Monitor, List, Database, Minus, Plus, Loader2, Clock } from 'lucide-react';
import { SettingItem, updateSettings } from '@/lib/actions/settings';

interface SettingsFormProps {
  initialSettings: SettingItem[];
  initialCleanupMinutes: number;
}

export default function SettingsForm({ initialSettings, initialCleanupMinutes }: SettingsFormProps) {
  // State chung
  const [settings, setSettings] = useState<SettingItem[]>(initialSettings);
  // State ri√™ng cho cleanup (ƒë·ªÉ bind v√†o input number)
  const [cleanupTime, setCleanupTime] = useState(initialCleanupMinutes);
  
  const [isSaving, setIsSaving] = useState(false);

  // Helper l·∫•y value t·ª´ state chung
  const getValue = (key: string) => settings.find(s => s.key === key)?.value || '';

  // Helper update state chung
  const updateLocalSetting = (key: string, newValue: string) => {
    setSettings(prev => prev.map(s => s.key === key ? { ...s, value: newValue } : s));
  };

  // Logic tƒÉng gi·∫£m s·ªë l∆∞·ª£ng (gi·ªØ nguy√™n)
  const handleNumberChange = (key: string, type: 'increase' | 'decrease') => {
    const currentVal = parseInt(getValue(key) || '10');
    let newVal = currentVal;
    if (type === 'increase') {
        newVal = currentVal < 5 ? 5 : currentVal + 5;
    } else {
        newVal = currentVal <= 5 ? 1 : currentVal - 5;
    }
    newVal = Math.max(1, Math.min(100, newVal));
    updateLocalSetting(key, newVal.toString());
  };

  // --- H√ÄM L∆ØU T·ªîNG H·ª¢P (QUAN TR·ªåNG NH·∫§T) ---
  const handleSave = async () => {
    setIsSaving(true);
    const toastId = toast.loading('ƒêang l∆∞u c·∫•u h√¨nh...');

    try {
      // 1. T·∫°o payload t·ª´ danh s√°ch settings hi·ªán t·∫°i
      // L·ªçc b·ªè key 'CLEANUP_GAP_MINUTES' c≈© n·∫øu l·ª° n√≥ c√≥ n·∫±m trong m·∫£ng settings (ƒë·ªÉ tr√°nh tr√πng l·∫∑p)
      const baseUpdates = settings
        .filter(s => s.key !== 'CLEANUP_GAP_MINUTES')
        .map(s => ({ key: s.key, value: s.value }));

      // 2. G·ªôp gi√° tr·ªã Cleanup Time hi·ªán t·∫°i v√†o payload
      const finalUpdates = [
        ...baseUpdates,
        { key: 'CLEANUP_GAP_MINUTES', value: cleanupTime.toString() }
      ];

      // 3. G·ª≠i 1 request duy nh·∫•t update t·∫•t c·∫£
      const res = await updateSettings(finalUpdates);

      if (res.success) {
        toast.success('ƒê√£ l∆∞u t·∫•t c·∫£ c·∫•u h√¨nh!', { id: toastId });
        // Dispatch event n·∫øu c·∫ßn
        if (typeof window !== 'undefined') {
            window.dispatchEvent(new Event('settings:updated'));
        }
      } else {
        toast.error(`L·ªói: ${res.error}`, { id: toastId });
      }
    } catch (error) {
        const msg = error instanceof Error ? error.message : 'C√≥ l·ªói x·∫£y ra';
        toast.error(msg, { id: toastId });
    } finally {
      setIsSaving(false);
    }
  };

  return (
    <div className="max-w-4xl mx-auto space-y-8">
      
      {/* CARD 0: V·∫¨N H√ÄNH STUDIO */}
      <div className="bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-xl p-6 shadow-sm">
        <div className="flex items-center gap-3 mb-6 border-b border-[var(--admin-border)] pb-4">
          <div className="p-2 bg-purple-100 text-purple-600 rounded-lg">
            <Clock size={20} />
          </div>
          <div>
            <h3 className="font-bold text-[var(--admin-fg)]">V·∫≠n h√†nh Studio</h3>
            <p className="text-xs text-[var(--admin-sub)]">Qu·∫£n l√Ω th·ªùi gian v√† quy tr√¨nh.</p>
          </div>
        </div>
        <div className="flex flex-col md:flex-row gap-4 items-end">
            <div className="flex-1">
                <label className="block text-sm font-medium text-[var(--admin-sub)] mb-2">
                    Th·ªùi gian d·ªçn d·∫πp (Ph√∫t)
                </label>
                <input
                    type="number" step="15" min="0"
                    value={cleanupTime}
                    onChange={(e) => setCleanupTime(Number(e.target.value))}
                    disabled
                    className="w-full max-w-[200px] p-2 rounded-lg bg-[var(--admin-bg)] border border-[var(--admin-border)] text-[var(--admin-fg)] focus:ring-2 focus:ring-[var(--admin-primary)] outline-none"
                />
                <p className="text-[10px] text-[var(--admin-sub)] mt-2">
                    * Gi√° tr·ªã n√†y s·∫Ω ƒë∆∞·ª£c l∆∞u c√πng n√∫t L∆∞u c·∫•u h√¨nh b√™n d∆∞·ªõi.
                </p>
            </div>
        </div>
      </div>

      {/* CARD 1: HI·ªÇN TH·ªä */}
      <div className="bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-xl p-6 shadow-sm">
        <div className="flex items-center gap-3 mb-6 border-b border-[var(--admin-border)] pb-4">
          <div className="p-2 bg-indigo-100 text-indigo-600 rounded-lg">
            <List size={20} />
          </div>
          <div>
            <h3 className="font-bold text-[var(--admin-fg)]">Hi·ªÉn th·ªã & Danh s√°ch</h3>
            <p className="text-xs text-[var(--admin-sub)]">ƒêi·ªÅu ch·ªânh s·ªë l∆∞·ª£ng d·ªØ li·ªáu tr√™n b·∫£ng v√† trang ch·ªß.</p>
          </div>
        </div>

        <div className="grid gap-6 md:grid-cols-2">
          {/* ITEMS PER PAGE CONTROL */}
          <div className="space-y-2">
            <label className="text-sm font-medium text-[var(--admin-fg)]">S·ªë d·ª± √°n m·ªói l·∫ßn t·∫£i (Admin Table)</label>
            <div className="flex items-center gap-4">
              <div className="flex items-center border border-[var(--admin-border)] rounded-lg bg-[var(--admin-bg)]">
                <button 
                  onClick={() => handleNumberChange('items_per_page', 'decrease')}
                  className="p-3 hover:bg-[var(--admin-hover)] text-[var(--admin-sub)]
                   hover:text-[var(--admin-fg)] border-r border-[var(--admin-border)] cursor-pointer"
                >
                  <Minus size={16} />
                </button>
                <input 
                  type="number" 
                  className="w-16 text-center bg-transparent outline-none font-bold text-[var(--admin-fg)]"
                  value={getValue('items_per_page')}
                  readOnly 
                />
                <button 
                  onClick={() => handleNumberChange('items_per_page', 'increase')}
                  className="p-3 hover:bg-[var(--admin-hover)] text-[var(--admin-sub)] 
                  hover:text-[var(--admin-fg)] border-l border-[var(--admin-border)] cursor-pointer"
                >
                  <Plus size={16} />
                </button>
              </div>
              <span className="text-xs text-[var(--admin-sub)]">d·ª± √°n / trang</span>
            </div>
            <p className="text-[10px] text-[var(--admin-sub)] mt-1">
                * M·∫∑c ƒë·ªãnh l√† 10.
            </p>
          </div>
        </div>
      </div>

      {/* CARD 2: TH√îNG TIN WEBSITE */}
      <div className="bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-xl p-6 shadow-sm">
        <div className="flex items-center gap-3 mb-6 border-b border-[var(--admin-border)] pb-4">
          <div className="p-2 bg-blue-100 text-blue-600 rounded-lg">
            <Monitor size={20} />
          </div>
          <div>
            <h3 className="font-bold text-[var(--admin-fg)]">Th√¥ng tin Website</h3>
            <p className="text-xs text-[var(--admin-sub)]">C√°c th√¥ng tin hi·ªÉn th·ªã tr√™n thanh ti√™u ƒë·ªÅ tr√¨nh duy·ªát.</p>
          </div>
        </div>

        <div className="space-y-4">
          <div className="space-y-2">
            <label className="text-sm font-medium text-[var(--admin-fg)]">Ti√™u ƒë·ªÅ trang (Site Title)</label>
            <input 
              type="text" 
              className="w-full p-2.5 bg-[var(--admin-bg)] border border-[var(--admin-border)] rounded-lg outline-none focus:border-[var(--admin-primary)] text-[var(--admin-fg)] transition-all"
              value={getValue('site_title')}
              onChange={(e) => updateLocalSetting('site_title', e.target.value)}
            />
          </div>
        </div>
      </div>

      {/* CARD 3: H·ªÜ TH·ªêNG */}
      <div className="bg-[var(--admin-card)] border border-[var(--admin-border)] rounded-xl p-6 shadow-sm opacity-90 space-y-4">
        <div className="flex items-center gap-3 mb-6 border-b border-[var(--admin-border)] pb-4">
          <div className="p-2 bg-orange-100 text-orange-600 rounded-lg">
            <Database size={20} />
          </div>
          <div>
            <h3 className="font-bold text-[var(--admin-fg)]">C·∫•u h√¨nh H·ªá th·ªëng</h3>
            <p className="text-xs text-[var(--admin-sub)]">C√°c thi·∫øt l·∫≠p n√¢ng cao.</p>
          </div>
        </div>

        <div className="flex items-center justify-between p-4 bg-[var(--admin-bg)] rounded-lg border border-[var(--admin-border)]">
          <div>
            <span className="font-medium text-[var(--admin-fg)] block">Ch·∫ø ƒë·ªô Demo</span>
            <span className="text-xs text-[var(--admin-sub)]">N·∫øu b·∫≠t, website s·∫Ω hi·ªÉn th·ªã d·ªØ li·ªáu gi·∫£ thay v√¨ t·ª´ Database.</span>
          </div>
          <label className="relative inline-flex items-center cursor-pointer">
            <input 
              type="checkbox" 
              className="sr-only peer" 
              checked={getValue('is_demo_mode') === 'true'}
              onChange={(e) => updateLocalSetting('is_demo_mode', e.target.checked ? 'true' : 'false')}
            />
            <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 dark:peer-focus:ring-indigo-800 rounded-full peer dark:bg-gray-700 peer-checked:bg-[var(--admin-primary)] after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-full peer-checked:after:border-white"></div>
          </label>
        </div>
        <div className="flex items-center justify-between p-4 bg-[var(--admin-bg)] rounded-lg border border-[var(--admin-border)]">
            <div>
              <span className="font-medium text-[var(--admin-fg)] block">T·ª± ƒë·ªông ƒêƒÉng xu·∫•t</span>
              <span className="text-xs text-[var(--admin-sub)]">H·ªá th·ªëng s·∫Ω kh√≥a phi√™n l√†m vi·ªác n·∫øu kh√¥ng c√≥ ho·∫°t ƒë·ªông chu·ªôt/ph√≠m.</span>
            </div>
            
            <div className="flex items-center border border-[var(--admin-border)] rounded-lg bg-[var(--admin-card)]">
              <button 
                onClick={() => handleNumberChange('idle_timeout_minutes', 'decrease')}
                className="p-2 hover:bg-[var(--admin-hover)] text-[var(--admin-sub)] 
                border-r border-[var(--admin-border)] disabled:opacity-50 cursor-pointer"
                disabled={parseInt(getValue('idle_timeout_minutes')) <= 5}
              >
                <Minus size={16} />
              </button>
              
              <div className="w-20 text-center font-mono font-bold text-[var(--admin-fg)] flex items-center justify-center gap-1">
                 {getValue('idle_timeout_minutes') || '60'} <span className="text-[10px] font-normal text-[var(--admin-sub)]">ph√∫t</span>
              </div>
              
              <button 
                onClick={() => handleNumberChange('idle_timeout_minutes', 'increase')}
                className="p-2 hover:bg-[var(--admin-hover)] text-[var(--admin-sub)] 
                border-l border-[var(--admin-border)] cursor-pointer"
              >
                <Plus size={16} />
              </button>
            </div>
          </div>
      </div>

      {/* ACTION BAR - N√öT L∆ØU DUY NH·∫§T */}
      <div className="flex justify-end gap-4 sticky bottom-4 pt-4 bg-gradient-to-t from-[var(--admin-bg)] to-transparent pb-4 z-10">
        <button 
          onClick={() => {
              setSettings(initialSettings);
              setCleanupTime(initialCleanupMinutes);
          }}
          className="px-4 py-2 rounded-lg bg-[var(--admin-card)] border border-[var(--admin-border)] 
          text-[var(--admin-sub)] hover:bg-[var(--admin-hover)] flex items-center gap-2 shadow-sm cursor-pointer"
        >
          <RotateCcw size={18} /> Kh√¥i ph·ª•c
        </button>
        <button 
          onClick={handleSave}
          disabled={isSaving}
          className="px-6 py-2 rounded-lg bg-[var(--admin-primary)] text-[var(--admin-bg)] font-medium 
          hover:opacity-90 flex items-center gap-2 shadow-lg shadow-indigo-500/30 disabled:opacity-70 cursor-pointer"
        >
          {isSaving ? <Loader2 className="animate-spin" size={18} /> : <Save size={18} />}
          L∆∞u t·∫•t c·∫£ c·∫•u h√¨nh
        </button>
      </div>
    </div>
  );
}
```

## File: src/components/admin/StaffTable.tsx
```typescript
// src/components/admin/StaffTable.tsx
'use client';

import React, { useState, useMemo } from 'react';
import { Search, Mail, ArrowUpDown, UserX, UserCheck } from 'lucide-react';
import { toast } from 'sonner';
import { StaffUser, toggleStaffStatus } from '@/lib/actions'; 
import { createBrowserClient } from '@supabase/ssr';
import { useRouter } from 'next/navigation';
// 1. IMPORT MODAL
import ConfirmModal from '@/components/ui/ConfirmModal';

interface StaffTableProps {
  initialStaff: StaffUser[];
  currentUserRole: string;
  currentUserId: number;
}

type SortKey = 'full_name' | 'role' | 'email' | 'is_active';

export default function StaffTable({ initialStaff, currentUserRole, currentUserId }: StaffTableProps) {
  const [staffList, setStaffList] = useState(initialStaff);
  const [searchQuery, setSearchQuery] = useState('');
  const [sortConfig, setSortConfig] = useState<{ key: SortKey; direction: 'asc' | 'desc' }>({ key: 'full_name', direction: 'asc' });
  
  // State cho Loading & Modal
  const [isLoading, setIsLoading] = useState(false); // Loading chung cho modal
  
  // 2. STATE QU·∫¢N L√ù MODAL
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [selectedStaff, setSelectedStaff] = useState<StaffUser | null>(null);

  const router = useRouter();
  const supabase = createBrowserClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
  );

  // --- LOGIC SORT & FILTER (Gi·ªØ nguy√™n) ---
  const handleSort = (key: SortKey) => {
    setSortConfig((current) => ({
      key,
      direction: current.key === key && current.direction === 'asc' ? 'desc' : 'asc',
    }));
  };

  const processedStaff = useMemo(() => {
    let data = [...staffList];
    if (searchQuery) {
      const lowerQuery = searchQuery.toLowerCase();
      data = data.filter(
        (s) =>
          s.full_name?.toLowerCase().includes(lowerQuery) ||
          s.email?.toLowerCase().includes(lowerQuery) ||
          s.role?.toLowerCase().includes(lowerQuery)
      );
    }
    data.sort((a, b) => {
      const aValue = a[sortConfig.key];
      const bValue = b[sortConfig.key];
      if (aValue < bValue) return sortConfig.direction === 'asc' ? -1 : 1;
      if (aValue > bValue) return sortConfig.direction === 'asc' ? 1 : -1;
      return 0;
    });
    return data;
  }, [staffList, searchQuery, sortConfig]);

  // --- 3. H√ÄM M·ªû MODAL ---
  const openConfirmModal = (staff: StaffUser) => {
    setSelectedStaff(staff);
    setIsModalOpen(true);
  };

  // --- 4. H√ÄM X·ª¨ L√ù CH√çNH (CH·∫†Y KHI B·∫§M CONFIRM TRONG MODAL) ---
  const handleConfirmToggle = async () => {
    if (!selectedStaff) return;

    setIsLoading(true);

    try {
      const { data: { session } } = await supabase.auth.getSession();
      if (!session) {
        toast.error('H·∫øt phi√™n ƒëƒÉng nh·∫≠p');
        return;
      }

      const res = await toggleStaffStatus(session.access_token, selectedStaff.user_id, selectedStaff.is_active);

      if (res.success) {
        toast.success(`ƒê√£ ${selectedStaff.is_active ? 'kh√≥a' : 'm·ªü kh√≥a'} t√†i kho·∫£n th√†nh c√¥ng!`);
        
        // Optimistic Update
        setStaffList((prev) =>
          prev.map((s) => (s.user_id === selectedStaff.user_id ? { ...s, is_active: !s.is_active } : s))
        );
        
        setIsModalOpen(false); // ƒê√≥ng modal
        setSelectedStaff(null);
        router.refresh();
      } else {
        toast.error(`L·ªói: ${res.error}`);
      }
    } catch (error) {
        const msg = error instanceof Error ? error.message : 'L·ªói h·ªá th·ªëng';
        toast.error(msg);
    } finally {
      setIsLoading(false);
    }
  };

  const SortableHeader = ({ label, colKey, className = "" }: { label: string; colKey: SortKey; className?: string }) => (
    <th 
      className={`px-6 py-4 whitespace-nowrap cursor-pointer hover:bg-[var(--admin-hover)] transition-colors select-none group ${className}`}
      onClick={() => handleSort(colKey)}
    >
      <div className="flex items-center gap-2">
        {label}
        <ArrowUpDown size={14} className={`text-[var(--admin-sub)] transition-opacity ${sortConfig.key === colKey ? 'opacity-100 text-[var(--admin-primary)]' : 'opacity-0 group-hover:opacity-50'}`} />
      </div>
    </th>
  );

  return (
    <div className="space-y-6">
      {/* Search Bar (Gi·ªØ nguy√™n) */}
      <div className="flex items-center gap-4 bg-[var(--admin-card)] p-4 rounded-xl border border-[var(--admin-border)] shadow-sm">
        <div className="relative flex-1 max-w-md w-full">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-[var(--admin-sub)]" size={18} />
          <input 
            type="text" 
            placeholder="T√¨m ki·∫øm theo t√™n, email, vai tr√≤..." 
            className="w-full pl-10 pr-4 py-2 bg-[var(--admin-bg)] border border-[var(--admin-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--admin-primary)] text-[var(--admin-fg)] transition-all"
            value={searchQuery}
            onChange={(e) => setSearchQuery(e.target.value)}
          />
        </div>
        <div className="text-sm text-[var(--admin-sub)]">
            T·ªïng: <strong>{processedStaff.length}</strong> nh√¢n s·ª±
        </div>
      </div>

      {/* Table */}
      <div className="bg-[var(--admin-card)] rounded-xl border border-[var(--admin-border)] shadow-sm overflow-hidden">
        <div className="overflow-x-auto table-scrollbar">
          <table className="w-full text-sm text-left min-w-[800px]">
            <thead className="bg-[var(--admin-bg)] text-[var(--admin-sub)] uppercase text-xs font-semibold border-b border-[var(--admin-border)]">
              <tr>
                <SortableHeader label="H·ªç v√† T√™n" colKey="full_name" />
                <SortableHeader label="Vai tr√≤" colKey="role" />
                <th className="px-6 py-4 whitespace-nowrap">Li√™n h·ªá</th>
                <SortableHeader label="Tr·∫°ng th√°i" colKey="is_active" />
                <th className="px-6 py-4 text-right whitespace-nowrap">H√†nh ƒë·ªông</th>
              </tr>
            </thead>
            <tbody className="divide-y divide-[var(--admin-border)]">
              {processedStaff.length === 0 ? (
                 <tr><td colSpan={5} className="p-8 text-center text-[var(--admin-sub)] italic">Kh√¥ng t√¨m th·∫•y nh√¢n vi√™n n√†o.</td></tr>
              ) : (
                processedStaff.map((staff) => (
                  <tr key={staff.user_id} className={`transition-colors ${staff.is_active ? 'hover:bg-[var(--admin-hover)]' : 'bg-gray-50 dark:bg-neutral-900/50 opacity-70'}`}>
                    {/* ... (C√°c c·ªôt hi·ªÉn th·ªã th√¥ng tin gi·ªØ nguy√™n) ... */}
                    <td className="px-6 py-4 font-medium text-[var(--admin-fg)]">
                      <div className="flex items-center gap-3">
                        <div className={`w-8 h-8 rounded-full flex items-center justify-center text-white font-bold shrink-0 shadow-sm ${staff.role === 'Admin' ? 'bg-indigo-500' : 'bg-pink-500'}`}>
                          {staff.full_name?.charAt(0).toUpperCase() || '?'}
                        </div>
                        <div>
                            <div className="whitespace-nowrap font-semibold">{staff.full_name}</div>
                            {staff.role === 'Admin' && <span className="text-[10px] text-[var(--admin-primary)] font-bold border border-[var(--admin-primary)] px-1 rounded">SUPER ADMIN</span>}
                        </div>
                      </div>
                    </td>
                    <td className="px-6 py-4 text-[var(--admin-sub)] whitespace-nowrap font-medium">{staff.role}</td>
                    <td className="px-6 py-4 text-[var(--admin-sub)] space-y-1 whitespace-nowrap">
                      <div className="flex items-center gap-2"><Mail size={14}/> {staff.email}</div>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      <span className={`px-2.5 py-1 rounded-full text-xs font-bold border ${
                        staff.is_active 
                          ? 'bg-green-100 text-green-700 border-green-200' 
                          : 'bg-red-100 text-red-600 border-red-200'
                      }`}>
                        {staff.is_active ? 'ƒêang ho·∫°t ƒë·ªông' : 'ƒê√£ kh√≥a'}
                      </span>
                    </td>
                    <td className="px-6 py-4 text-right whitespace-nowrap">
                      {/* C·ªòT H√ÄNH ƒê·ªòNG */}
                     {currentUserRole === 'Admin' && staff.user_id !== currentUserId && (
                        <button 
                          onClick={() => openConfirmModal(staff)} 
                          className={`p-2 rounded-lg transition-colors group cursor-pointer ${
                              staff.is_active 
                              ? 'text-red-500 hover:bg-red-50' 
                              : 'text-green-500 hover:bg-green-50'
                          }`}
                          title={staff.is_active ? "Kh√≥a t√†i kho·∫£n" : "M·ªü kh√≥a t√†i kho·∫£n"}
                        >
                          {staff.is_active ? <UserX size={18} /> : <UserCheck size={18} />}
                        </button>
                      )}
                      {staff.user_id === currentUserId && (
                        <span className="text-xs text-[var(--admin-sub)] italic px-2">B·∫°n</span>
                      )}
                    </td>
                  </tr>
                ))
              )}
            </tbody>
          </table>
        </div>
      </div>

      {/* 5. RENDER MODAL */}
      <ConfirmModal 
        isOpen={isModalOpen}
        onClose={() => !isLoading && setIsModalOpen(false)}
        onConfirm={handleConfirmToggle}
        isLoading={isLoading}
        
        // Logic hi·ªÉn th·ªã ƒë·ªông d·ª±a tr√™n tr·∫°ng th√°i nh√¢n vi√™n
        title={selectedStaff?.is_active ? "Kh√≥a t√†i kho·∫£n n√†y?" : "M·ªü kh√≥a t√†i kho·∫£n?"}
        
        description={selectedStaff?.is_active 
            ? `B·∫°n c√≥ ch·∫Øc mu·ªën kh√≥a quy·ªÅn truy c·∫≠p c·ªßa "${selectedStaff.full_name}"? H·ªç s·∫Ω kh√¥ng th·ªÉ ƒëƒÉng nh·∫≠p v√†o h·ªá th·ªëng n·ªØa.` 
            : `B·∫°n c√≥ ch·∫Øc mu·ªën k√≠ch ho·∫°t l·∫°i t√†i kho·∫£n cho "${selectedStaff?.full_name}"? H·ªç s·∫Ω c√≥ th·ªÉ ƒëƒÉng nh·∫≠p v√† l√†m vi·ªác b√¨nh th∆∞·ªùng.`
        }
        
        confirmText={selectedStaff?.is_active ? "Kh√≥a t√†i kho·∫£n" : "K√≠ch ho·∫°t l·∫°i"}
        cancelText="H·ªßy b·ªè"
        
        // ƒê·ªïi m√†u s·∫Øc: Kh√≥a = ƒê·ªè, M·ªü = Xanh/Info
        variant={selectedStaff?.is_active ? 'danger' : 'info'} 
      />
    </div>
  );
}
```

## File: src/components/ContactSection.tsx
```typescript
// src/components/ContactSection.tsx
'use client'; // B·∫Øt bu·ªôc v√¨ d√πng hook (useState)

import React, { useState } from 'react';
import Container from '@/components/Container';
import BrandScroller from "@/components/BrandScroller";

export default function ContactSection() {
  const email = 'hello@onistudio.com';
  const [copyText, setCopyText] = useState(email);
  const noiseOpacity = 0.05; // ƒêi·ªÅu ch·ªânh ƒë·ªô ƒë·∫≠m/nh·∫°t c·ªßa noise

  // H√†m x·ª≠ l√Ω copy email (gi·ªØ nguy√™n)
  const handleCopy = () => {
    navigator.clipboard.writeText(email).then(
      () => {
        setCopyText('ƒê√£ sao ch√©p!');
        setTimeout(() => {
          setCopyText(email);
        }, 2000);
      },
      (err) => {
        console.error('Kh√¥ng th·ªÉ sao ch√©p: ', err);
        setCopyText('L·ªói khi sao ch√©p');
      }
    );
  };

  return (
<section
      id="contact"
      className="relative py-14 overflow-hidden 
                 bg-linear-to-b to-[var(--to-linear)] from-[var(--from-linear)] 
                 dark:text-white text-black" 
      style={{ minHeight: 0, fontSize: 'initial' }}
    >
      {/* 2. L·ªöP N·ªÄN (GRID + MASK) */}
      <div
        className="absolute bottom-0 left-0 right-0 top-0 z-0
                   bg-[linear-gradient(to_right,#4f4f4f2e_1px,transparent_1px),linear-gradient(to_bottom,#4f4f4f2e_1px,transparent_1px)] 
                   bg-size-[35px_34px] 
                   mask-[radial-gradient(ellipse_60%_50%_at_50%_0%,#000_70%,transparent_100%)]"
      ></div>

      {/* 3. L·ªöP N·ªÄN (NOISE) */}
      <div
        className="absolute top-0 left-0 w-full h-full content-[''] z-10 
                   pointer-events-none 
                   bg-[url('https://www.ui-layouts.com/noise.gif')]"
        style={{ opacity: noiseOpacity }}
      ></div>

      {/* 4. N·ªòI DUNG (ƒë·∫∑t z-index cao h∆°n) */}
      <Container className="relative z-20 mt-16 mb-12 lg:mt-24 lg:mb-14">
        <div className="relative md:border-l-1 border-[var(--foreground)]">
       {/* 1. THAY ƒê·ªîI: TI√äU ƒê·ªÄ D·ªåC (Ch·ªâ hi·ªán t·ª´ 'md' tr·ªü l√™n) */}
          <div className="hidden md:flex absolute top-0 -left-16 md:-left-24 w-16 md:w-24 h-full items-center justify-center pointer-events-none">
            <h2
              className="transform -rotate-90 whitespace-nowrap text-4xl md:text-5xl 
                         font-light tracking-widest uppercase text-[var(--foreground)]"
            >
              Li√™n H·ªá
            </h2>
          </div>

          {/* 2. TH√äM M·ªöI: TI√äU ƒê·ªÄ NGANG (Ch·ªâ hi·ªán tr√™n di ƒë·ªông) */}
          <div className="md:hidden mb-12">
            <h2 className="text-4xl font-light tracking-tighter text-[var(--foreground)]">
              Li√™n H·ªá
            </h2>
          </div>

          {/* 3. THAY ƒê·ªîI: N·ªòI DUNG CH√çNH (B·ªè padding tr√°i tr√™n di ƒë·ªông) */}
          <div className="pl-0 md:pl-16 grid grid-cols-1 md:grid-cols-2 gap-12 md:gap-20 max-w-4xl mx-auto">
            
            {/* C·ªòT 1: FORM */}
            <div>
              <p className="text-lg text-[var(--foreground)] mb-6">
                ƒê·ªÉ l·∫°i l·ªùi nh·∫Øn cho ch√∫ng t√¥i b·∫±ng c√°ch ƒëi·ªÅn v√†o bi·ªÉu m·∫´u b√™n d∆∞·ªõi:
              </p>
              {/* ... (ph·∫ßn form gi·ªØ nguy√™n) ... */}
              <form
                onSubmit={(e) => {
                  e.preventDefault();
                  alert('Ch·ª©c nƒÉng g·ª≠i form ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn!');
                }}
                className="space-y-6"
              >
                <div>
                  <label
                    htmlFor="email"
                    className="block border-[var(--foreground)]/60 focus:border-[var(--foreground)] text-sm font-medium mb-1 text-[var(--foreground)]"
                  >
                    Email c·ªßa b·∫°n
                  </label>
                  <input
                    type="email"
                    id="email"
                    name="email"
                    required
                    className="block w-full p-3 bg-transparent 
                               border border-[var(--foreground)]/60
                               focus:ring-0 focus:border-[var(--foreground)] 
                               transition-colors text-[var(--foreground)]"
                  />
                </div>
                <div>
                  <label
                    htmlFor="message"
                    className="block text-sm font-medium mb-1 text-[var(--foreground)]"
                  >
                    L·ªùi nh·∫Øn
                  </label>
                  <textarea
                    id="message"
                    name="message"
                    rows={5}
                    required
                    className="block w-full p-3 bg-transparent text-[var(--foreground)]
                               border border-[var(--foreground)]/60
                               focus:ring-0 focus:border-[var(--foreground)] 
                               transition-colors"
                  ></textarea>
                </div>
                <div>
                  <button
                    type="submit"
                    className="py-3 px-8 bg-transparent 
                               border border-[var(--foreground)]/60
                               text-[var(--foreground)] 
                               hover:bg-black 
                               dark:hover:bg-white dark:hover:text-gray-950
                               transition-colors duration-300 cursor-pointer font-bold"
                  >
                    G·ª≠i L·ªùi Nh·∫Øn
                  </button>
                </div>
              </form>
            </div>

            {/* C·ªòT 2: EMAIL COPY */}
            <div>
              <p className="text-lg mb-6 text-[var(--foreground)]">
                Ho·∫∑c nh·∫•n ƒë·ªÉ sao ch√©p email:
              </p>
              {/* ... (ph·∫ßn n√∫t copy gi·ªØ nguy√™n) ... */}
              <button
                onClick={handleCopy}
                className="w-full text-left p-4 bg-transparent 
                           border border-[var(--foreground)]/60
                           text-lg md:text-xl font-mono 
                           hover:border-[var(--foreground)]
                           transition-all duration-300 cursor-pointer text-[var(--foreground)]"
              >
                {copyText}
              </button>
            </div>
          </div>
        </div>
      </Container>
  {/* 4. ƒê·∫∑t BrandScroller V√ÄO ƒê√ÇY (Sau Container, trong Section) */}
      {/* Ph·∫£i c√≥ relative z-20 ƒë·ªÉ n·ªïi l√™n tr√™n n·ªÅn */}
      <div className="relative z-20 mt-10 md:mt-4">
        <BrandScroller />
      </div>
    </section>
   


  );
}
```

## File: src/components/Header.tsx
```typescript
// src/components/Header.tsx
'use client'; 

import { useState, useEffect } from 'react'; 
import Container from "./Container";
import localFont from 'next/font/local'; 
import Link from 'next/link';
import ThemeToggle from './ThemeToggle';

const logoFont = localFont({
  src: '../fonts/cameliya-regular.ttf',
  display: 'swap',
  variable: '--font-logo',
});

export default function Header() {
  const [isMenuOpen, setIsMenuOpen] = useState(false);

  useEffect(() => {
    if (isMenuOpen) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = 'auto';
    }
    return () => {
      document.body.style.overflow = 'auto';
    };
  }, [isMenuOpen]); 

  const handleLinkClick = () => {
    setIsMenuOpen(false);
  };
  
  return (
   <header
      className={`border-b py-4 relative z-50 
                 animate-fade-in-up backdrop-blur-2xl bg-[var(--background)] 
                 border-[var(--foreground)]`} 
    >
      <Container>
        <div className="flex items-center justify-between">
          <h1
            className={`text-xl font-semibold tracking-widest cursor-pointer ${logoFont.className}`}
          >
            <Link href="/" className="menu-link-glow">
              Oni Studio
            </Link>
          </h1>

          <nav className="hidden md:flex items-center space-x-6 text-md">
            <Link href="/thuong-mai" className="menu-link-glow">
              Th∆∞∆°ng m·∫°i
            </Link>
            <Link href="/thoi-trang" className="menu-link-glow">
              Th·ªùi trang
            </Link>
            <Link href="/ca-nhan" className="menu-link-glow">
              C√° nh√¢n
            </Link>
            <Link href="/dich-vu" className="menu-link-glow">
              D·ªãch V·ª•
            </Link>
            <Link href="/gioi-thieu" className="menu-link-glow">
              Gi·ªõi thi·ªáu
            </Link>
            <ThemeToggle />
          </nav>

          {/* S·ª¨A 2: G·ªôp ThemeToggle v√† N√∫t Hamburger v√†o chung 1 div */}
          <div className="md:hidden flex items-center space-x-4">
            <ThemeToggle />
            
            <button
              className="" // ƒê√£ x√≥a md:hidden v√¨ div cha ƒë√£ x·ª≠ l√Ω
              onClick={() => setIsMenuOpen(!isMenuOpen)}
              aria-label="Toggle navigation"
            >
              {isMenuOpen ? (
                // Icon 'X'
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  strokeWidth={1.5}
                  stroke="currentColor"
                  className="w-6 h-6 cursor-pointer"
                >
                  <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    d="M6 18 18 6M6 6l12 12"
                  />
                </svg>
              ) : (
                // Icon 'Hamburger'
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  strokeWidth={1.5}
                  stroke="currentColor"
                  className="w-6 h-6 cursor-pointer"
                >
                  <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"
                  />
                </svg>
              )}
            </button>
          </div>
        </div>
      </Container>

      {/* Menu di ƒë·ªông (Gi·ªØ nguy√™n) */}
      <div
        className={`fixed left-0 right-0 top-full h-screen bg-gray-900/75 backdrop-blur-lg border-b shadow-lg md:hidden transition-all duration-300 ease-in-out ${
          isMenuOpen ? 'block opacity-100' : 'hidden opacity-0'
        }`}
      >
       <nav className="flex flex-col ps-10 space-y-8 p-5 text-4xl font-bold text-white mt-5">
          <Link href="/thuong-mai" className="menu-link-glow" onClick={handleLinkClick}>
            Th∆∞∆°ng m·∫°i
          </Link>
          <Link href="/thoi-trang" className="menu-link-glow" onClick={handleLinkClick}>
            Th·ªùi trang
          </Link>
          <Link href="/ca-nhan" className="menu-link-glow" onClick={handleLinkClick}>
            C√° nh√¢n
          </Link>
          <Link href="/dich-vu" className="menu-link-glow" onClick={handleLinkClick}>
            D·ªãch V·ª•
          </Link>
          <Link href="/gioi-thieu" className="menu-link-glow" onClick={handleLinkClick}>
            Gi·ªõi thi·ªáu
          </Link>
        </nav>
      </div>
    </header>
  );
}
```

## File: src/data/projects-master-data.ts
```typescript
// src/data/projects-master-data.ts
import { StaticImageData } from 'next/image';

// --- IMPORT ·∫¢NH (Gi·ªØ nguy√™n) ---
import Fashion_01_thumnails from '../assets/project/thoi-trang/Fashion_01_thumnails.webp';
import Fashion_02_thumnails from '../assets/project/thoi-trang/Fashion_02_thumnails.webp';
import Fashion_03_thumnails from '../assets/project/thoi-trang/Fashion_03_thumnails.webp';

import Commercial_01_thumnails from '../assets/project/thuong-mai/Commercial_01_thumnails.webp';
import Commercial_02_thumnails from '../assets/project/thuong-mai/Commercial_02_thumnails.webp';
import Commercial_02_01 from '../assets/project/thuong-mai/Commercial_02_01.webp';
import Commercial_02_02 from '../assets/project/thuong-mai/Commercial_02_02.webp';
import Commercial_02_03 from '../assets/project/thuong-mai/Commercial_02_03.webp';

import Personal_01_thumnails from '../assets/project/ca-nhan/Personal_01_thumnails.webp';

import Personal_02_thumnails from '../assets/project/ca-nhan/Personal_02_thumnails.webp';
import Personal_02_02 from '../assets/project/ca-nhan/Personal_02_02.webp';
import Personal_02_03 from '../assets/project/ca-nhan/Personal_02_03.webp';
import Personal_02_04 from '../assets/project/ca-nhan/Personal_02_04.webp';
import Personal_02_05 from '../assets/project/ca-nhan/Personal_02_05.webp';
import Personal_02_06 from '../assets/project/ca-nhan/Personal_02_06.webp';
import Personal_02_07 from '../assets/project/ca-nhan/Personal_02_07.webp';
import Personal_02_08 from '../assets/project/ca-nhan/Personal_02_08.webp';
import Personal_02_09 from '../assets/project/ca-nhan/Personal_02_09.webp';

// --- 1. ƒê·ªäNH NGHƒ®A TYPE CHU·∫®N (Kh·ªõp v·ªõi Supabase Logic) ---

export type ArticleBlock = 
  | { type: 'heading'; content: string }
  | { type: 'paragraph'; content: string }
  | { type: 'imageRow'; images: (StaticImageData | string)[] }; // Cho ph√©p c·∫£ URL string v√† StaticImport

export interface ProjectData {
  id: number;
  slug: string;
  title: string;
  client_name?: string; // T√™n hi·ªÉn th·ªã ph·ª• (VD: Zara, Dior...)
  
  // Image: Cho ph√©p c·∫£ StaticImageData (Demo) v√† string URL (Supabase)
  image: StaticImageData | string; 
  
  category: string;      // Slug danh m·ª•c (vd: thoi-trang)
  categoryName: string;  // T√™n hi·ªÉn th·ªã (vd: Th·ªùi trang)
  
  year: string;
  
  // Grid Layout (D√πng s·ªë nguy√™n ƒë·ªÉ t√≠nh to√°n logic k√©o th·∫£)
  colSpan: number; 
  rowSpan: number; 
  
  isFeatured: boolean;   // Thay cho featured?
  
  // Chi ti·∫øt b√†i vi·∫øt
  description?: string;
  credits?: { label: string; value: string }[];
  articleBody?: ArticleBlock[];
  align?: 'left' | 'right';
}

// --- 2. D·ªÆ LI·ªÜU MASTER (D√πng cho Demo Mode) ---

export const PROJECTS_MASTER_DATA: ProjectData[] = [
  // ----------------------------------------------------
  // D·ª∞ √ÅN 1: THANH XU√ÇN
  // ----------------------------------------------------
  {
    id: 1,
    slug: 'thanh-xuan-vuon-truong',
    title: 'Thanh xu√¢n v∆∞·ªùn tr∆∞·ªùng',
    client_name: 'Personal Project',
    image: Fashion_01_thumnails,
    category: 'thoi-trang',
    categoryName: 'Th·ªùi trang',
    year: '2023',
    colSpan: 2, // 2 c·ªôt
    rowSpan: 2, // 2 h√†ng
    isFeatured: false,
    description: "V∆∞·ª£t ra ngo√†i gi·ªõi h·∫°n c·ªßa m·ªôt b·ªô ƒë·ªìng ph·ª•c, d·ª± √°n n√†y l√† m·ªôt cu·ªôc ƒë·ªëi tho·∫°i v·ªõi k√Ω ·ª©c. N√≥ t√°i ƒë·ªãnh nghƒ©a kh√¥ng gian quen thu·ªôc c·ªßa s√¢n tr∆∞·ªùng, bi·∫øn n√≥ th√†nh m·ªôt s√†n di·ªÖn c·ªßa ho√†i ni·ªám.",
    credits: [
      { label: 'Producer', value: 'Thanh Hang - Choo Production' },
      { label: 'Art Director', value: 'Thien Nguyen' },
      { label: 'Photographer', value: 'Evis Tran' },
      { label: 'Location', value: 'Oni Studio' },
    ],
    articleBody: [
      { type: 'heading', content: 'Di s·∫£n c·ªßa ho√†i ni·ªám' },
      { type: 'imageRow', images: [Fashion_01_thumnails, Fashion_01_thumnails] },
      { type: 'paragraph', content: "B·ªëi c·∫£nh s√¢n tr∆∞·ªùng kh√¥ng ch·ªâ l√† ph√¥ng n·ªÅn; n√≥ l√† m·ªôt nh√¢n v·∫≠t. √Ånh s√°ng t·ª± nhi√™n ƒë∆∞·ª£c l·ªçc qua t√°n l√°, t·∫°o ra s·ª± t∆∞∆°ng ph·∫£n m·ªÅm m·∫°i." },
      { type: 'heading', content: 'Chi ti·∫øt v√† tƒ©nh l·∫∑ng' },
      { type: 'imageRow', images: [Fashion_01_thumnails] },
      { type: 'paragraph', content: "S·ª± t·∫≠p trung v√†o chi ti·∫øt bi·∫øn b·ªô ƒë·ªìng ph·ª•c t·ª´ m·ªôt quy ƒë·ªãnh tr·ªü th√†nh m·ªôt bi·ªÉu t∆∞·ª£ng c·ªßa c√° t√≠nh." }
    ]
  },

  // ----------------------------------------------------
  // D·ª∞ √ÅN 2: CH·ª¶ M√î H√åNH (ZARA)
  // ----------------------------------------------------
  {
    id: 2,
    slug: 'chu-mo-hinh-zara',
    title: 'Ch·ªß m√¥ h√¨nh',
    client_name: 'ZARA',
    image: Commercial_01_thumnails,
    category: 'thuong-mai',
    categoryName: 'Th∆∞∆°ng m·∫°i',
    year: '2024',
    colSpan: 1,
    rowSpan: 1,
    isFeatured: false,
    description: "Trong l√£nh ƒë·ªãa c·ªßa e-commerce, s·ª± t·ªëi gi·∫£n l√† tuy√™n ng√¥n t·ªëi th∆∞·ª£ng. D·ª± √°n n√†y lo·∫°i b·ªè m·ªçi chi ti·∫øt th·ª´a ƒë·ªÉ t·∫≠p trung v√†o b·∫£n ch·∫•t thu·∫ßn t√∫y.",
    credits: [
      { label: 'Client', value: 'ZARA' },
      { label: 'Photographer', value: 'Evis Tran' },
      { label: 'Location', value: 'Oni Studio' },
    ],
    articleBody: [
      { type: 'heading', content: 'Ki·∫øn tr√∫c c·ªßa √°nh s√°ng' },
      { type: 'imageRow', images: [Commercial_01_thumnails] },
      { type: 'paragraph', content: "√Ånh s√°ng ƒë∆∞·ª£c s·ª≠ d·ª•ng nh∆∞ m·ªôt 'con dao ƒëi√™u kh·∫Øc', t√°ch ch·ªß th·ªÉ kh·ªèi n·ªÅn x√°m tr∆°n." },
      { type: 'heading', content: 'S·ª± tƒ©nh l·∫∑ng c·ªßa chuy·ªÉn ƒë·ªông' },
      { type: 'imageRow', images: [Commercial_01_thumnails, Commercial_01_thumnails] },
      { type: 'paragraph', content: "M·ªói d√°ng pose l√† k·∫øt qu·∫£ c·ªßa k·ª∑ lu·∫≠t, t·∫°o ra nh·ªØng h√¨nh ·∫£nh m·∫°nh m·∫Ω v√† tr·ª±c di·ªán." }
    ]
  },

  // ----------------------------------------------------
  // D·ª∞ √ÅN 3: C√Å NH√ÇN 01
  // ----------------------------------------------------
  {
    id: 3,
    slug: 'ca-nhan-01',
    title: 'Portrait Series 01',
    client_name: 'C√° nh√¢n',
    image: Personal_01_thumnails,
    category: 'ca-nhan',
    categoryName: 'C√° nh√¢n',
    year: '2023',
    colSpan: 1,
    rowSpan: 2,
    isFeatured: false,
    description: "Nhi·∫øp ·∫£nh ch√¢n dung kh√¥ng ph·∫£i l√† ghi l·∫°i m·ªôt khu√¥n m·∫∑t, m√† l√† b·∫Øt gi·ªØ m·ªôt th·∫ø gi·ªõi n·ªôi t√¢m.",
    credits: [
      { label: 'Photographer', value: 'Evis Tran' },
      { label: 'Model', value: 'Mai Phuoc Tri' },
    ],
    articleBody: [
      { type: 'heading', content: 'V·∫ª ƒë·∫πp c·ªßa Chiaroscuro' },
      { type: 'imageRow', images: [Personal_01_thumnails, Personal_01_thumnails, Personal_01_thumnails] },
      { type: 'paragraph', content: "Ch√∫ng t√¥i ch·ªçn √°nh s√°ng c·ª≠a s·ªï duy nh·∫•t ƒë·ªÉ t√¥n vinh ngh·ªá thu·∫≠t t∆∞∆°ng ph·∫£n Chiaroscuro." }
    ]
  },

  // ----------------------------------------------------
  // D·ª∞ √ÅN 4: HOKKAIDO 
  // ----------------------------------------------------
  {
    id: 4,
    slug: 'ngon-lua-giua-tuyet',
    title: 'Ng·ªçn l·ª≠a gi·ªØa Tuy·∫øt',
    client_name: 'Editorial',
    image: Fashion_02_thumnails,
    category: 'thoi-trang',
    categoryName: 'Th·ªùi trang',
    year: '2024',
    colSpan: 1,
    rowSpan: 2,
    isFeatured: false,
    description: "D·ª± √°n c√° nh√¢n n√†y kh√°m ph√° s·ª± t∆∞∆°ng ph·∫£n gi·ªØa c√°i l·∫°nh bu·ªët c·ªßa ngo·∫°i c·∫£nh v√† h∆°i ·∫•m n·ªôi t√¢m.",
    credits: [
      { label: 'Location', value: 'Hokkaido, Japan' },
      { label: 'Photographer', value: 'Evis Tran' },
    ],
    articleBody: [
      { type: 'heading', content: 'S·ª©c s·ªëng m·ªèng manh' },
      { type: 'imageRow', images: [Fashion_02_thumnails, Fashion_02_thumnails] },
      { type: 'paragraph', content: "Gi·ªØa khung c·∫£nh bao la c·ªßa tuy·∫øt tr·∫Øng, √°nh l·ª≠a ƒë·ªè cam tr·ªü th√†nh tuy√™n ng√¥n duy nh·∫•t v·ªÅ s·ª± t·ªìn t·∫°i." }
    ]
  },

  // ----------------------------------------------------
  // D·ª∞ √ÅN 5: L'OFFICIEL 
  // ----------------------------------------------------
  {
    id: 5,
    slug: 'hoi-tho-golden-hour',
    title: "H∆°i th·ªü 'Golden Hour'",
    client_name: "L'Officiel Vietnam",
    image: Fashion_03_thumnails,
    category: 'thoi-trang',
    categoryName: 'Th·ªùi trang',
    year: '2023',
    colSpan: 2,
    rowSpan: 1,
    isFeatured: true,
    description: "M·ªôt b·ªô ·∫£nh editorial kh√°m ph√° s·ª± k·∫øt n·ªëi gi·ªØa con ng∆∞·ªùi v√† thi√™n nhi√™n trong kho·∫£nh kh·∫Øc v√†ng.",
    credits: [
      { label: 'Client', value: "L'Officiel" },
      { label: 'Photographer', value: 'Evis Tran' },
    ],
    articleBody: [
      { type: 'heading', content: 'ƒê·ªëi tho·∫°i v·ªõi ho√†ng h√¥n' },
      { type: 'imageRow', images: [Fashion_03_thumnails, Fashion_03_thumnails] },
      { type: 'paragraph', content: "Golden hour l√† kho·∫£nh kh·∫Øc √°nh s√°ng kh√¥ng ch·ªâ chi·∫øu r·ªçi, m√† c√≤n 'ch·∫°m' v√†o v·∫°n v·∫≠t." }
    ]
  },

  // ----------------------------------------------------
  // D·ª∞ √ÅN 6: DIOR 
  // ----------------------------------------------------
  {
    id: 6,
    slug: 'khoanh-khac-playful-dior',
    title: "Kho·∫£nh kh·∫Øc 'Playful' Dior",
    client_name: 'Dior Beauty',
    image: Commercial_02_thumnails,
    category: 'thuong-mai',
    categoryName: 'Th∆∞∆°ng m·∫°i',
    year: '2024',
    colSpan: 1,
    rowSpan: 1,
    isFeatured: true,
    description: "N·∫Øm b·∫Øt tinh th·∫ßn tr·∫ª trung, ph√° c√°ch t·∫°i s·ª± ki·ªán ƒë·ªôc quy·ªÅn c·ªßa Dior.",
    credits: [
      { label: 'Client', value: 'Dior' },
      { label: 'Photographer', value: 'Evis Tran' },
    ],
    articleBody: [
      { type: 'heading', content: 'Tuy√™n ng√¥n c·ªßa s·ª± n·ªïi lo·∫°n' },
      { type: 'imageRow', images: [Commercial_02_thumnails] },
      { type: 'imageRow', images: [Commercial_02_01, Commercial_02_02] },
      { type: 'imageRow', images: [Commercial_02_thumnails, Commercial_02_03] },
      { type: 'paragraph', content: "Kho·∫£nh kh·∫Øc 'playful' ph√° v·ª° s·ª± trang tr·ªçng c·ªßa di s·∫£n Dior." }
    ]
  },

  // ----------------------------------------------------
  // D·ª∞ √ÅN 7: SG 1990 
  // ----------------------------------------------------
  {
    id: 7,
    slug: 'net-lang-du-sai-gon-thap-nien-90',
    title: "N√©t L√£ng Du S√†i G√≤n",
    client_name: 'Personal Project',
    image: Personal_02_thumnails,
    category: 'ca-nhan',
    categoryName: 'C√° nh√¢n',
    year: '2022',
    colSpan: 1,
    rowSpan: 1,
    isFeatured: true,
    description: "Kh√¥ng kh√≠ ho√†i c·ªï, l√£ng m·∫°n v√† c√≥ ch√∫t b·ª•i b·∫∑m c·ªßa S√†i G√≤n nh·ªØng nƒÉm 90.",
    credits: [
      { label: 'Concept', value: 'Saigon 1990' },
      { label: 'Photographer', value: 'Evis Tran' },
    ],
    articleBody: [
      { type: 'heading', content: '√ù T∆∞·ªüng & Ch·ªß ƒê·ªÅ' },
      { type: 'imageRow', images: [Personal_02_thumnails] },
      { type: 'imageRow', images: [Personal_02_02, Personal_02_03, Personal_02_04] },
      { type: 'imageRow', images: [Personal_02_05, Personal_02_06, Personal_02_07] },
      { type: 'imageRow', images: [Personal_02_thumnails, Personal_02_08, Personal_02_09] },
      { type: 'paragraph', content: "T√°i hi·ªán l·∫°i kh√¥ng kh√≠ ho√†i c·ªï, l√£ng m·∫°n c·ªßa S√†i G√≤n x∆∞a." }
    ]
  },
];
```

## File: next.config.ts
```typescript
// next.config.ts
import type { NextConfig } from "next";

const nextConfig: NextConfig = {


  images: {
    remotePatterns: [
      {
        protocol: 'https',

        hostname: '**.supabase.co',

      },
      {
        protocol: 'https',
        hostname: 'images.unsplash.com',
      }
    ],
  },

  // T·∫Øt strict mode n·∫øu mu·ªën (optional), nh∆∞ng n√™n ƒë·ªÉ true
  reactStrictMode: true, 
  
  // T·∫Øt c·∫£nh b√°o ESLint l√∫c build ƒë·ªÉ tr√°nh fail build v√¨ l·ªói nh·ªè (Optional)
  eslint: {
    ignoreDuringBuilds: true,
  },
  typescript: {
    ignoreBuildErrors: true,
  }
};

export default nextConfig;
```

## File: src/app/admin/projects/page.tsx
```typescript
// src/app/admin/projects/page.tsx
import Link from 'next/link';
import { getProjects, getCurrentUserProfile } from '@/lib/actions';
import { Plus } from 'lucide-react';
import ProjectTable from '@/components/admin/ProjectTable';
import { createClient } from '@supabase/supabase-js'; 


export default async function ProjectsListPage() {
  const [projects, userProfile] = await Promise.all([
    getProjects('all'),
    getCurrentUserProfile(), // 2. L·∫•y th√¥ng tin user
  ]);
  const supabase = createClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
  );
  const { data: setting } = await supabase
    .from('settings')
    .select('value')
    .eq('key', 'items_per_page')
    .single();
  const itemsLimit = setting?.value ? parseInt(setting.value) : 10;
  return (
    <div className="max-w-7xl mx-auto space-y-6 pb-20">
      
      {/* Header */}
      <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
        <div>
          <h1 className="text-3xl font-bold text-[var(--admin-fg)]">Qu·∫£n l√Ω D·ª± √°n</h1>
          <p className="text-[var(--admin-sub)] mt-1">
            Qu·∫£n l√Ω danh m·ª•c d·ª± √°n v√† chi ti·∫øt n·ªôi dung.
          </p>
        </div>
        {userProfile?.role === 'Admin' && (
          <Link 
            href="/admin/projects/new" 
            className="flex items-center gap-2 px-5 py-2.5 bg-[var(--admin-primary)] text-[var(--admin-bg)] rounded-lg font-medium hover:opacity-90 transition-all shadow-lg shadow-indigo-500/30"
          >
            <Plus size={20} /> Th√™m d·ª± √°n m·ªõi
          </Link>
        )}
      </div>

      {/* Client Table Component (X·ª≠ l√Ω Search & Infinite Scroll) */}
      <ProjectTable initialProjects={projects} itemsPerPage={itemsLimit} userProfile={userProfile} />
      
    </div>
  );
}
```

## File: src/app/admin/settings/page.tsx
```typescript
// src/app/admin/settings/page.tsx
import SettingsForm from '@/components/admin/SettingsForm';
import { Settings } from 'lucide-react';
import { createServerClient } from '@supabase/ssr'; 
import { cookies } from 'next/headers'; 
import { redirect } from 'next/navigation'; 
import { getSettings, getCleanupMinutes } from '@/lib/actions/settings';

export default async function AdminSettingsPage() {
  const cookieStore = await cookies(); 
  
  // 1. Fetch d·ªØ li·ªáu song song (Server Side)
  const [settings, cleanupMinutes] = await Promise.all([
    getSettings(),
    getCleanupMinutes()
  ]);

  const supabase = createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() { return cookieStore.getAll() },
        setAll() {} 
      },
    }
  );

  const { data: { user } } = await supabase.auth.getUser();
  if (!user) redirect('/login');

  const { data: profile } = await supabase
    .from('users')
    .select('role')
    .eq('auth_id', user.id)
    .single();

  if (profile?.role !== 'Admin') {
    redirect('/admin');
  }

  // --- X√ìA D√íNG N√ÄY (V√¨ bi·∫øn settings ƒë√£ c√≥ ·ªü tr√™n d√≤ng 14) ---
  // const settings = await getSettings(); 

  return (
    <div className="max-w-7xl mx-auto pb-20">
      <div className="mb-8">
        <h1 className="text-3xl font-bold text-[var(--admin-fg)] flex items-center gap-3">
          <Settings className="text-[var(--admin-primary)]" size={32} />
          C√†i ƒë·∫∑t chung
        </h1>
        <p className="text-[var(--admin-sub)] mt-2">
          Qu·∫£n l√Ω c√°c th√¥ng s·ªë c·∫•u h√¨nh to√†n c·ª•c c·ªßa h·ªá th·ªëng.
        </p>
      </div>

      <SettingsForm 
        initialSettings={settings} 
        initialCleanupMinutes={cleanupMinutes} // Gi·ªù Props n√†y s·∫Ω h·ª£p l·ªá sau khi s·ª≠a b∆∞·ªõc 2
      />
    </div>
  );
}
```

## File: src/app/dich-vu/page.tsx
```typescript
// app/dich-vu/page.tsx
'use client'; // B·∫Øt bu·ªôc v√¨ d√πng state v√† hooks

import React, { useState, useEffect, useRef } from 'react';
import Container from '@/components/Container';
import styles from '../styles/DichVu.module.css';
import Image from 'next/image';
import BtsSection from '@/components/BtsSection';
// ROOM IMAGES
import room_A_img from '../../assets/service/section_01/room_A.webp';
import room_B_img from '../../assets/service/section_01/room_B.webp';
import room_C_img from '../../assets/service/section_01/room_C.webp';
import room_D_img from '../../assets/service/section_01/room_D.webp';

// DEVICE IMAGES
import img_godox_dp600 from '../../assets/service/section_02/GODOX-DP600III-V.webp';
import img_godox_dp400 from '../../assets/service/section_02/GODOX-GD-DP400II-V.webp';
import img_godox_qt400 from '../../assets/service/section_02/GODOX-QT400IIIM.webp';
import img_godox_qt600 from '../../assets/service/section_02/GODOX-QT600II.webp';
import img_godox_qs400 from '../../assets/service/section_02/GODOX-QS-400.webp';
import img_godox_qs800 from '../../assets/service/section_02/GODOX-QS-800.webp';
import img_godox_qs1200 from '../../assets/service/section_02/GODOX-QS-1200.webp';
import img_amaran_300c from '../../assets/service/section_02/aputure-amaran-300c.webp';
import img_devices from '../../assets/service/section_02/devices.webp';

// MODIFIER IMAGES
import img_QR_p60t from '../../assets/service/section_02/GODOX-QR-P60T.webp';
import img_QR_p90 from '../../assets/service/section_02/GODOX-QR-P90.webp';
import img_QR_P120 from '../../assets/service/section_02/GODOX-QR-P120.webp';
import img_QR_P150t from '../../assets/service/section_02/GODOX-QR-P150T.webp';

// 1. ƒê·ªäNH NGHƒ®A C√ÅC M·ª§C (Sections) - (Gi·ªØ nguy√™n, ƒë√£ ƒë√∫ng)
const sections = [
  { id: 'bao-gia', title: 'B√°o Gi√° Ph√≤ng', contentId: 'section-01' },
  { id: 'thiet-bi-mien-phi', title: 'Thi·∫øt B·ªã ƒêi K√®m', contentId: 'section-02' },
  { id: 'thiet-bi-thue-them', title: 'Thi·∫øt B·ªã Thu√™ Th√™m', contentId: 'section-03' },
  { id: 'quy-dinh', title: 'L∆∞u √ù & Quy ƒê·ªãnh', contentId: 'section-04' },
];

// 2. COMPONENT "SCENE" (Gi·ªØ nguy√™n)
interface SceneProps {
  children: React.ReactNode;
  id: string;
  onVisible: (id: string) => void;
}

const Scene: React.FC<SceneProps> = ({ children, id, onVisible }) => {
  const ref = useRef<HTMLDivElement>(null);

useEffect(() => {
    const node = ref.current;
    if (!node) return;

    const observer = new IntersectionObserver(
      (entries) => {
        const [entry] = entries;
        if (entry.isIntersecting) {
          onVisible(id); // B√°o cho component cha bi·∫øt m·ª•c n√†y ƒëang active
        }
      },
      {
        rootMargin: '-50% 0px 0% 0px',
        threshold: 0,
      }
    );

    observer.observe(node);
    return () => observer.disconnect();
  }, [id, onVisible]);

  return (
    <div ref={ref} id={id} className={styles.sceneContent}>
      {children}
    </div>
  );
};
// 3. COMPONENT TRANG CH√çNH
export default function DichVuPage() {
  const [activeId, setActiveId] = useState(sections[0].id);
  
  // D·ªØ li·ªáu cho Section 02 (Mi·ªÖn Ph√≠)
  const strobes = [
    { name: 'Godox DP400', img: img_godox_dp400 },
    { name: 'Godox DP600', img: img_godox_dp600 },
    { name: 'Godox QT400', img: img_godox_qt400 },
    { name: 'Godox QT600', img: img_godox_qt600 },
    { name: 'Godox QS400', img: img_godox_qs400 },
    { name: 'Godox QS800', img: img_godox_qs800 },
    { name: 'Godox QS1200', img: img_godox_qs1200 },
    { name: 'Aputure Amaran 300C', img: img_amaran_300c },

  ];

  const modifiers = [
    { name: 'Godox QR P60T', img: img_QR_p60t },
    { name: 'Godox QR P90', img: img_QR_p90 },
    { name: 'Godox QR P120', img: img_QR_P120 },
    { name: 'Godox QR P150T', img: img_QR_P150t },
  ];

  const rentalItems = [
    { name: 'Nanlite FS300B', price: '300k/ƒë√®n', note: '(c√≥ s·∫µn 2 ƒë√®n)' },
    { name: 'Nanlite FS200B', price: '200k/ƒë√®n', note: '(c√≥ s·∫µn 3 ƒë√®n)' },
    { name: 'Tolifo 1800W-Bi', price: '400k/ƒë√®n', note: '(c√≥ s·∫µn 1 ƒë√®n)' },
    { name: 'Nanlite FS150', price: '150k/ƒë√®n', note: '(c√≥ s·∫µn 1 ƒë√®n)' },
    { name: 'Nanlite Forza 60', price: '50k/ƒë√®n', note: '(c√≥ s·∫µn 2 ƒë√®n)' },
    { name: 'Tether (d√¢y)', price: '75k/d√¢y' },
    { name: 'iMac 27" 5k', price: '250k/bu·ªïi' },
    { name: 'M√†n Dell 25"', price: '150k/bu·ªïi' },
    { name: 'Ph√¥ng v·∫£i/xanh key (6x6.4m)', price: '200k' },
  ];

  const paperColors = [
    { name: '44 Jet', hex: '#1f1f1f' },
    { name: '04 Neutral Grey', hex: '#7c7f7e' },
    { name: '42 Morning Mist', hex: '#d9dadb' },
    { name: '01 Deep Blue', hex: '#35475e' },
    { name: '41 Marine Blue', hex: '#69819d' },
    { name: '61 Blue Lake', hex: '#4c7da6' },
    { name: '06 Nassau', hex: '#008bc0' },
    { name: '59 Lite Blue', hex: '#70c5d5' },
    { name: '55 Alpine', hex: '#b3d8d6' },
    { name: '67 Nutmeg', hex: '#8e6f5c' },
    { name: '33 Ivorine', hex: '#e5d9bb' },
    { name: '13 Deep Green', hex: '#1e4a42' },
    { name: '10 Leaf', hex: '#485f39' },
    { name: '54 Stinger', hex: '#78a34b' },
    { name: '63 Apple', hex: '#b7d296' },
    { name: '14 Forsythia Yellow', hex: '#f3c421' },
    { name: '83 Yellow-Orange', hex: '#f5822e' },
    { name: '27 Flame', hex: '#d44a3b' },
    { name: '56 Scarlet', hex: '#ba2429' },
    { name: '10 Bright Orange', hex: '#f3642c' },
    { name: '29 Thistle', hex: '#d6a9b9' },
    { name: '17 Carnation Pink', hex: '#f093a5' },
  ];

  // M·∫£ng 2: Ph√¥ng V·∫£i Tr∆°n
  const fabricColorsPlain = [
    { name: 'ƒêen', hex: '#000000' },
    { name: 'ƒê·ªè', hex: '#cc3333' },
    { name: 'Xanh', hex: '#006633' },
  ];
  
  // M·∫£ng 3: Ph√¥ng V·∫£i Loang
  const fabricColorsPatterned = [
    { name: 'N√¢u Loang', hex: '#8c7a65' },
    { name: 'X√°m S√°ng Loang', hex: '#c1c1c1' },
    { name: 'X√°m T·ªëi Loang', hex: '#6e6e6e' },
  ];
  
  // M·∫£ng 4: Th·∫£m N·ªâ
  const carpetColors = [
    { name: 'ƒê·ªè ƒê√¥', hex: '#800000' },
    { name: 'Xanh Navy', hex: '#000080' },
  ];
  return (
    <main>
      <Container className="py-16 md:py-24">
        {/* Ti√™u ƒë·ªÅ chung c·ªßa trang */}
        <div className="text-center mb-16">
          <h1 className="text-4xl md:text-5xl font-light tracking-tighter">
            D·ªãch V·ª• & B√°o Gi√°
          </h1>
          <p className="text-lg mt-4 text-[var(--sub-text)]">
            T·∫•t c·∫£ th√¥ng tin v·ªÅ c√°c g√≥i thu√™ v√† thi·∫øt b·ªã t·∫°i studio.
          </p>
        </div>

        {/* B·ªê C·ª§C 2 C·ªòT */}
        <div className={styles.stickyLayout}>
          {/* C·ªòT 1: MENU (D√çNH L·∫†I) */}
          <nav className={styles.stickyNav}>
            <ul>
              {sections.map((section) => (
                <li key={section.id}>
                  <a
                    href={`#${section.id}`}
                    className={activeId === section.id ? styles.active : ''}
                  >
                    {section.title}
                  </a>
                </li>
              ))}
            </ul>
          </nav>

          {/* C·ªòT 2: N·ªòI DUNG (CU·ªòN) */}
          <main className={styles.contentColumn}>
            {/* === M·ª§C 01: B√ÅO GI√Å PH√íNG === */}
            <Scene id="bao-gia" onVisible={setActiveId}>
              <h2 className={styles.contentTitle}>B√°o Gi√° Thu√™ Ph√≤ng</h2>
              
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6 lg:gap-8">
                
                {/* --- TH·∫∫ 1: ROOM A --- */}
                <div className="border border-[var(--foreground)]/30 rounded-lg overflow-hidden bg-[var(--background)] flex flex-col">
                  <div className="relative w-full h-72">
                    <Image
                      src={room_A_img}
                      alt="Kh√¥ng gian ph√≤ng studio A"
                      fill
                      sizes="(max-width: 768px) 100vw, 50vw"
                      className="object-cover"
                      priority
                      placeholder="blur"
                    />
                  </div>
                  <div className="p-6 flex flex-col flex-grow">
                    <h3 className="text-2xl font-semibold mb-4">Room A</h3>
                    <div className="mb-4">
                      <span className="text-4xl font-bold">300k</span>
                      <span className="text-lg text-[var(--foreground)]/70">/gi·ªù</span>
                      <p className="text-sm text-[var(--foreground)]/70 -mt-1">
                        (√Åp d·ª•ng cho l·ªãch book t·ª´ 2 ti·∫øng)
                      </p>
                    </div>
                    <div className="mb-5 p-3 bg-[var(--foreground)]/5 border border-[var(--foreground)]/10 rounded-lg">
                      <span className="text-2xl font-bold">350k</span>
                      <span className="text-base text-[var(--foreground)]/70">/gi·ªù</span>
                      <p className="text-sm text-[var(--foreground)]/70">
                        (Cho l·ªãch book d∆∞·ªõi 2 ti·∫øng)
                      </p>
                    </div>
                    <ul className="space-y-1 text-sm list-disc list-inside mt-auto">
                      <li>60m¬≤</li>
                      <li>(D8,5 x R5,8 x C4,3)</li>
                    </ul>
                  </div>
                </div>

                {/* --- TH·∫∫ 2: ROOM B --- */}
                <div className="border border-[var(--foreground)]/30 rounded-lg overflow-hidden bg-[var(--background)] flex flex-col">
                  <div className="relative w-full h-72">
                    <Image
                      src={room_B_img}
                      alt="Kh√¥ng gian ph√≤ng studio B"
                      fill
                      sizes="(max-width: 768px) 100vw, 50vw"
                      className="object-cover"
                      priority={true}
                      placeholder="blur" 
                    />
                  </div>
                  <div className="p-6 flex flex-col flex-grow">
                    <h3 className="text-2xl font-semibold mb-4">Room B</h3>
                    <div className="mb-4">
                      <span className="text-4xl font-bold">300k</span>
                      <span className="text-lg text-[var(--foreground)]/70">/gi·ªù</span>
                      <p className="text-sm text-[var(--foreground)]/70 -mt-1">
                        (√Åp d·ª•ng cho l·ªãch book t·ª´ 2 ti·∫øng)
                      </p>
                    </div>
                    <div className="mb-5 p-3 bg-[var(--foreground)]/5 border border-[var(--foreground)]/10 rounded-lg">
                      <span className="text-2xl font-bold">350k</span>
                      <span className="text-base text-[var(--foreground)]/70">/gi·ªù</span>
                      <p className="text-sm text-[var(--foreground)]/70">
                        (Cho l·ªãch book d∆∞·ªõi 2 ti·∫øng)
                      </p>
                    </div>
                    <ul className="space-y-1 text-sm list-disc list-inside mt-auto">
                      <li>65m¬≤</li>
                      <li>(D9 x R3,7 x C3,8)</li>
                    </ul>
                  </div>
                </div>

                {/* --- TH·∫∫ 3: ROOM C --- */}
                <div className="border border-[var(--foreground)]/30 rounded-lg overflow-hidden bg-[var(--background)] flex flex-col">
                  <div className="relative w-full h-72">
                    <Image
                      src={room_C_img}
                      alt="Kh√¥ng gian ph√≤ng studio C"
                      fill
                      sizes="(max-width: 768px) 100vw, 50vw"
                      className="object-cover"
                      priority
                      placeholder="blur" 
                    />
                  </div>
                  <div className="p-6 flex flex-col flex-grow">
                    <h3 className="text-2xl font-semibold mb-4">Room C</h3>
                    <div className="mb-4">
                      <span className="text-4xl font-bold">300k</span>
                      <span className="text-lg text-[var(--foreground)]/70">/gi·ªù</span>
                      <p className="text-sm text-[var(--foreground)]/70 -mt-1">
                        (√Åp d·ª•ng cho l·ªãch book t·ª´ 2 ti·∫øng)
                      </p>
                    </div>
                    <div className="mb-5 p-3 bg-[var(--foreground)]/5 border border-[var(--foreground)]/10 rounded-lg">
                      <span className="text-2xl font-bold">350k</span>
                      <span className="text-base text-[var(--foreground)]/70">/gi·ªù</span>
                      <p className="text-sm text-[var(--foreground)]/70">
                        (Cho l·ªãch book d∆∞·ªõi 2 ti·∫øng)
                      </p>
                    </div>
                    <ul className="space-y-1 text-sm list-disc list-inside mt-auto">
                      <li>60m¬≤</li>
                      <li>(D8,6 x R6 x C3,9)</li>
                    </ul>
                  </div>
                </div>

                {/* --- TH·∫∫ 4: ROOM D --- */}
                <div className="border border-[var(--foreground)]/30 rounded-lg overflow-hidden bg-[var(--background)] flex flex-col">
                  <div className="relative w-full h-72">
                    <Image
                      src={room_D_img}
                      alt="Kh√¥ng gian ph√≤ng studio D"
                      fill
                      sizes="(max-width: 768px) 100vw, 50vw"
                      className="object-cover"
                      priority
                      placeholder="blur"
                    />
                  </div>
                  <div className="p-6 flex flex-col flex-grow">
                    <h3 className="text-2xl font-semibold mb-4">Room D</h3>
                    <div className="mb-4">
                      <span className="text-4xl font-bold">280k</span>
                      <span className="text-lg text-[var(--foreground)]/70">/gi·ªù</span>
                      <p className="text-sm text-[var(--foreground)]/70 -mt-1">
                        (√Åp d·ª•ng cho l·ªãch book t·ª´ 2 ti·∫øng)
                      </p>
                    </div>
                    <div className="mb-5 p-3 bg-[var(--foreground)]/5 border border-[var(--foreground)]/10 rounded-lg">
                      <span className="text-2xl font-bold">320k</span>
                      <span className="text-base text-[var(--foreground)]/70">/gi·ªù</span>
                      <p className="text-sm text-[var(--foreground)]/70">
                        (Cho l·ªãch book d∆∞·ªõi 2 ti·∫øng)
                      </p>
                    </div>
                    <ul className="space-y-1 text-sm list-disc list-inside mt-auto">
                      <li>45m¬≤</li>
                      <li>(D8,2 x R4,6 x C3,3)</li>
                    </ul>
                  </div>
                </div>
              </div> 
              
              <div className="mt-8">
                <div className="p-4 bg-[var(--foreground)]/5 border border-[var(--foreground)]/10 rounded-lg">
                  <p className="font-semibold text-center text-sm">
                    * Ph·ª• thu 50k/h n·∫øu c√≥ s·ª≠ d·ª•ng ƒë√®n LED (ƒë√®n quay phim).
                  </p>
                </div>
              </div>
            </Scene>


            <Scene id="thiet-bi-mien-phi" onVisible={setActiveId}>
              <h2 className={styles.contentTitle}>Thi·∫øt B·ªã ƒêi K√®m (Mi·ªÖn Ph√≠)</h2>

              {/* 1. ·∫¢NH HERO "WOW FACTOR" */}
              <div className="relative w-full h-72 md:h-96 rounded-lg overflow-hidden mb-12 border border-[var(--foreground)]/30">
                <Image
                  src={img_devices}
                  alt="To√†n b·ªô thi·∫øt b·ªã t·∫°i Oni Studio"
                  fill
                  className="object-cover hover:scale-110"
                  sizes="(max-width: 768px) 100vw, 70vw"
                  placeholder="blur"
                />
                <div className="absolute inset-0" />
              </div>

              {/* 2. GRID ƒê√àN STUDIO */}
              <h3 className="text-2xl font-semibold mb-6">ƒê√®n Godox</h3>
              <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                {strobes.map((item) => (
                  <div key={item.name} className="border border-[var(--foreground)]/30 rounded-lg overflow-hidden bg-[var(--background)] flex flex-col">
                    <div className="relative w-full h-40 bg-white">
                      <Image
                        src={item.img}
                        alt={item.name}
                        fill
                        sizes="(max-width: 768px) 50vw, 25vw"
                        className="object-contain p-2"
                        placeholder="blur"
                      />
                    </div>
                    <div className="p-4 text-center">
                      <h4 className="font-semibold text-sm">{item.name}</h4>
                    </div>
                  </div>
                ))}
              </div>
              <p className="text-center text-sm text-[var(--foreground)]/70 mb-12">
                (H·ªó tr·ª£ setup t·ªëi ƒëa 4 ƒë√®n flash)
              </p>

              {/* 3. GRID T·∫¢N S√ÅNG */}
              <h3 className="text-2xl font-semibold mb-6">T·∫£n S√°ng</h3>
              <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-12">
                {modifiers.map((item) => (
                  <div key={item.name} className="border border-[var(--foreground)]/30 rounded-lg overflow-hidden bg-[var(--background)] flex flex-col">
                    <div className="relative w-full h-40 bg-white">
                      <Image
                        src={item.img}
                        alt={item.name}
                        fill
                        sizes="(max-width: 768px) 50vw, 25vw"
                        className="object-contain p-2"
                        placeholder="blur"
                      />
                    </div>
                    <div className="p-4 text-center">
                      <h4 className="font-semibold text-sm">{item.name}</h4>
                    </div>
                  </div>
                ))}
              </div>

              {/* 4. PH√îNG N·ªÄN & PH·ª§ KI·ªÜN */}
              <h3 className="text-2xl font-semibold mb-6">Ph√¥ng N·ªÅn & Ph·ª• Ki·ªán</h3>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-8 p-6 bg-[var(--foreground)]/5 border border-[var(--foreground)]/10 rounded-lg">
                
                {/* --- C·ªòT 1: PH√îNG GI·∫§Y & T∆Ø·ªúNG (N·ªôi dung d√†i) --- */}
                <div>
                  <h4 className="text-lg font-semibold mb-4">Ph√¥ng Gi·∫•y & T∆∞·ªùng</h4>
                  
                  {/* T∆∞·ªùng V√¥ C·ª±c */}
                  <div className="mb-4">
                    <h5 className="text-base font-semibold mb-2">T∆∞·ªùng Tr·∫Øng V√¥ C·ª±c</h5>
                    <div className="flex items-center gap-2">
                      <div
                        className={styles.colorSwatch}
                        style={{ backgroundColor: '#ffffff' }}
                      />
                      <span className="text-sm">S·ª≠ d·ª•ng mi·ªÖn ph√≠</span>
                    </div>
                  </div>

                  {/* Ph√¥ng Gi·∫•y */}
                  <div>
                    <h5 className="text-base font-semibold mb-2">Ph√¥ng Gi·∫•y (11x2.7m)</h5>
                    <div className="flex flex-wrap gap-x-5 gap-y-3 mt-3">
                      {paperColors.map((color) => (
                        <div
                          key={color.name}
                          className={styles.colorSwatch}
                          style={{ backgroundColor: color.hex }}
                          title={color.name} // Hi·ªán t√™n khi hover
                        />
                      ))}
                    </div>
                  </div>

                  {/* Ph·ª• Ki·ªán Chung */}
                  <div>
                    <h4 className="text-lg font-semibold my-4">Ph·ª• Ki·ªán Chung</h4>
                    <ul className="space-y-1.5 list-disc list-inside text-sm">
                      <li>Ch√≥a ƒë√®n, Bandoor, D√π (ƒëen/tr·∫Øng/b·∫°c)</li>
                      <li>T·∫£n s√°ng, H·∫Øt s√°ng 5-in-1, Poly (ƒëen/tr·∫Øng)</li>
                      <li>Gel m√†u, Snoot (gom s√°ng), Ng√†m</li>
                      <li>C-stand, Boom, Ch√¢n ƒë√®n c√°c lo·∫°i</li>
                      <li>B√†n ch·ª•p s·∫£n ph·∫©m, Gh·∫ø ƒë√¥n</li>
                      <li>B√†n ·ªßi h∆°i n∆∞·ªõc, S√†o treo qu·∫ßn √°o</li>
                      <li>V√† nhi·ªÅu ph·ª• ki·ªán kh√°c...</li>
                    </ul>
                  </div>

                </div>

                {/* --- C·ªòT 2: V·∫¢I, TH·∫¢M & PH·ª§ KI·ªÜN (N·ªôi dung ng·∫Øn h∆°n) --- */}
                <div>
                  {/* Ph√¥ng V·∫£i & Th·∫£m */}
                  <div className="mb-6">
                    <h4 className="text-lg font-semibold mb-4">Ph√¥ng V·∫£i & Th·∫£m</h4>
                    {/* Ph√¥ng V·∫£i */}
                    <div className="mb-4">
                      <h5 className="text-base font-semibold mb-2">Ph√¥ng V·∫£i</h5>
                      <div className="flex gap-12">
                        {/* V·∫£i Tr∆°n */}
                        <div>
                          <h6 className="text-sm font-semibold mb-2 opacity-70">Tr∆°n</h6>
                          <div className="flex flex-wrap gap-x-4 gap-y-3">
                            {fabricColorsPlain.map((color) => (
                              <div
                                key={color.name}
                                className={styles.colorSwatch}
                                style={{ backgroundColor: color.hex }}
                                title={color.name}
                              />
                            ))}
                          </div>
                        </div>
                        {/* V·∫£i Loang */}
                        <div>
                          <h6 className="text-sm font-semibold mb-2 opacity-70">Loang</h6>
                          <div className="flex flex-wrap gap-x-4 gap-y-3">
                            {fabricColorsPatterned.map((color) => (
                              <div
                                key={color.name}
                                className={styles.colorSwatch}
                                style={{ 
                                  background: `radial-gradient(ellipse at center, ${color.hex} 50%, #5c5c5c 100%)`
                                }}
                                title={color.name}
                              />
                            ))}
                          </div>
                        </div>
                      </div>
                    </div>
                    {/* Th·∫£m N·ªâ */}
                    <div>
                      <h5 className="text-base font-semibold mb-2">Th·∫£m N·ªâ (5x3.66m)</h5>
                      <div className="flex flex-wrap gap-x-4 gap-y-3 mb-1">
                        {carpetColors.map((color) => (
                          <div
                            key={color.name}
                            className={styles.colorSwatch}
                            style={{ backgroundColor: color.hex }}
                            title={color.name}
                          />
                        ))}
                      </div>
                      <p className="text-xs text-[var(--foreground)]/70">
                        (Ph·ª• ph√≠ setup th·∫£m 100k)
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </Scene>

            <Scene id="thiet-bi-thue-them" onVisible={setActiveId}>
              <h2 className={styles.contentTitle}>Thi·∫øt B·ªã Thu√™ (T√≠nh Ph√≠)</h2>
              <p className="text-[var(--foreground)]/70 mb-6">
                C√°c thi·∫øt b·ªã chuy√™n d·ª•ng cho nhu c·∫ßu cao h∆°n, vui l√≤ng li√™n h·ªá tr∆∞·ªõc ƒë·ªÉ ki·ªÉm tra.
              </p>
              
              {/* B·∫£ng gi√° tr√™n desktop, layout th·∫ª tr√™n mobile */}
              <div className="overflow-x-auto border border-[var(--foreground)]/30 rounded-lg">
                <table className="w-full min-w-full text-sm text-left">
                  <thead className="border-b border-[var(--foreground)]/30 bg-[var(--foreground)]/5">
                    <tr>
                      <th className="py-3 px-4 font-semibold">Thi·∫øt B·ªã</th>
                      <th className="py-3 px-4 font-semibold">Gi√° Thu√™</th>
                      <th className="py-3 px-4 font-semibold">Ghi Ch√∫</th>
                    </tr>
                  </thead>
                  <tbody>
                    {rentalItems.map((item) => (
                      <tr key={item.name} className="border-b border-[var(--foreground)]/10">
                        <td className="py-3 px-4 font-medium">{item.name}</td>
                        <td className="py-3 px-4">{item.price}</td>
                        <td className="py-3 px-4 text-[var(--foreground)]/70">
                          {item.note}
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </Scene>
            <Scene id="quy-dinh" onVisible={setActiveId}>
              <h2 className={styles.contentTitle}>Ti·ªán √≠ch & Quy ƒê·ªãnh Chung</h2>
              
              {/* THAY ƒê·ªîI: Chuy·ªÉn sang grid-cols-5 ƒë·ªÉ chia 40% (col-span-2) / 60% (col-span-3) */}
              <div className="grid grid-cols-1 md:grid-cols-5 gap-8 p-6 bg-[var(--foreground)]/5 border border-[var(--foreground)]/10 rounded-lg">
                
                {/* C·ªôt 1: Ti·ªán √çch (40%) */}
                <div className="md:col-span-2"> {/* S·ª≠a t·ª´ md:col-5 */}
                  <h4 className="text-lg font-semibold mb-4">Ti·ªán √≠ch Studio</h4>
                  <ul className="space-y-2 list-disc list-inside text-sm">
                    <li>Mi·ªÖn ph√≠ h·ªó tr·ª£ setup √°nh s√°ng ban ƒë·∫ßu.</li>
                    <li>Mini Canteen ph·ª•c v·ª• (c√≥ t√≠nh ph√≠).</li>
                    <li>Khu v·ª±c makeup ri√™ng bi·ªát, mi·ªÖn ph√≠.</li>
                    <li>H·ªó tr·ª£ b√†n ·ªßi h∆°i n∆∞·ªõc.</li>
                  </ul>
                </div>
                
                {/* C·ªôt 2: L∆∞u √ù (60%) */}
                <div className="md:col-span-3"> {/* S·ª≠a t·ª´ md:col-7 */}
                  <h4 className="text-lg font-semibold mb-4">L∆∞u √ù Chung</h4>
                  <ul className="space-y-2 list-disc list-inside text-sm">
                    <li>H·ªó tr·ª£ t·ªëi ƒëa 7 ng∆∞·ªùi/ekip, ph·ª• thu 50k/ng∆∞·ªùi n·∫øu ph√°t sinh.</li>
                    <li>H·ªó tr·ª£ th·ªùi gian makeup/chu·∫©n b·ªã 01 ti·∫øng tr∆∞·ªõc gi·ªù ƒë·∫∑t.</li>
                    <li>Makeup/quay phim s·ª≠ d·ª•ng khu v·ª±c makeup chung, kh√¥ng h·ªó tr·ª£ ƒë√®n ri√™ng (n·∫øu qu√° 4 ng∆∞·ªùi).</li>
                    <li>Qu√Ω kh√°ch vui l√≤ng x√°c nh·∫≠n l·ªãch v√† setup. Ph√≠ thu√™ t√≠nh t·ª´ gi·ªù ƒë√£ nh·∫≠n ph√≤ng.</li>
                  </ul>
                </div>
              </div>
            </Scene>
          </main>
        </div>
      </Container>
      <BtsSection />
    </main>
  );
}
```

## File: src/app/du-an/[slug]/ProjectClientPage.tsx
```typescript
// src/app/du-an/[slug]/ProjectClientPage.tsx
'use client';

import React, { useState, useMemo, useCallback } from 'react';
import Image, { StaticImageData } from 'next/image';
import { useInView } from 'react-intersection-observer';
import { ProjectData } from '@/data/projects-master-data'; 
import ProjectNavigation from '@/components/ProjectNavigation';
// L∆∞u √Ω: ƒê·∫£m b·∫£o ƒë∆∞·ªùng d·∫´n CSS ƒë√∫ng v·ªõi d·ª± √°n c·ªßa b·∫°n
import styles from '../../styles/ProjectArticle.module.css';

// --- LIGHTBOX ---
import Lightbox from 'yet-another-react-lightbox';
import Zoom from 'yet-another-react-lightbox/plugins/zoom';
import Captions from 'yet-another-react-lightbox/plugins/captions';
import Thumbnails from 'yet-another-react-lightbox/plugins/thumbnails';
import 'yet-another-react-lightbox/styles.css';
import 'yet-another-react-lightbox/plugins/captions.css';
import 'yet-another-react-lightbox/plugins/thumbnails.css';

// --- 1. Component ·∫¢nh Chi Ti·∫øt ---
interface ArticleImageProps {
  image: StaticImageData | string;
  onClick: () => void;
  imageCount: number;
}

const ArticleImage = React.memo(({ image, onClick, imageCount }: ArticleImageProps) => {
  // Logic chia c·ªôt th√¥ng minh
  const getWidthClass = (count: number): string => {
    switch (count) {
      case 1: return 'w-full'; // 1 ·∫£nh -> Full
      case 2: return 'w-full md:w-[49%]'; // 2 ·∫£nh -> 50%
      case 3: return 'w-full md:w-[32%]'; // 3 ·∫£nh -> 33%
      default: return 'w-full md:w-[49%]'; // 4+ ·∫£nh -> 50%
    }
  };

  const widthClass = getWidthClass(imageCount);

  return (
    <div
      className={`${widthClass} relative aspect-[3/4] flex-shrink-0 cursor-pointer overflow-hidden rounded-sm shadow-sm transition-all duration-500 hover:shadow-xl hover:scale-[1.01]`}
      onClick={onClick}
    >
      <Image
        src={image} 
        alt="Project detail"
        fill
        className="object-cover transition-opacity duration-300 hover:opacity-90"
        quality={90}
        sizes="(max-width: 768px) 100vw, 50vw"
      />
    </div>
  );
});
ArticleImage.displayName = 'ArticleImage';

// --- 2. Component Ch√≠nh ---
interface ProjectClientPageProps {
  project: ProjectData;
  prevProjectLink: string | null;
  nextProjectLink: string | null;
}

export default function ProjectClientPage({
  project,
  prevProjectLink,
  nextProjectLink,
}: ProjectClientPageProps) {
  
  const [navRef, navInView] = useInView({ threshold: 0.1, triggerOnce: true });
  const [lightboxOpen, setLightboxOpen] = useState(false);
  const [lightboxIndex, setLightboxIndex] = useState(0);

  // L·∫•y th√¥ng tin Location & Client ƒë·ªÉ hi·ªÉn th·ªã n·ªïi b·∫≠t
  const locationCredit = useMemo(() => project.credits?.find((c) => c.label.toLowerCase().includes('location')), [project.credits]);
  const clientCredit = useMemo(() => project.credits?.find((c) => c.label.toLowerCase().includes('client')), [project.credits]);

  // Gom to√†n b·ªô ·∫£nh ƒë·ªÉ d√πng cho Lightbox
  const allProjectImages = useMemo(() => {
    return (
      project.articleBody
        ?.filter((block) => block.type === 'imageRow')
        .flatMap((block) => (block as { images: (StaticImageData | string)[] }).images) || []
    );
  }, [project.articleBody]);

  const lightboxSlides = useMemo(
    () => allProjectImages.map((img) => ({ 
      src: typeof img === 'string' ? img : img.src 
    })),
    [allProjectImages]
  );

  const handleImageClick = useCallback(
    (clickedImage: StaticImageData | string) => {
      const clickedSrc = typeof clickedImage === 'string' ? clickedImage : clickedImage.src;
      const index = allProjectImages.findIndex((img) => {
        const imgSrc = typeof img === 'string' ? img : img.src;
        return imgSrc === clickedSrc;
      });

      if (index !== -1) {
        setLightboxIndex(index);
        setLightboxOpen(true);
      }
    },
    [allProjectImages]
  );

  return (
    <>
      <article className={styles.articleContainer}>
        
        {/* --- HEADER B√ÄI VI·∫æT --- */}
        <header className="mb-12 md:mb-20 text-center">
          {/* Category & Year */}
          <div className="flex items-center justify-center gap-3 text-xs font-bold tracking-[0.2em] text-[var(--sub-text)] uppercase mb-4">
            <span>{project.categoryName}</span>
            <span className="w-1 h-1 rounded-full bg-[var(--sub-text)]"></span>
            <span>{project.year}</span>
          </div>

          {/* Title */}
          <h1 className={styles.articleTitle}>{project.title}</h1>

          {/* Meta Info (Client / Location) */}
          <div className="flex flex-wrap justify-center gap-6 mt-6 text-sm font-medium text-[var(--foreground)]">
            {clientCredit && (
              <div className="flex items-center gap-2">
                <span className="text-[var(--sub-text)]">Client:</span>
                <span>{clientCredit.value}</span>
              </div>
            )}
            {locationCredit && (
              <div className="flex items-center gap-2">
                <span className="text-[var(--sub-text)]">Location:</span>
                <span>{locationCredit.value}</span>
              </div>
            )}
          </div>
        </header>

        {/* --- HERO THUMBNAIL (N·∫øu mu·ªën hi·ªÉn th·ªã l·∫°i ·∫£nh b√¨a) --- */}
        {/* <div className="w-full aspect-[16/9] relative mb-16 rounded-lg overflow-hidden shadow-lg">
           <Image src={project.image} alt={project.title} fill className="object-cover" priority />
        </div> */}

        {/* --- INTRO DESCRIPTION --- */}
        {project.description && (
          <div className={styles.textWrap}>
            <p className="text-lg md:text-xl leading-relaxed font-light italic text-[var(--sub-text)] border-l-2 border-[var(--foreground)] pl-6">
              {project.description}
            </p>
          </div>
        )}

        {/* --- MAIN CONTENT BODY --- */}
        <div className="space-y-12 md:space-y-20 mt-16">
          {project.articleBody?.map((block, index) => {
            switch (block.type) {
              case 'heading':
                return (
                  <div key={index} className={styles.highlightWrap}>
                    <h2 className="text-2xl md:text-3xl font-bold text-[var(--foreground)] mt-8 mb-4">
                      {block.content}
                    </h2>
                  </div>
                );
              case 'paragraph':
                return (
                  <div key={index} className={styles.textWrap}>
                    <p className="text-base md:text-lg leading-loose text-[var(--sub-text)]">
                      {block.content}
                    </p>
                  </div>
                );
              case 'imageRow':
                const imageCount = block.images.length;
                return (
                  <div key={index} className={`${styles.imageRow} flex flex-wrap gap-2 md:gap-4 justify-center`}>
                    {block.images.map((img, imgIndex) => (
                      <ArticleImage
                        key={`${index}-${imgIndex}`}
                        image={img}
                        onClick={() => handleImageClick(img)}
                        imageCount={imageCount}
                      />
                    ))}
                  </div>
                );
              default:
                return null;
            }
          })}
        </div>

        {/* --- FOOTER CREDITS --- */}
        {project.credits && project.credits.length > 0 && (
          <div className="mt-24 pt-12 border-t border-[var(--foreground)]/10">
            <h3 className="text-md text-center uppercase font-bold tracking-widest mb-8 text-[var(--foreground)]">
              Credits
            </h3>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-4 max-w-2xl mx-auto">
              {project.credits.map((credit, index) => (
                <div key={index} className="flex justify-between items-baseline text-sm border-b border-dashed border-[var(--sub-text)]/20 pb-2">
                  <span className="font-semibold text-[var(--sub-text)] opacity-80">
                    {credit.label}
                  </span>
                  <span className="text-right text-[var(--foreground)] font-medium">
                    {credit.value}
                  </span>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* --- NAVIGATION --- */}
        <div
          ref={navRef}
          className={`mt-24 transition-opacity duration-1000 ${
            navInView ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'
          }`}
        >
          <ProjectNavigation
            prevProjectLink={prevProjectLink}
            nextProjectLink={nextProjectLink}
          />
        </div>
      </article>

      {/* --- LIGHTBOX COMPONENT --- */}
      <Lightbox
        open={lightboxOpen}
        close={() => setLightboxOpen(false)}
        index={lightboxIndex}
        slides={lightboxSlides}
        plugins={[Zoom, Thumbnails, Captions]}
        animation={{ fade: 300, swipe: 250 }}
        carousel={{ finite: false }}
        controller={{ closeOnBackdropClick: true }}
        zoom={{ maxZoomPixelRatio: 3 }}
        styles={{ container: { backgroundColor: "rgba(0, 0, 0, .95)" } }}
      />
    </>
  );
}
```

## File: src/app/layout.tsx
```typescript
import type { Metadata } from "next";
import "./globals.css";
import ScrollToTopButton from '@/components/ScrollToTopButton';
import LayoutWrapper from '@/components/LayoutWrapper';
import { Providers } from './providers';
import { Toaster } from 'sonner';

export const metadata: Metadata = {
  metadataBase: new URL(process.env.NEXT_PUBLIC_SITE_URL || 'http://localhost:3000'),
  title: "Oni Studio",
  description: "Showcase of professional photography projects.",
  openGraph: {
    title: 'Oni Studio',
    description: 'M√¥ t·∫£ m·∫∑c ƒë·ªãnh...',
    images: ['/default-og-image.jpg'], // M·ªôt ·∫£nh ƒë·∫°i di·ªán m·∫∑c ƒë·ªãnh
  },
};


export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
   <html lang="vi" suppressHydrationWarning>
     <body className="bg-[var(--background)] 
                      text-[var(--foreground)]
                       antialiased flex flex-col min-h-screen
                       transition-colors duration-300">
        <Providers>
          <LayoutWrapper>{children}
            <Toaster position="bottom-right" richColors />
          </LayoutWrapper>
          <ScrollToTopButton />
        </Providers>
      </body>
    </html>
  );
}
```

## File: src/components/PortfolioSection.tsx
```typescript
// src/components/PortfolioSection.tsx
'use client';

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'motion/react';
// 1. Th√™m StaticImageData v√†o import
import Image, { StaticImageData } from 'next/image'; 
import Link from 'next/link';
import { ArrowUpRight, Loader2 } from 'lucide-react';
import { getProjects } from '@/lib/actions'; 
import { ProjectData } from '@/data/projects-master-data'; 
import Container from './Container';

const CATEGORIES = [
  { id: 'all', label: 'T·∫•t c·∫£' },
  { id: 'thoi-trang', label: 'Th·ªùi trang' },
  { id: 'thuong-mai', label: 'Th∆∞∆°ng m·∫°i' },
  { id: 'ca-nhan', label: 'C√° nh√¢n' },
];

export default function PortfolioSection() {
  const [activeCategory, setActiveCategory] = useState('all');
  const [projects, setProjects] = useState<ProjectData[]>([]);
  const [isLoading, setIsLoading] = useState(true);

  useEffect(() => {
    const fetchData = async () => {
      setIsLoading(true);
      try {
        const allData = await getProjects();
        // Ch·ªâ l·∫•y d·ª± √°n Featured
        const featuredOnly = allData.filter(p => p.isFeatured === true);
        setProjects(featuredOnly);
      } catch (error) {
        console.error("L·ªói t·∫£i d·ª± √°n:", error);
      } finally {
        setIsLoading(false);
      }
    };

    fetchData();
  }, []);

  const filteredProjects = projects.filter((project) => {
    if (activeCategory === 'all') return true;
    return project.category === activeCategory;
  });

  // 2. S·ª≠a Helper Function: D√πng Union Type chu·∫©n x√°c
  const getImageSrc = (img: string | StaticImageData) => {
    return typeof img === 'string' ? img : img.src;
  };

  return (
    <Container className="py-20 px-4 md:px-8 bg-[var(--background)]">
      <div className="max-w-8xl mx-auto">
        
        {/* Header & Filter */}
        <div className="flex flex-col md:flex-row justify-between items-end mb-12 gap-6">
          <div>
            <h2 className="text-4xl md:text-6xl font-bold text-[var(--foreground)] tracking-tighter mb-4">
              D·ª± √°n N·ªïi b·∫≠t
            </h2>
            <p className="text-[var(--sub-text)] max-w-md">
              Tuy·ªÉn t·∫≠p c√°c d·ª± √°n ti√™u bi·ªÉu, n∆°i √°nh s√°ng v√† c·∫£m x√∫c giao thoa.
            </p>
          </div>

          {/* Filter Buttons */}
          <div className="flex flex-wrap gap-2">
            {CATEGORIES.map((cat) => (
              <button
                key={cat.id}
                onClick={() => setActiveCategory(cat.id)}
                className={`px-4 py-2 rounded-full text-sm transition-all duration-300 border cursor-pointer ${
                  activeCategory === cat.id
                    ? 'bg-[var(--foreground)] text-[var(--background)] border-[var(--foreground)]'
                    : 'bg-transparent text-[var(--sub-text)] border-[var(--sub-text)] hover:border-[var(--foreground)] hover:text-[var(--foreground)]'
                }`}
              >
                {cat.label}
              </button>
            ))}
          </div>
        </div>

        {/* Loading State */}
        {isLoading && (
          <div className="flex justify-center items-center h-64">
            <Loader2 className="animate-spin text-[var(--sub-text)]" size={32} />
          </div>
        )}

        {/* Empty State */}
        {!isLoading && filteredProjects.length === 0 && (
          <div className="text-center py-20 text-[var(--sub-text)] border border-dashed border-[var(--sub-text)]/30 rounded-xl">
            <p>Ch∆∞a c√≥ d·ª± √°n n·ªïi b·∫≠t n√†o trong danh m·ª•c n√†y.</p>
            <Link href="/admin/projects" className="text-sm text-blue-500 hover:underline mt-2 inline-block">
              V√†o Admin ƒë·ªÉ th√™m d·ª± √°n ho·∫∑c ƒëi·ªÅu ch·ªânh d·ª± √°n <strong>N·ªïi b·∫≠t</strong>
            </Link>
          </div>
        )}

        {/* Grid Display */}
        <motion.div 
          layout
          className="grid grid-cols-1 md:grid-cols-3 gap-4 auto-rows-[300px] md:auto-rows-[400px]"
        >
          <AnimatePresence>
            {filteredProjects.map((project) => (
              <motion.div
                layout
                initial={{ opacity: 0, scale: 0.9 }}
                animate={{ opacity: 1, scale: 1 }}
                exit={{ opacity: 0, scale: 0.9 }}
                transition={{ duration: 0.4 }}
                key={project.id}
                className="relative group overflow-hidden bg-gray-100 dark:bg-neutral-900 cursor-pointer"
                style={{
                  gridColumn: `span ${project.colSpan}`,
                  gridRow: `span ${project.rowSpan}`
                }}
              >
                <Link href={`/du-an/${project.slug}`} className="block h-full w-full">
                  {/* Image */}
                  <Image
                    src={getImageSrc(project.image)}
                    alt={project.title}
                    fill
                    className="object-cover transition-transform duration-700 group-hover:scale-105"
                    sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
                  />

                  {/* Overlay Info */}
                  <div className="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-6">
                    <div className="transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300">
                      <span className="text-xs font-medium text-white/80 uppercase tracking-wider mb-2 block">
                        {project.categoryName} ‚Äî {project.year}
                      </span>
                      <div className="flex justify-between items-center">
                        <h3 className="text-2xl font-bold text-white">
                          {project.title}
                        </h3>
                        <div className="bg-white/20 p-2 rounded-full backdrop-blur-sm">
                          <ArrowUpRight className="text-white w-5 h-5" />
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  {/* Badge N·ªïi B·∫≠t */}
                  <div className="absolute top-4 right-4 bg-[var(--foreground)] text-[var(--background)] text-[10px] font-bold uppercase px-2 py-1 rounded shadow-sm z-10">
                    N·ªïi b·∫≠t
                  </div>
                </Link>
              </motion.div>
            ))}
          </AnimatePresence>
        </motion.div>

      </div>
    </Container>
  );
}
```

## File: src/lib/actions.ts
```typescript
// src/lib/actions.ts
'use server';
import { createClient } from '@supabase/supabase-js';
import { supabase } from '../../lib/supabase';
import { PROJECTS_MASTER_DATA, ProjectData, ArticleBlock } from '@/data/projects-master-data';
import { revalidatePath } from 'next/cache';
import { cookies } from 'next/headers';
import { createServerClient } from '@supabase/ssr';


// 1. ƒê·ªãnh nghƒ©a Interface CH√çNH X√ÅC kh·ªõp v·ªõi Database
interface ProjectRow {
  project_id: number;
  title: string;
  client_name: string | null;
  description: string | null;
  thumbnail_url: string | null;
  created_at: string;
  slug: string;
  col_span: number | null;
  row_span: number | null;
  is_featured: boolean;
  
  // QUAN TR·ªåNG: C·ªôt ch·ª©a n·ªôi dung b√†i vi·∫øt
  content: ArticleBlock[] | null; 
  credits: { label: string; value: string }[] | null;

  // Join b·∫£ng categories
  portfolio_categories: {
    name: string;
    slug: string;
  } | null;
  
  // Join b·∫£ng ·∫£nh c≈© (Fallback)
  project_images: {
    image_url: string;
    display_order: number;
  }[];
}
async function requireAdmin(token: string) {
  const supabase = createClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    { global: { headers: { Authorization: `Bearer ${token}` } } }
  );

  const { data: { user } } = await supabase.auth.getUser();
  if (!user) throw new Error("Unauthorized");

  const { data: profile } = await supabase
    .from('users')
    .select('role')
    .eq('auth_id', user.id)
    .single();

  if (profile?.role !== 'Admin') {
    throw new Error("Forbidden: Ch·ªâ Admin m·ªõi c√≥ quy·ªÅn n√†y.");
  }
}
// 2. H√†m l·∫•y danh s√°ch d·ª± √°n, c√≥ th·ªÉ l·ªçc theo categorySlug
export async function getProjects(categorySlug?: string): Promise<ProjectData[]> {
  try {
    // --- CHECK DEMO MODE ---
    const { data: setting } = await supabase
      .from('settings')
      .select('value')
      .eq('key', 'is_demo_mode')
      .single();

    const isDemo = setting?.value === 'true';

    if (isDemo) {
      let data = PROJECTS_MASTER_DATA;
      if (categorySlug && categorySlug !== 'all') {
        data = data.filter(p => p.category === categorySlug);
      }
      return data;
    }

    // --- FETCH DATA T·ª™ SUPABASE ---
    let query = supabase
      .from('projects')
      .select(`
        *,
        portfolio_categories!inner ( name, slug ),
        project_images ( image_url, display_order )
      `)
      .order('display_order', { ascending: true }) 
      .order('created_at', { ascending: false });

    if (categorySlug && categorySlug !== 'all') {
      query = query.eq('portfolio_categories.slug', categorySlug);
    }

    const { data, error } = await query;

    if (error) {
      console.error('L·ªói Supabase:', error);
      return [];
    }

    const projectsRaw = data as unknown as ProjectRow[];

    // 3. Map d·ªØ li·ªáu
    return projectsRaw.map((p) => {
      
      // A. X·ª≠ l√Ω n·ªôi dung b√†i vi·∫øt (Article Body)
      let articleBody: ArticleBlock[] = [];

      // ∆Øu ti√™n 1: L·∫•y t·ª´ c·ªôt 'content' (D·ª± √°n m·ªõi t·∫°o b·∫±ng Admin Builder)
      if (p.content && Array.isArray(p.content) && p.content.length > 0) {
        articleBody = p.content;
      } 
      // ∆Øu ti√™n 2: Fallback cho d·ª± √°n c≈© (T·ª± t·∫°o t·ª´ b·∫£ng project_images)
      else {
        const galleryImages = p.project_images
          ?.sort((a, b) => a.display_order - b.display_order)
          .map(img => img.image_url) || [];

        if (galleryImages.length > 0) {
          // Gom ·∫£nh th√†nh c√°c row (m·ªói row 2-3 ·∫£nh t√πy logic, ·ªü ƒë√¢y ƒë·ªÉ ƒë∆°n gi·∫£n l√† 1 row ch·ª©a h·∫øt)
          articleBody.push({
            type: 'imageRow',
            images: galleryImages
          });
        } else if (p.description) {
           // N·∫øu kh√¥ng c√≥ ·∫£nh, √≠t nh·∫•t hi·ªán m√¥ t·∫£
           articleBody.push({
             type: 'paragraph',
             content: p.description
           });
        }
      }

      // B. Tr·∫£ v·ªÅ ProjectData chu·∫©n
      return {
        id: p.project_id,
        title: p.title,
        client_name: p.client_name || '',
        description: p.description || '',
        category: p.portfolio_categories?.slug || 'uncategorized',
        categoryName: p.portfolio_categories?.name || 'Ch∆∞a ph√¢n lo·∫°i',
        image: p.thumbnail_url || '', 
        year: new Date(p.created_at).getFullYear().toString(),
        slug: p.slug,
        colSpan: p.col_span || 1,
        rowSpan: p.row_span || 1,
        isFeatured: p.is_featured || false,
        
        credits: p.credits || [],
        articleBody: articleBody, 
      };
    });

  } catch (error) {
    console.error("Get projects error:", error);
    return [];
  }
}

// ƒê·ªãnh nghƒ©a ki·ªÉu cho c·∫≠p nh·∫≠t layout l∆∞·ªõi d·ª± √°n
export interface ProjectGridUpdate {
  id: number;
  colSpan: number;
  rowSpan: number;
  displayOrder: number;
}

// C·∫≠p nh·∫≠t layout l∆∞·ªõi d·ª± √°n
export async function updatePortfolioLayout(token: string, updates: ProjectGridUpdate[]) {
  try {
    // 1. T·∫°o Supabase Client v·ªõi Token c·ªßa ng∆∞·ªùi d√πng ƒëang ƒëƒÉng nh·∫≠p
    // ƒêi·ªÅu n√†y gi√∫p v∆∞·ª£t qua RLS (Row Level Security) m·ªôt c√°ch h·ª£p l·ªá
    const supabase = createClient(
      process.env.NEXT_PUBLIC_SUPABASE_URL!,
      process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
      {
        global: {
          headers: {
            Authorization: `Bearer ${token}`,
          },
        },
      }
    );

    console.log(`--> ƒêang c·∫≠p nh·∫≠t layout cho ${updates.length} d·ª± √°n...`);

    // 2. Th·ª±c hi·ªán Update t·ª´ng d·ª± √°n (D√πng Promise.all cho nhanh)
    const promises = updates.map(async (project) => {
      const { error } = await supabase
        .from('projects')
        .update({
          col_span: project.colSpan,
          row_span: project.rowSpan,
          display_order: project.displayOrder,
        })
        .eq('project_id', project.id);

      if (error) throw error;
    });

    await Promise.all(promises);

    // 3. X√≥a Cache ƒë·ªÉ Frontend c·∫≠p nh·∫≠t ngay l·∫≠p t·ª©c
    revalidatePath('/'); 
    revalidatePath('/admin/portfolio-grid');

    return { success: true };
 } catch (error: unknown) {
    // ƒê·∫£m b·∫£o c√≥ d√≤ng n√†y ho·∫∑c t∆∞∆°ng t·ª±
    const msg = error instanceof Error ? error.message : 'L·ªói update layout';
    console.error("Layout update error:", error);
    return { success: false, error: msg };
  }
}

// L·∫•y chi ti·∫øt d·ª± √°n theo ID
export async function getProjectById(id: number) {
  try {
    const { data, error } = await supabase
      .from('projects')
      .select('*')
      .eq('project_id', id)
      .single();
      
    if (error) throw error;
    return data;
  } catch (error) {
    console.error("Error fetching project:", error);
    return null;
  }
}

// X√≥a d·ª± √°n theo ID
export async function deleteProject(token: string, projectId: number) {
  try {
    const supabase = createClient(
      process.env.NEXT_PUBLIC_SUPABASE_URL!,
      process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
      {
        global: {
          headers: {
            Authorization: `Bearer ${token}`,
          },
        },
      }
    );

    const { error } = await supabase
      .from('projects')
      .delete()
      .eq('project_id', projectId);

    if (error) throw error;

    // X√≥a cache ƒë·ªÉ danh s√°ch c·∫≠p nh·∫≠t ngay
    revalidatePath('/');
    revalidatePath('/admin/projects');
    revalidatePath('/admin/portfolio-grid');

    return { success: true };
  } catch (error: unknown) {
    console.error("Delete error:", error); 
    return { success: false, error: 'Kh√¥ng th·ªÉ x√≥a d·ª± √°n n√†y.' };
  }
}


export interface StaffUser {
  user_id: number;
  email: string;
  full_name: string;
  role: 'Admin' | 'Staff';
  is_active: boolean;
  created_at: string;
  auth_id: string;
}

// 1. L·∫•y danh s√°ch nh√¢n vi√™n
export async function getStaffList() {
  try {
    // D√πng client th∆∞·ªùng (anon) c≈©ng ƒë∆∞·ª£c n·∫øu ƒë√£ set Policy Public Read
    // Ho·∫∑c d√πng Service Role ƒë·ªÉ ch·∫Øc ch·∫Øn l·∫•y ƒë∆∞·ª£c h·∫øt
    const { data, error } = await supabase
      .from('users')
      .select('*')
      .order('created_at', { ascending: false });

    if (error) throw error;
    return data as StaffUser[];
  } catch (error) {
    console.error("Error fetching staff:", error);
    return [];
  }
}

// 2. ƒê·ªïi tr·∫°ng th√°i (Kh√≥a/M·ªü kh√≥a)
export async function toggleStaffStatus(token: string, userId: number, currentStatus: boolean) {
  try {
    await requireAdmin(token);
    // C·∫ßn token c·ªßa Admin ƒëang ƒëƒÉng nh·∫≠p ƒë·ªÉ x√°c th·ª±c quy·ªÅn
    const supabaseClient = createClient(
      process.env.NEXT_PUBLIC_SUPABASE_URL!,
      process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
      { global: { headers: { Authorization: `Bearer ${token}` } } }
    );
    // 1. L·∫•y th√¥ng tin ng∆∞·ªùi ƒëang ƒëƒÉng nh·∫≠p
    const { data: { user: currentUser } } = await supabaseClient.auth.getUser();
    
    // 2. L·∫•y th√¥ng tin ng∆∞·ªùi b·ªã kh√≥a (Target)
    const { data: targetUser } = await supabaseClient
      .from('users')
      .select('auth_id')
      .eq('user_id', userId)
      .single();

    // 3. So s√°nh: N·∫øu tr√πng nhau -> Ch·∫∑n ngay
    if (currentUser && targetUser && currentUser.id === targetUser.auth_id) {
      throw new Error("B·∫°n kh√¥ng th·ªÉ t·ª± kh√≥a t√†i kho·∫£n c·ªßa ch√≠nh m√¨nh.");
    }
    const { error } = await supabaseClient
      .from('users')
      .update({ is_active: !currentStatus })
      .eq('user_id', userId);

    if (error) throw error;
    
    revalidatePath('/admin/staff');
    return { success: true };
  } catch (error: unknown) {
    console.error("Toggle staff error:", error);
    return { success: false, error: 'Kh√¥ng th·ªÉ thay ƒë·ªïi tr·∫°ng th√°i t√†i kho·∫£n n√†y. Ch·ªâ Admin m·ªõi c√≥ quy·ªÅn n√†y.' };
  }
}

// 3. T·∫°o nh√¢n vi√™n m·ªõi (D√πng quy·ªÅn t·ªëi cao Service Role)
export async function createStaffAccount(data: { email: string; password: string; fullName: string; role: string }) {
  try {
    // A. Ki·ªÉm tra Key
    const serviceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;
    if (!serviceKey) {
      return { success: false, error: "Server ch∆∞a c·∫•u h√¨nh Service Role Key (Ki·ªÉm tra .env.local)" };
    }

    // B. T·∫°o Client Admin (Bypass m·ªçi RLS)
    const supabaseAdmin = createClient(
      process.env.NEXT_PUBLIC_SUPABASE_URL!,
      serviceKey,
      {
        auth: {
          autoRefreshToken: false,
          persistSession: false
        }
      }
    );

    // C. T·∫°o User b√™n h·ªá th·ªëng Auth (T·ª± ƒë·ªông Confirm email)
    const { data: authData, error: authError } = await supabaseAdmin.auth.admin.createUser({
      email: data.email,
      password: data.password,
      email_confirm: true, // Quan tr·ªçng: User ƒëƒÉng nh·∫≠p ƒë∆∞·ª£c ngay kh√¥ng c·∫ßn check mail
      user_metadata: { full_name: data.fullName }
    });

    if (authError) throw authError;
    if (!authData.user) throw new Error("Kh√¥ng t·∫°o ƒë∆∞·ª£c Auth User");

    // D. L∆∞u th√¥ng tin v√†o b·∫£ng public.users
    const { error: dbError } = await supabaseAdmin
      .from('users')
      .insert({
        email: data.email,
        username: data.email, // T·∫°m d√πng email l√†m username (unique)
        full_name: data.fullName,
        role: data.role,
        auth_id: authData.user.id, // Link v·ªõi Auth ID v·ª´a t·∫°o
        is_active: true
      });

    if (dbError) {
      // N·∫øu l∆∞u DB th·∫•t b·∫°i -> X√≥a lu√¥n user b√™n Auth ƒë·ªÉ tr√°nh r√°c data
      console.error("L·ªói l∆∞u DB, ƒëang rollback x√≥a Auth User...");
      await supabaseAdmin.auth.admin.deleteUser(authData.user.id);
      throw dbError;
    }

    // Refresh l·∫°i trang danh s√°ch
    revalidatePath('/admin/staff');
    return { success: true };

  } catch (error: unknown) {
    
    // X·ª≠ l√Ω type safe
    let message = 'L·ªói kh√¥ng x√°c ƒë·ªãnh';
    
    if (error instanceof Error) {
      message = error.message; // L·∫•y message t·ª´ Error object
    } else if (typeof error === 'string') {
      message = error; // N·∫øu throw "chu·ªói"
    }

    // Tr·∫£ v·ªÅ string cho Client hi·ªÉn th·ªã
    return { success: false, error: message };
  }
}

// ƒê·ªãnh nghƒ©a ki·ªÉu d·ªØ li·ªáu UserProfile
export interface UserProfile {
  user_id: number;
  email: string;
  full_name: string;
  role: 'Admin' | 'Staff';
}

// H√†m l·∫•y th√¥ng tin ng∆∞·ªùi d√πng hi·ªán t·∫°i (Server-side)
export async function getCurrentUserProfile(): Promise<UserProfile | null> {
  const cookieStore = await cookies();
  
  const supabase = createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() { return cookieStore.getAll() },
        setAll() {} 
      },
    }
  );

  try {
    const { data: { user } } = await supabase.auth.getUser();
    if (!user) return null;

    const { data: profile } = await supabase
      .from('users')
      .select('user_id, email, full_name, role')
      .eq('auth_id', user.id)
      .single();

    return profile as UserProfile;
  } catch (error) {
    console.error("L·ªói th√¥ng tin ng∆∞·ªùi d√πng hi·ªán t·∫°i:", error);
    return null;
  }
}

// --- DASHBOARD STATS ---
// H√†m l·∫•y th·ªëng k√™ Dashboard
// Tr·∫£ v·ªÅ t·ªïng s·ªë d·ª± √°n, d·ª± √°n m·ªõi trong th√°ng n√†y, v√† t·ªïng s·ªë nh√¢n s·ª±
// D√πng ƒë·ªÉ hi·ªÉn th·ªã tr√™n trang Admin Dashboard
export async function getDashboardStats(range: string = '30d') {
  try {
    const startDate = getStartDate(range).toISOString();

    // 1. T·ªïng d·ª± √°n (To√†n th·ªùi gian - Kh√¥ng ƒë·ªïi theo filter)
    const { count: totalProjects } = await supabase
      .from('projects')
      .select('*', { count: 'exact', head: true });

    // 2. D·ª± √°n M·ªöI (Thay ƒë·ªïi theo filter)
    const { count: newProjects } = await supabase
      .from('projects')
      .select('*', { count: 'exact', head: true })
      .gte('created_at', startDate);

    // 3. T·ªïng nh√¢n s·ª±
    const { count: totalStaff } = await supabase
      .from('users')
      .select('*', { count: 'exact', head: true });

    return {
      totalProjects: totalProjects || 0,
      newProjects: newProjects || 0, // S·ªë l∆∞·ª£ng tƒÉng th√™m trong kho·∫£ng th·ªùi gian n√†y
      totalStaff: totalStaff || 0
    };
  } catch (error) {
    console.error("L·ªói l·∫•y th·ªëng k√™ Dashboard:", error);
    return { totalProjects: 0, newProjects: 0, totalStaff: 0 };
  }
}

export interface MonthlyStat {
  name: string; // VD: "Th√°ng 10"
  total: number;
}

export async function getMonthlyProjectStats() {
  try {
    // 1. L·∫•y t·∫•t c·∫£ d·ª± √°n (Ch·ªâ c·∫ßn c·ªôt created_at)
    // L∆∞u √Ω: N·∫øu data qu√° l·ªõn (>10k), n√™n d√πng SQL function (RPC). 
    // V·ªõi Portfolio < 1000 b√†i, x·ª≠ l√Ω JS v·∫´n si√™u nhanh.
    const { data, error } = await supabase
      .from('projects')
      .select('created_at')
      .order('created_at', { ascending: true });

    if (error) throw error;

    // 2. X·ª≠ l√Ω d·ªØ li·ªáu: Nh√≥m theo th√°ng
    // T·∫°o m·∫£ng 6 th√°ng g·∫ßn nh·∫•t m·∫∑c ƒë·ªãnh l√† 0
    const statsMap = new Map<string, number>();
    const today = new Date();
    
    for (let i = 5; i >= 0; i--) {
      const d = new Date(today.getFullYear(), today.getMonth() - i, 1);
      // Format t√™n th√°ng ti·∫øng Vi·ªát (VD: T1, T2...)
      const monthName = `T${d.getMonth() + 1}`;
      statsMap.set(monthName, 0);
    }

    // ƒê·∫øm s·ªë l∆∞·ª£ng
    data?.forEach((p) => {
      const date = new Date(p.created_at);
      const monthName = `T${date.getMonth() + 1}`;
      // Ch·ªâ ƒë·∫øm n·∫øu th√°ng ƒë√≥ n·∫±m trong danh s√°ch 6 th√°ng g·∫ßn nh·∫•t
      if (statsMap.has(monthName)) {
        statsMap.set(monthName, (statsMap.get(monthName) || 0) + 1);
      }
    });

    // Chuy·ªÉn Map th√†nh Array cho Recharts
    const result: MonthlyStat[] = Array.from(statsMap, ([name, total]) => ({ name, total }));
    
    return result;

  } catch (error) {
    console.error("L·ªói l·∫•y th·ªëng k√™ th√°ng:", error);
    return [];
  }
}

// H√†m t√≠nh ng√†y b·∫Øt ƒë·∫ßu d·ª±a tr√™n range (VD: '7d', '30d')
function getStartDate(range: string) {
  const now = new Date();
  if (range === '7d') return new Date(now.setDate(now.getDate() - 7));
  if (range === '30d') return new Date(now.setDate(now.getDate() - 30));
  if (range === '90d') return new Date(now.setDate(now.getDate() - 90));
  if (range === '12m') return new Date(now.setFullYear(now.getFullYear() - 1));
  return new Date(0); // 'all' -> T·ª´ nƒÉm 1970
}
// Logic Bi·ªÉu ƒë·ªì linh ho·∫°t (Ng√†y/Th√°ng)
export async function getGrowthChartData(range: string = '30d') {
  try {
    const startDate = getStartDate(range);
    
    // L·∫•y d·ªØ li·ªáu trong kho·∫£ng th·ªùi gian
    const { data } = await supabase
      .from('projects')
      .select('created_at')
      .gte('created_at', startDate.toISOString())
      .order('created_at', { ascending: true });

    if (!data) return [];

    // X·ª≠ l√Ω nh√≥m d·ªØ li·ªáu
    // N·∫øu range ng·∫Øn (7d, 30d) -> Nh√≥m theo NG√ÄY
    // N·∫øu range d√†i (90d, 12m) -> Nh√≥m theo TH√ÅNG
    const isDaily = range === '7d' || range === '30d';
    const statsMap = new Map<string, number>();

    // Kh·ªüi t·∫°o tr·ª•c X cho ƒë·∫πp (tr√°nh b·ªã ƒë·ª©t ƒëo·∫°n)
    // (Logic n√†y h∆°i d√†i d√≤ng ƒë·ªÉ vi·∫øt ·ªü ƒë√¢y, n√™n ta l√†m ƒë∆°n gi·∫£n: Nh√≥m theo data th·ª±c c√≥)
    
    data.forEach((p) => {
      const date = new Date(p.created_at);
      let key = '';
      
      if (isDaily) {
        // Format: "DD/MM" (VD: 05/10)
        key = `${date.getDate()}/${date.getMonth() + 1}`;
      } else {
        // Format: "Th√°ng MM" (VD: T10)
        key = `T${date.getMonth() + 1}`;
      }

      statsMap.set(key, (statsMap.get(key) || 0) + 1);
    });

    return Array.from(statsMap, ([name, total]) => ({ name, total }));

  } catch (error) {
    console.error("L·ªói l·∫•y d·ªØ li·ªáu bi·ªÉu ƒë·ªì tƒÉng tr∆∞·ªüng:", error);
    return [];
  }
}
```

## File: src/app/ca-nhan/page.tsx
```typescript
import React from 'react';
import { getProjects } from '@/lib/actions';
import { Metadata } from 'next';
import Container from '@/components/Container';
import ProjectMasonryGrid from '@/components/ProjectMasonryGrid';

// Metadata cho SEO
export const metadata: Metadata = {
  title: 'D·ª± √°n C√° nh√¢n | Oni Studio',
  description: 'Nh·ªØng d·ª± √°n th·ªÉ hi·ªán c√°i t√¥i c√° nh√¢n v√† th·ª≠ nghi·ªám s√°ng t·∫°o.',
};
export const revalidate = 3600; // 1 hour
export default async function PersonalPage() {
  // 1. G·ªçi d·ªØ li·ªáu th·∫≠t t·ª´ Supabase (ho·∫∑c Demo)
  const projects = await getProjects('ca-nhan'); // <-- Slug c·ªßa danh m·ª•c

  return (
    <Container className="min-h-screen bg-[var(--background)] pt-32 pb-20 px-4 md:px-8">
      <div className="max-w-8xl mx-auto">
        
        {/* Header */}
        <div className="mb-16">
          <h1 className="text-4xl md:text-6xl font-bold text-[var(--foreground)] tracking-tighter mb-4">
            C√° nh√¢n
          </h1>
          <p className="text-[var(--sub-text)] text-lg max-w-xl">
            Nh·ªØng th·ª≠ nghi·ªám, c·∫£m h·ª©ng v√† g√≥c nh√¨n ri√™ng.
          </p>
        </div>

        {/* Empty State */}
        {projects.length === 0 && (
          <div className="py-20 text-center text-[var(--sub-text)] border-y border-[var(--foreground)]/10">
            Ch∆∞a c√≥ d·ª± √°n n√†o trong danh m·ª•c n√†y.
          </div>
        )}

        {/* Project Grid */}
        <ProjectMasonryGrid projects={projects} variant="cascade" />
      </div>
    </Container>
  );
}
```

## File: src/components/ProjectShowcase.tsx
```typescript
// src/components/ProjectShowcase.tsx
'use client';

import React, { useEffect, useState } from 'react';
import Image from 'next/image';
import Link from 'next/link';
import { motion } from 'framer-motion';
import { ArrowRight } from 'lucide-react';
import { getProjects } from '@/lib/actions';
import { ProjectData } from '@/data/projects-master-data';

// --- Component Con: ProjectItem ---
function ProjectItem({ project, index }: { project: ProjectData; index: number }) {
  const isImageRight = index % 2 !== 0;

  return (
    <motion.div 
      initial={{ opacity: 0, y: 50 }}
      whileInView={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.8, ease: "easeOut" }}
      viewport={{ once: true, margin: "-100px" }}
      className={`flex flex-col md:flex-row items-center gap-8 md:gap-16 mb-24 md:mb-32 ${
        isImageRight ? 'md:flex-row-reverse' : ''
      }`}
    >
      {/* Image Side */}
      <div className="w-full md:w-3/5 relative group cursor-pointer overflow-hidden rounded-lg shadow-2xl">
        <Link href={`/du-an/${project.slug}`}>
          <div className="relative aspect-[16/9] w-full overflow-hidden">
            <Image
              src={typeof project.image === 'string' ? project.image : project.image.src}
              alt={project.title}
              fill
              className="object-cover transition-transform duration-700 group-hover:scale-105"
              sizes="(max-width: 768px) 100vw, 60vw"
            />
            <div className="absolute inset-0 bg-black/20 group-hover:bg-transparent transition-colors duration-500" />
            
            {/* Badge Danh m·ª•c n·ªïi b·∫≠t */}
            <div className="absolute top-4 left-4 bg-white/90 dark:bg-black/80 backdrop-blur px-3 py-1 text-xs font-bold uppercase tracking-wider text-[var(--foreground)] rounded">
              {project.categoryName}
            </div>
          </div>
        </Link>
      </div>

      {/* Text Side */}
      <div className="w-full md:w-2/5 text-center md:text-left space-y-6">
        <span className="inline-block text-xs font-bold tracking-[0.2em] text-[var(--sub-text)] uppercase border-b border-[var(--glow-color)] pb-1">
          D·ª± √°n {project.categoryName} m·ªõi
        </span>
        
        <h3 className="text-3xl md:text-5xl font-bold text-[var(--foreground)] leading-tight">
          <Link href={`/du-an/${project.slug}`} className="hover:text-[var(--sub-text)] transition-colors">
            {project.title}
          </Link>
        </h3>

        {project.description && (
          <p className="text-[var(--sub-text)] text-lg font-light leading-relaxed line-clamp-3">
            {project.description}
          </p>
        )}
        {project.credits && project.credits.length > 0 && (
          <ul className="mt-5 space-y-2 text-sm text-[var(--sub-text)] border-l border-[var(--foreground)]/20 pl-4 text-left">
            {project.credits.slice(0, 3).map((credit, idx) => (
              <li key={idx}>
                <strong className="font-semibold text-[var(--foreground)]">
                  {credit.label}:
                </strong> {credit.value}
              </li>
            ))}
          </ul>
        )}
        <div className="pt-4">
          <Link 
            href={`/du-an/${project.slug}`}
            className="inline-flex items-center gap-2 text-sm font-medium uppercase tracking-wider text-[var(--foreground)] hover:gap-4 transition-all duration-300 group/link"
          >
            Xem d·ª± √°n <ArrowRight size={16} className="transition-transform group-hover/link:translate-x-1" />
          </Link>
        </div>
      </div>
    </motion.div>
  );
}

// --- Component Ch√≠nh ---
export default function ProjectShowcase() {
  const [showcaseProjects, setShowcaseProjects] = useState<ProjectData[]>([]);
  const [isLoading, setIsLoading] = useState(true);

  useEffect(() => {
    const fetchAndFilter = async () => {
      try {
        const all = await getProjects();
        
        // 1. L·∫•y t·∫•t c·∫£ d·ª± √°n Featured
        const allFeatured = all.filter(p => p.isFeatured);

        // 2. L·ªçc: M·ªói danh m·ª•c ch·ªâ l·∫•y 1 ƒë·∫°i di·ªán M·ªöI NH·∫§T
        // Danh s√°ch c√°c category slug c·∫ßn l·∫•y
        const targetCategories = ['thoi-trang', 'thuong-mai', 'ca-nhan'];
        
        const uniqueFeatured: ProjectData[] = [];

        targetCategories.forEach(catSlug => {
          // T√¨m d·ª± √°n Featured m·ªõi nh·∫•t c·ªßa danh m·ª•c n√†y
          const bestProject = allFeatured.find(p => p.category === catSlug);
          if (bestProject) {
            uniqueFeatured.push(bestProject);
          }
        });

        // N·∫øu thi·∫øu (v√≠ d·ª• ch∆∞a c√≥ d·ª± √°n C√° nh√¢n n√†o Featured), c√≥ th·ªÉ l·∫•y b√π t·ª´ danh s√°ch chung
        // (·ªû ƒë√¢y m√¨nh gi·ªØ logic ch·∫∑t: Kh√¥ng c√≥ th√¨ kh√¥ng hi·ªán)
        
        setShowcaseProjects(uniqueFeatured);
      } catch (error) {
        console.error("L·ªói t·∫£i showcase:", error);
      } finally {
        setIsLoading(false);
      }
    };

    fetchAndFilter();
  }, []);

  if (isLoading || showcaseProjects.length === 0) return null;

  return (
    <div className="max-w-8xl mx-auto px-4 md:px-8 py-20 border-t border-[var(--foreground)]/10">
      {showcaseProjects.map((project, index) => (
        <ProjectItem key={project.id} project={project} index={index} />
      ))}
    </div>
  );
}
```

## File: src/app/admin/layout.tsx
```typescript
// src/app/admin/layout.tsx
'use client';

import React, { useState, useEffect, useRef, useCallback } from 'react';
import Link from 'next/link';
import { usePathname, useRouter } from 'next/navigation';
import { createBrowserClient } from '@supabase/ssr';
import { toast } from 'sonner';
import { 
  LayoutDashboard, 
  Image as ImageIcon, 
  Settings, 
  LogOut, 
  Users,
  Menu,
  X,
  Home,
  Clock,
  LayoutTemplate 
} from 'lucide-react';
import ThemeToggle from '@/components/ThemeToggle';
import localFont from 'next/font/local'; 
import ConfirmModal from '@/components/ui/ConfirmModal';
import { getCurrentUserProfile } from '@/lib/actions';
import { getRooms, type RoomWithBranch } from '@/lib/actions/studio'; 
import NavCalendarWidget from '@/components/admin/calendar/NavCalendarWidget';
import { CalendarProvider } from '@/context/CalendarContext';

const logoFont = localFont({
  src: '../../fonts/cameliya-regular.ttf',
  display: 'swap',
  variable: '--font-logo',
});

interface NavLinkProps {
  href: string;
  icon: React.ReactNode;
  label: string;
  isActive?: boolean;
  onClick?: () => void;
}
// Type cho th√¥ng tin user hi·ªÉn th·ªã
interface UserProfile {
  full_name: string;
  role: string;
  email: string;
}
// Gi√° tr·ªã m·∫∑c ƒë·ªãnh n·∫øu ch∆∞a c·∫•u h√¨nh trong DB
const DEFAULT_TIMEOUT = 60; 

export default function AdminLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const router = useRouter();
  const pathname = usePathname();
  const [showModal, setShowModal] = useState(false); 
  // Supabase Client
  const [supabase] = useState(() => createBrowserClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
  ));
  // State qu·∫£n l√Ω menu mobile
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
  const [isCheckingAuth, setIsCheckingAuth] = useState(true);
  const [timeLeft, setTimeLeft] = useState<string>('--:--:--');

  // State l∆∞u th·ªùi gian timeout th·ª±c t·∫ø (L·∫•y t·ª´ DB)
  const [idleTimeoutMinutes, setIdleTimeoutMinutes] = useState(DEFAULT_TIMEOUT);

  // Ref l∆∞u th·ªùi ƒëi·ªÉm ho·∫°t ƒë·ªông cu·ªëi c√πng
  const lastActivityRef = useRef<number>(Date.now());
  
  // Ref l∆∞u gi√° tr·ªã timeout ƒë·ªÉ d√πng trong setInterval m√† kh√¥ng c·∫ßn restart interval
  const timeoutRef = useRef(idleTimeoutMinutes);

  // --- TH√äM LOGIC L·∫§Y DANH S√ÅCH PH√íNG ---
  const [rooms, setRooms] = useState<RoomWithBranch[]>([]);

  useEffect(() => {
    // Fetch ph√≤ng ƒë·ªÉ hi·ªÉn th·ªã trong Sidebar Calendar Widget
    const fetchRooms = async () => {
      try {
        const data = await getRooms();
        setRooms(data);
      } catch (error) {
        console.error("L·ªói l·∫•y danh s√°ch ph√≤ng:", error);
      }
    };
    fetchRooms();
  }, []); // Ch·ªâ ch·∫°y 1 l·∫ßn khi mount

  // State l∆∞u th√¥ng tin user
  const [userProfile, setUserProfile] = useState<UserProfile | null>(null);
  // --- 1. ƒê·ªíNG B·ªò REF V·ªöI STATE ---
  useEffect(() => {
    timeoutRef.current = idleTimeoutMinutes;
  }, [idleTimeoutMinutes]);

// --- 2. L·∫§Y C·∫§U H√åNH T·ª™ DATABASE (C√ì L·∫ÆNG NGHE S·ª∞ KI·ªÜN) ---
  useEffect(() => {
    // H√†m l·∫•y d·ªØ li·ªáu (T√°ch ra ƒë·ªÉ t√°i s·ª≠ d·ª•ng)
    const fetchSettings = async () => {
      try {
        const { data } = await supabase
          .from('settings')
          .select('value')
          .eq('key', 'idle_timeout_minutes')
          .single();
        
        if (data?.value) {
          const dbValue = parseInt(data.value);
          if (!isNaN(dbValue) && dbValue > 0) {
            setIdleTimeoutMinutes(dbValue);
            // C·∫≠p nh·∫≠t lu√¥n v√†o ref ƒë·ªÉ timer nh·∫≠n ngay l·∫≠p t·ª©c m√† kh√¥ng ƒë·ª£i v√≤ng l·∫∑p sau
            timeoutRef.current = dbValue; 
          }
        }
      } catch (error) {
        console.error("L·ªói fetch setting:", error);
      }
    };

    // G·ªçi l·∫ßn ƒë·∫ßu khi load trang
    fetchSettings();

    // L·∫Øng nghe s·ª± ki·ªán 'settings:updated' t·ª´ trang SettingsForm
    const handleSettingsUpdate = () => {
      console.log("Ph√°t hi·ªán thay ƒë·ªïi c√†i ƒë·∫∑t -> C·∫≠p nh·∫≠t l·∫°i Layout...");
      fetchSettings();
    };

    window.addEventListener('settings:updated', handleSettingsUpdate);

    // D·ªçn d·∫πp khi component unmount
    return () => {
      window.removeEventListener('settings:updated', handleSettingsUpdate);
    };
  }, [supabase]);
  // --- 3. H√ÄM GHI NH·∫¨N HO·∫†T ƒê·ªòNG ---
  const resetTimer = useCallback(() => {
    lastActivityRef.current = Date.now();
  }, []);

  // --- 4. LOGIC CH√çNH (CHECK AUTH & TIMER) ---
  useEffect(() => {
    let intervalId: NodeJS.Timeout;

    const setupActivityListeners = () => {
      window.addEventListener('mousemove', resetTimer);
      window.addEventListener('keydown', resetTimer);
      window.addEventListener('click', resetTimer);
      window.addEventListener('scroll', resetTimer);
      window.addEventListener('touchstart', resetTimer);
    };

    const cleanupActivityListeners = () => {
      window.removeEventListener('mousemove', resetTimer);
      window.removeEventListener('keydown', resetTimer);
      window.removeEventListener('click', resetTimer);
      window.removeEventListener('scroll', resetTimer);
      window.removeEventListener('touchstart', resetTimer);
    };

    const checkAuthAndStartTimer = async () => {
      try {
        // 1. L·∫•y Session Auth
        const { data: { session } } = await supabase.auth.getSession();
        
        if (!session) {
          router.replace('/login');
          return;
        }

        // 2. (M·ªöI) L·∫•y th√¥ng tin chi ti·∫øt t·ª´ b·∫£ng public.users
        // D√πng auth_id (uid) ƒë·ªÉ ƒë·ªëi chi·∫øu
        const profile = await getCurrentUserProfile();

        if (profile) {
          setUserProfile(profile);
        } else {
          // Fallback ch·ªâ khi kh√¥ng t√¨m th·∫•y profile trong DB
          setUserProfile({
            full_name: session.user.email?.split('@')[0] || 'Admin',
            role: 'Staff', // M·∫∑c ƒë·ªãnh an to√†n l√† Staff n·∫øu l·ªói
            email: session.user.email || ''
          });
        }
        // 3. Kh·ªüi ƒë·ªông Timer
        setupActivityListeners();
        setIsCheckingAuth(false);

        intervalId = setInterval(() => {
          const now = Date.now();
          const timeSinceLastActivity = now - lastActivityRef.current;
          const currentTimeoutMs = timeoutRef.current * 60 * 1000; 
          const timeRemaining = currentTimeoutMs - timeSinceLastActivity;

          if (timeRemaining <= 0) {
            clearInterval(intervalId);
            cleanupActivityListeners();
            supabase.auth.signOut().then(() => {
              toast.warning(`ƒê√£ ƒëƒÉng xu·∫•t do kh√¥ng ho·∫°t ƒë·ªông qu√° ${timeoutRef.current} ph√∫t.`);
              router.replace('/login');
            });
            return;
          }

          const h = Math.floor(timeRemaining / (1000 * 60 * 60));
          const m = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
          const s = Math.floor((timeRemaining % (1000 * 60)) / 1000);
          
          setTimeLeft(`${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`);
          
        }, 1000);

      } catch (error) {
        console.error("Auth error:", error);
        router.replace('/login');
      }
    };

    checkAuthAndStartTimer();

    return () => {
      if (intervalId) clearInterval(intervalId);
      cleanupActivityListeners();
    };
  }, [router, supabase, resetTimer]);

  const handleLogout = async () => {
    try {
      await supabase.auth.signOut();
      toast.success("ƒêƒÉng xu·∫•t th√†nh c√¥ng!!");
      router.replace('/login');
      router.refresh();
    } catch (error) {
      const msg = (error as Error)?.message || "L·ªói kh√¥ng x√°c ƒë·ªãnh";
      toast.error(msg);
    }
  };

  const handleLinkClick = () => setIsMobileMenuOpen(false);
  // Helper l·∫•y ch·ªØ c√°i ƒë·∫ßu
  const getInitials = (name?: string) => {
    return name ? name.charAt(0).toUpperCase() : 'A';
  };
  if (isCheckingAuth) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-[var(--admin-bg)]">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--admin-primary)]"></div>
      </div>
    );
  }

  return (
    <CalendarProvider>
      <div className="flex min-h-screen bg-[var(--admin-bg)] text-[var(--admin-fg)] transition-colors duration-300 font-sans">
        {isMobileMenuOpen && (
          <div className="fixed inset-0 bg-black/60 z-40 md:hidden backdrop-blur-sm" onClick={() => setIsMobileMenuOpen(false)} />
        )}

        <aside className={`fixed top-0 left-0 z-50 h-full w-64 bg-[var(--admin-card)] border-r border-[var(--admin-border)] transform transition-transform duration-300 ease-in-out shadow-xl md:shadow-none ${isMobileMenuOpen ? 'translate-x-0' : '-translate-x-full'} md:translate-x-0 md:static md:flex md:flex-col`}>
          <div className="h-16 flex items-center justify-between px-6 border-b border-[var(--admin-border)]">
            <div className="flex items-center gap-2">
              <div className={`w-8 h-8 bg-[var(--admin-primary)] rounded-lg flex items-center justify-center text-[var(--admin-primary-fg)] font-bold ${logoFont.className}`}>O</div>
              <span className={`${logoFont.variable} text-xl font-bold tracking-widest text-[var(--admin-fg)] ${logoFont.className}`}>Oni Admin</span>
            </div>
            <button onClick={() => setIsMobileMenuOpen(false)} className="md:hidden text-[var(--admin-sub)]"><X size={24} /></button>
          </div>

          <nav className="flex-1 p-4 space-y-1 overflow-y-auto no-scrollbar">
            <div className="text-xs font-bold text-[var(--admin-sub)] uppercase tracking-wider mb-3 px-4 mt-2">Studio</div>
            <NavLink href="/admin" title="ƒêi t·ªõi trang T·ªïng quan" icon={<LayoutDashboard size={20} />} label="T·ªïng quan" isActive={pathname === '/admin'} onClick={handleLinkClick} />
            <NavCalendarWidget rooms={rooms} />
            <NavLink href="/admin/projects" title="Qu·∫£n l√Ω d·ª± √°n" icon={<ImageIcon size={20} />} label="D·ª± √°n" isActive={pathname === '/admin/projects' || pathname === '/admin/projects/new' || pathname.startsWith('/admin/projects/')} onClick={handleLinkClick} />
            <NavLink href="/admin/grid" title="B·ªë c·ª•c Portfolio" icon={<LayoutTemplate size={20} />} label="B·ªë c·ª•c Portfolio" isActive={pathname.startsWith('/admin/grid')} onClick={handleLinkClick} />
            {userProfile?.role === 'Admin' && (
              <>
                <NavLink href="/admin/staff" title="Qu·∫£n l√Ω nh√¢n s·ª±" icon={<Users size={20} />} label="Nh√¢n s·ª±" isActive={pathname.startsWith('/admin/staff')} onClick={handleLinkClick} />
              </>
            )}
          </nav>

          <div className="p-4 border-t border-[var(--admin-border)] space-y-2">
            {userProfile?.role === 'Admin' && (
              <>
                <div className="text-xs font-bold text-[var(--admin-sub)] uppercase tracking-wider mt-8 mb-3 px-4">H·ªá th·ªëng</div>
                <NavLink href="/admin/settings" title="C√†i ƒë·∫∑t chung" icon={<Settings size={20} />} label="C√†i ƒë·∫∑t chung" isActive={pathname.startsWith('/admin/settings')} onClick={handleLinkClick} />
              </>
            )}
            <Link href="/" className="flex items-center gap-3 px-4 py-3 w-full text-sm font-medium text-[var(--admin-sub)] hover:bg-[var(--admin-bg)] hover:text-[var(--admin-fg)] rounded-lg transition-colors"><Home size={20} /> Xem Website</Link>
            <button onClick={() => setShowModal(true)} className="flex cursor-pointer items-center gap-3 px-4 py-3 w-full text-left text-sm font-medium text-red-500 hover:bg-red-500/10 rounded-lg transition-colors"><LogOut size={20} /> ƒêƒÉng xu·∫•t</button>
          </div>
        </aside>

        <div className="flex-1 flex flex-col min-w-0 overflow-hidden">
          <header className="h-16 bg-[var(--admin-card)]/80 backdrop-blur-md border-b border-[var(--admin-border)] flex items-center justify-between px-4 md:px-8 sticky top-0 z-30">
            <div className="flex items-center gap-4">
              <button onClick={() => setIsMobileMenuOpen(true)} className="md:hidden p-2 -ml-2 text-[var(--admin-sub)] rounded-lg"><Menu size={24} /></button>
              <h1 className="font-semibold text-lg text-[var(--admin-fg)] hidden sm:block">{getPageTitle(pathname)}</h1>
            </div>

            <div className="flex items-center gap-3 md:gap-4">
              <div className="hidden sm:flex items-center gap-2 px-3 py-1.5 bg-[var(--admin-bg)] border border-[var(--admin-border)] rounded-full text-xs font-mono font-medium text-[var(--admin-sub)]" title="T·ª± ƒë·ªông ƒëƒÉng xu·∫•t n·∫øu kh√¥ng ho·∫°t ƒë·ªông">
                <Clock size={14} className="text-[var(--admin-primary)] animate-pulse" />
                <span>{timeLeft}</span>
              </div>
              <div className="h-6 w-px bg-[var(--admin-border)] hidden sm:block"></div>
              <ThemeToggle isAdmin={true}/>
              <div className="flex items-center gap-3 pl-2">
                  <div className="hidden md:block text-sm text-right">
                    <p className="font-medium text-[var(--admin-fg)] leading-tight">
                      {userProfile?.full_name || 'ƒêang t·∫£i...'}
                    </p>
                    <p className="text-[10px] text-[var(--admin-sub)] uppercase tracking-wider">
                      {userProfile?.role || '...'}
                    </p>
                  </div>
                  <div className="h-9 w-9 rounded-full bg-gradient-to-br from-[var(--admin-primary)] to-purple-600 border-2 border-[var(--admin-card)] shadow-sm flex items-center justify-center text-white font-bold text-xs">
                    {getInitials(userProfile?.full_name)}
                  </div>
                </div>
            </div>
          </header>

          <main className="flex-1 p-4 md:p-8 overflow-auto table-scrollbar">
            <ConfirmModal isOpen={showModal} onClose={() => setShowModal(false)} onConfirm={handleLogout} title="ƒêƒÉng xu·∫•t?" description="B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?" confirmText="ƒêƒÉng xu·∫•t" cancelText="H·ªßy b·ªè" variant="danger" />
            <div className="mx-auto max-w-7xl animate-fade-in-up">{children}</div>
          </main>
        </div>
      </div>
    </CalendarProvider>
  );
}

function NavLink({ href, icon, label, isActive, onClick, title }: NavLinkProps & { title?: string }) {
  return (
    <Link href={href} onClick={onClick} title={title} className={`flex items-center gap-3 px-4 py-2.5 text-sm font-medium rounded-lg transition-all duration-200 mb-1 ${isActive ? 'bg-[var(--admin-bg)] text-[var(--admin-primary)] shadow-md shadow-gray-500/20' : 'text-[var(--admin-sub)] hover:bg-[var(--admin-hover)] hover:text-[var(--admin-fg)]'}`}>{icon}{label}</Link>
  );
}

function getPageTitle(pathname: string) {
  if (pathname === '/admin') return 'B·∫£ng t·ªïng quan';
  if (pathname.startsWith('/admin/grid')) return 'B·ªë c·ª•c Portfolio';
  if (pathname.startsWith('/admin/projects')) return 'Qu·∫£n l√Ω D·ª± √°n';
  if (pathname.startsWith('/admin/staff')) return 'Nh√¢n s·ª±';
  if (pathname.startsWith('/admin/settings')) return 'C√†i ƒë·∫∑t h·ªá th·ªëng';
  return 'B·∫£ng ƒëi·ªÅu khi·ªÉn';
}
```

## File: src/app/thoi-trang/page.tsx
```typescript
import React from 'react';
import { getProjects } from '@/lib/actions';
import { Metadata } from 'next';
import Container from '@/components/Container';
import ProjectMasonryGrid from '@/components/ProjectMasonryGrid';

export const metadata: Metadata = {
  title: 'D·ª± √°n Th·ªùi Trang | Oni Studio',
  description: 'C√°c d·ª± √°n editorial, lookbook v√† nhi·∫øp ·∫£nh th·ªùi trang.',
};

export const revalidate = 3600; // 1 hour
export default async function FashionPage() {
  const projects = await getProjects('thoi-trang'); // <-- Slug c·ªßa danh m·ª•c

  return (
    <Container className="min-h-screen bg-[var(--background)] pt-32 pb-20 px-4 md:px-8">
      <div className="max-w-8xl mx-auto">
        
        <div className="mb-16">
          <h1 className="text-4xl md:text-6xl font-bold text-[var(--foreground)] tracking-tighter mb-4">
            Th·ªùi Trang
          </h1>
          <p className="text-[var(--sub-text)] text-lg max-w-xl">
            Kh√°m ph√° c√°c d·ª± √°n th·ªùi trang, lookbook v√† editorial.
          </p>
        </div>

        {projects.length === 0 && (
          <div className="py-20 text-center text-[var(--sub-text)] border-y border-[var(--foreground)]/10">
            Ch∆∞a c√≥ d·ª± √°n n√†o trong danh m·ª•c n√†y.
          </div>
        )}

      <ProjectMasonryGrid projects={projects} variant="staggered" />

      </div>
    </Container>
  );
}
```

## File: src/app/thuong-mai/page.tsx
```typescript
import React from 'react';
import { getProjects } from '@/lib/actions';
import { Metadata } from 'next';
import Container from '@/components/Container';
import ProjectMasonryGrid from '@/components/ProjectMasonryGrid';

export const metadata: Metadata = {
  title: 'D·ª± √°n Th∆∞∆°ng m·∫°i | Oni Studio',
  description: 'C√°c d·ª± √°n Commercial, Editorial v√† Lookbook th·ª±c hi·ªán b·ªüi Oni Studio.',
};
export const revalidate = 3600; // 1 hour
export default async function CommercialPage() {
  const projects = await getProjects('thuong-mai'); // <-- Slug c·ªßa danh m·ª•c

  return (
    <Container className="min-h-screen bg-[var(--background)] pt-32 pb-20 px-4 md:px-8">
      <div className="max-w-8xl mx-auto">
        
        <div className="mb-16">
          <h1 className="text-4xl md:text-6xl font-bold text-[var(--foreground)] tracking-tighter mb-4">
            Th∆∞∆°ng m·∫°i
          </h1>
          <p className="text-[var(--sub-text)] text-lg max-w-xl">
            Nh·ªØng chi·∫øn d·ªãch qu·∫£ng c√°o v√† b·ªô ·∫£nh th∆∞∆°ng m·∫°i ƒë∆∞·ª£c th·ª±c hi·ªán v·ªõi s·ª± ch·ªân chu v√† s√°ng t·∫°o.
          </p>
        </div>

        {projects.length === 0 && (
          <div className="py-20 text-center text-[var(--sub-text)] border-y border-[var(--foreground)]/10">
            Ch∆∞a c√≥ d·ª± √°n n√†o trong danh m·ª•c n√†y.
          </div>
        )}

        {/* Project Grid */}
        <ProjectMasonryGrid projects={projects} variant="flat" />
      </div>
    </Container>
  );
}
```

## File: src/app/page.tsx
```typescript
// src/app/page.tsx

import type { Metadata } from 'next';
import HomePageContent from '@/components/HomePageContent';
export const revalidate = 3600; // 1 hour
export const metadata: Metadata = {
  title: 'Oni Studio',
  description: 'Oni Studio - Chuy√™n cung c·∫•p d·ªãch v·ª• nhi·∫øp ·∫£nh th∆∞∆°ng m·∫°i, th·ªùi trang, v√† c√° nh√¢n chuy√™n nghi·ªáp. Kh√°m ph√° portfolio v√† li√™n h·ªá ƒë·ªÉ h·ª£p t√°c.',
  keywords: ['nhi·∫øp ·∫£nh gia', 'photographer', 'commercial photography', 'fashion photography', 'Oni Studio'],

  openGraph: {
    title: 'Oni Studio',
    description: 'Kh√°m ph√° portfolio ·∫£nh th∆∞∆°ng m·∫°i, th·ªùi trang, v√† c√° nh√¢n t·ª´ Oni Studio.',
    url: 'https://www.your-domain.com', 
    siteName: 'Oni Studio',
    images: [
      {
        url: 'https://www.your-domain.com/og-image.png', 
        width: 1200,
        height: 630,
      },
    ],
    locale: 'vi_VN',
    type: 'website',
  },

  twitter: {
    card: 'summary_large_image',
    title: 'Oni Studio | Nhi·∫øp ·∫£nh Th∆∞∆°ng m·∫°i & Th·ªùi trang Chuy√™n nghi·ªáp',
    description: 'Kh√°m ph√° portfolio ·∫£nh th∆∞∆°ng m·∫°i, th·ªùi trang, v√† c√° nh√¢n t·ª´ Oni Studio.',
    images: ['https://www.your-domain.com/twitter-image.png'], 
  },
};

export default function HomePage() {
  return (
    <HomePageContent />
  );
}
```

## File: package.json
```json
{
  "name": "photographer-portfolio",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint",
    "deploy": "cross-env NEXT_PUBLIC_IS_GH_PAGES=true next build"
  },
  "dependencies": {
    "@dnd-kit/core": "^6.3.1",
    "@dnd-kit/sortable": "^10.0.0",
    "@dnd-kit/utilities": "^3.2.2",
    "@supabase/ssr": "^0.7.0",
    "@supabase/supabase-js": "^2.81.1",
    "clsx": "^2.1.1",
    "date-fns": "^4.1.0",
    "lucide-react": "^0.554.0",
    "moment": "^2.30.1",
    "motion": "^12.23.24",
    "next": "^16.1.1",
    "next-themes": "^0.4.6",
    "react": "^19.2.3",
    "react-big-calendar": "^1.19.4",
    "react-dom": "^19.2.3",
    "react-intersection-observer": "^9.16.0",
    "react-type-animation": "^3.2.0",
    "recharts": "^3.5.0",
    "sonner": "^2.0.7",
    "tailwind-merge": "^3.3.1",
    "yet-another-react-lightbox": "^3.25.0"
  },
  "devDependencies": {
    "@eslint/eslintrc": "^3",
    "@tailwindcss/postcss": "^4",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-big-calendar": "^1.16.3",
    "@types/react-dom": "^19",
    "cross-env": "^10.1.0",
    "eslint": "^9",
    "eslint-config-next": "15.5.4",
    "gh-pages": "^6.3.0",
    "tailwindcss": "^4",
    "typescript": "^5"
  }
}
```

## File: src/app/globals.css
```css
@import "tailwindcss";
@import "yet-another-react-lightbox/styles.css";
@import "yet-another-react-lightbox/plugins/captions.css";
@import "yet-another-react-lightbox/plugins/thumbnails.css";
/* src/app/globals.css */

:root {
  /* Chuy·ªÉn t·ª´ hex sang c√°c gi√° tr·ªã RGB (kh√¥ng c√≥ 'rgb()' ) */
  --background: #f4f4f4;
  --foreground: #171717;
  --sub-text: #555555;
  --glow-color: #aa9f9f;
  --gradient-color-1: #f9fafb; /* gray-50 */
  --gradient-color-2: #f3f4f6; /* gray-100 */
  --gradient-color-3: #f9fafb; /* gray-50 */
  --to-linear: #dadada;
  --from-linear: #ebebeb;

  /* === ADMIN THEME (LIGHT MODE - Modern Slate) === */
  --admin-bg: #f8fafc;          /* Slate-50: N·ªÅn t·ªïng th·ªÉ s√°ng, h∆°i xanh nh·∫π */
  --admin-card: #ffffff;        /* White: N·ªÅn th·∫ª */
  --admin-fg: #0f172a;          /* Slate-900: Ch·ªØ ch√≠nh ƒë·∫≠m */
  --admin-sub: #64748b;         /* Slate-500: Ch·ªØ ph·ª• */
  --admin-border: #e2e8f0;      /* Slate-200: Vi·ªÅn nh·∫°t */
  --admin-primary: #4f46e5;     /* Indigo-600: M√†u ch·ªß ƒë·∫°o (Button/Active) */
  --admin-primary-fg: #ffffff;  /* Ch·ªØ tr√™n n·ªÅn ch·ªß ƒë·∫°o */
  --admin-hover: #f1f5f9;       /* Slate-100: M√†u khi hover */
  --admin-edit: #EBF6FF;        /* bg-blue-50: M√†u n·ªÅn √¥ edit */
  --admin-delete: #FFE5E5;      /* bg-red-50: M√†u n·ªÅn √¥ x√≥a */
  --admin-ot: #f97316;       /* Orange-500 */
  --admin-ot-bg: #fff7ed;    /* Orange-50 */
  --admin-ot-border: #fdba74;/* Orange-300 */
  --status-checked-in: #22c55e; /* Green-500 */
  --status-completed: #64748b
}

html.dark { 
    /* --- M√ÄU C∆† B·∫¢N --- */
    --background: #1E201E; /* M√†u n·ªÅn ch√≠nh (M√†u 1) */
    --foreground: #f4f4f4; /* M√†u ch·ªØ ch√≠nh (M√†u 4) - T∆∞∆°ng ph·∫£n t·ªët tr√™n n·ªÅn t·ªëi */
    --sub-text: #9CA3AF;   /* M√†u ch·ªØ ph·ª•: Pha gi·ªØa Sage v√† Beige ƒë·ªÉ d·ªÖ ƒë·ªçc h∆°n m√†u #697565 g·ªëc */
    
    /* Hi·ªáu ·ª©ng Glow/Shadow: D√πng m√†u Sage Green nh∆∞ng t·ªëi h∆°n */
    --glow-color: #697565; 

    /* Gradient: Chuy·ªÉn t·ª´ n·ªÅn ch√≠nh sang n·ªÅn th·∫ª */
    --gradient-color-1: #1E201E; 
    --gradient-color-2: #2D2E2B; /* M√†u trung gian pha gi·ªØa M√†u 1 v√† 2 */
    --gradient-color-3: #3C3D37; 
    
    --to-linear: #1E201E;
    --from-linear: #3C3D37;

    /* --- ADMIN DASHBOARD --- */

    /* N·ªÅn t·ªïng th·ªÉ c·ªßa trang Admin */
    --admin-bg: #1E201E; 

    /* N·ªÅn c·ªßa c√°c kh·ªëi/th·∫ª (Card) */
    --admin-card: #3C3D37; /* (M√†u 2) */

    /* M√†u ch·ªØ ch√≠nh trong Admin */
    --admin-fg: #f4f4f4; /* (M√†u 4) */

    /* M√†u ch·ªØ ph·ª•/Label/Icon √≠t quan tr·ªçng */
    --admin-sub: #AAB3A6; /* Phi√™n b·∫£n s√°ng h∆°n c·ªßa #697565 ƒë·ªÉ ƒë·∫£m b·∫£o ƒë·ªçc ƒë∆∞·ª£c tr√™n n·ªÅn #3C3D37 */

    /* Vi·ªÅn ngƒÉn c√°ch: D√πng m√†u Sage Green g·ªëc */
    --admin-border: #697565; /* (M√†u 3) */

    /* Hi·ªáu ·ª©ng Hover: S√°ng h∆°n n·ªÅn th·∫ª m·ªôt ch√∫t */
    --admin-hover: #4B4C46; 

    /* --- N√öT B·∫§M CH√çNH (PRIMARY) --- */
    /* D√πng m√†u Beige s√°ng nh·∫•t ƒë·ªÉ l√†m n√∫t n·ªïi b·∫≠t tr√™n n·ªÅn t·ªëi */
    --admin-primary: #f4f4f4; 
    --admin-primary-fg: #1E201E; /* Ch·ªØ tr√™n n√∫t ph·∫£i l√† m√†u t·ªëi nh·∫•t ƒë·ªÉ d·ªÖ ƒë·ªçc */

    /* --- C√ÅC TR·∫†NG TH√ÅI (STATUS / ACTIONS) --- */
    /* ƒêi·ªÅu ch·ªânh c√°c m√†u n√†y tr·∫ßm xu·ªëng (desaturated) ƒë·ªÉ h·ª£p v·ªõi theme Earth Tone */

    /* N√∫t Edit: M√†u xanh ƒë√° (Slate/Teal) tr·∫ßm */
    --admin-edit: #3A4A45;  

    /* N√∫t Delete: M√†u ƒë·ªè g·∫°ch/ƒë·ªè ƒë·∫•t (Brick Red) thay v√¨ ƒë·ªè t∆∞∆°i */
    --admin-delete: #5C2B2B;  

    /* OT / Warning: M√†u cam ƒë·∫•t (Ochre/Burnt Orange) */
    --admin-ot: #D98E53;       /* M√†u ch·ªØ/icon OT */
    --admin-ot-bg: #2C2520;    /* N·ªÅn th·∫ª OT (pha cam v√†o n·ªÅn ƒëen) */
    --admin-ot-border: #8C5E35; /* Vi·ªÅn th·∫ª OT */

    /* Status Checked-in: D√πng ch√≠nh m√†u Sage Green c·ªßa palette nh∆∞ng t∆∞∆°i h∆°n x√≠u */
    --status-checked-in: #84A98C; 

    /* Status Completed: M√†u x√°m ·∫•m */
    --status-completed: #8E8E86; 
}

html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  background: var(--background);
  font-family: Arial, Helvetica, sans-serif;
  scroll-behavior: smooth;
}

/* MAIN WRAPPER */
main {
  width: 100%;
  /* overflow-x: hidden; */
}

/* FOOTER */
footer {
  will-change: opacity, transform;
}

/* KEYFRAMES CHO HI·ªÜU ·ª®NG */
@keyframes ken-burns {
  0% {
    transform: scale(1) translate(0, 0);
    filter: brightness(1);
  }
  100% {
    transform: scale(1.1) translate(-1%, 1%);
    filter: brightness(0.95);
  }
}

@keyframes fade-in-up {
  0% {
    opacity: 0;
    transform: translateY(20px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

/* CLASS TI·ªÜN √çCH */
.ken-burns-effect {
  /* Hi·ªáu ·ª©ng ch·∫°y trong 25 gi√¢y, l·∫∑p l·∫°i v√¥ h·∫°n v√† lu√¢n phi√™n */
  animation: ken-burns 25s ease-in-out infinite alternate;
}

.animate-fade-in-up {
  /* Hi·ªáu ·ª©ng xu·∫•t hi·ªán trong 1.2 gi√¢y, c√≥ ƒë·ªô tr·ªÖ 0.3 gi√¢y */
  animation: fade-in-up 1.2s ease-out 0.3s forwards;
  opacity: 0; /* Tr·∫°ng th√°i ban ƒë·∫ßu tr∆∞·ªõc khi animation b·∫Øt ƒë·∫ßu */
}

.text-shadow-md {
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
}


.menu-link-glow {
  transition: text-shadow 0.3s ease-out;
  will-change: text-shadow;
  text-shadow: 0 0 0 var(--glow-color);
}

.menu-link-glow:hover {
  text-shadow: 0 0 10px var(--glow-color), 0 0 20px var(--glow-color), 0 0 30px var(--glow-color);
}

/* === CSS CHO N·ªÄN CHUY·ªÇN ƒê·ªòNG (SECTION 3) === */

/* 2. Keyframes (Gi·ªØ nguy√™n) */
@keyframes moveGradient {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

/* 3. Class animation (Ch·ªâ c·∫ßn 1 class duy nh·∫•t) */
.animated-gradient {
  /* D√πng 2 bi·∫øn m√†u ƒë√£ ƒë·ªãnh nghƒ©a ·ªü tr√™n */
  background-image: linear-gradient(
    -45deg,
    var(--gradient-color-1),
    var(--gradient-color-2),
    var(--gradient-color-3)
  );
  background-size: 200% 200%;
  animation: moveGradient 5s ease-in-out infinite;
}


/* === CSS CHO BRAND SCROLLER (M·ªöI) === */
@keyframes infinite-scroll {
  from {
    transform: translateX(0);
  }
  to {
    transform: translateX(-100%);
  }
}

.animate-infinite-scroll {
  /* T·ªëc ƒë·ªô 40s. B·∫°n c√≥ th·ªÉ ƒëi·ªÅu ch·ªânh 40s th√†nh s·ªë kh√°c ƒë·ªÉ nhanh/ch·∫≠m h∆°n */
  animation: infinite-scroll 40s linear infinite;
}

/* === THANH CU·ªòN TINH T·∫æ === */

/* √Åp d·ª•ng cho Firefox */
html {
  /* 1. M√†u c·ªßa Thumb (v·ªã tr√≠) - D√πng m√†u glow-color c·ªßa b·∫°n */
  scrollbar-color: var(--glow-color) var(--background);
  /* 2. Chi·ªÅu r·ªông thanh cu·ªôn */
  scrollbar-width: thin;
}

/* √Åp d·ª•ng cho Chrome, Safari, Edge */

/* 1. Chi·ªÅu r·ªông thanh cu·ªôn */
body::-webkit-scrollbar {
  width: 8px;
}

/* 2. M√†u c·ªßa Track (ƒë∆∞·ªùng ch·∫°y) - ƒê·ªìng m√†u v·ªõi n·ªÅn */
body::-webkit-scrollbar-track {
  background: transparent;
}

/* 3. M√†u c·ªßa Thumb (v·ªã tr√≠) - D√πng m√†u c·ªßa b·∫°n */
body::-webkit-scrollbar-thumb {
  background-color: var(--foreground);
  border-radius: 4px;
}

/* 4. TƒÉng ƒë·ªô ƒë·∫≠m khi hover l√™n thanh cu·ªôn */
body::-webkit-scrollbar-thumb:hover {
  background-color: #ededed; /* T√πy ch·ªânh m√†u ƒë·∫≠m h∆°n n·∫øu mu·ªën */
}

/* HTML: <div class="loader"></div> */
.loader {
  width: 50px;
  aspect-ratio: 1;
  display: grid;
  border: 4px solid #0000;
  border-radius: 50%;
  border-right-color: #25b09b;
  animation: l15 1s infinite linear;
}
.loader::before,
.loader::after {    
  content: "";
  grid-area: 1/1;
  margin: 2px;
  border: inherit;
  border-radius: 50%;
  animation: l15 2s infinite;
}
.loader::after {
  margin: 8px;
  animation-duration: 3s;
}
@keyframes l15{ 
  100%{transform: rotate(1turn)}
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fade-in-row {
  /* opacity ban ƒë·∫ßu l√† 0 ƒë·ªÉ tr√°nh b·ªã nh√°y */
  opacity: 0; 
  /* forwards gi√∫p gi·ªØ tr·∫°ng th√°i cu·ªëi c√πng (opacity: 1) sau khi ch·∫°y xong */
  animation: fadeInUp 1s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

@layer utilities {
  /* ·∫®n thanh cu·ªôn cho Chrome, Safari and Opera */
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  /* ·∫®n thanh cu·ªôn cho IE, Edge and Firefox */
  .no-scrollbar {
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
  }

  /* Class d√†nh ri√™ng cho b·∫£ng */
  .table-scrollbar {
    /* H·ªó tr·ª£ Firefox (b·∫Øt bu·ªôc ph·∫£i c√≥ d√≤ng n√†y Firefox m·ªõi hi·ªán custom) */
    scrollbar-width: thin;
    scrollbar-color: var(--admin-sub) transparent;
  }

  /* Chrome, Edge, Safari */
  .table-scrollbar::-webkit-scrollbar {
    height: 8px; /* Chi·ªÅu cao cho thanh ngang */
    width: 8px;  /* Chi·ªÅu r·ªông cho thanh d·ªçc */
  }

  .table-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .table-scrollbar::-webkit-scrollbar-thumb {
    /* D√πng background-clip ƒë·ªÉ t·∫°o c·∫£m gi√°c thumb c√≥ padding */
    background-color: var(--admin-sub); 
    border-radius: 20px;
    border: 2px solid transparent; /* T·∫°o kho·∫£ng h·ªü xung quanh thumb */
    background-clip: content-box; 
  }

  .table-scrollbar::-webkit-scrollbar-thumb:hover {
    background-color: var(--admin-fg);
  }
}

/* === GOOGLE CALENDAR RESOURCE VIEW OVERRIDES === */

/* 1. Header C·ªôt Ph√≤ng (Day View) */
.rbc-time-header-content {
  border-left: 1px solid var(--admin-border) !important;
  background-color: var(--admin-card);
}

.rbc-resource-header-cell {
  /* Style cho t√™n ph√≤ng tr√™n ƒë·∫ßu c·ªôt */
  padding: 12px 0 !important;
  color: var(--admin-fg) !important;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* M√†u ri√™ng cho t·ª´ng c·ªôt ph√≤ng (Optional: T·∫°o hi·ªáu ·ª©ng xen k·∫Ω) */
.rbc-day-slot {
  background-color: var(--admin-card);
  transition: background-color 0.2s;
}
.rbc-day-slot:hover {
  background-color: var(--admin-bg); /* Highlight nh·∫π khi r√™ chu·ªôt v√†o c·ªôt ph√≤ng */
}
.rbc-events-container:hover {
  background-color: var(--admin-bg)/20; /* ƒê·ªìng b·ªô v·ªõi ph·∫ßn khung gi·ªù */
}

/* 2. Grid & Lines */
.rbc-timeslot-group {
  border-bottom: none !important; /* B·ªè vi·ªÅn th·ª´a gi·ªØa c√°c khung gi·ªù */
  min-height: 50px !important; /* Chi·ªÅu cao m·ªói gi·ªù, ƒë·ªß r·ªông ƒë·ªÉ hi·ªÉn th·ªã th√¥ng tin */
}

.rbc-time-content {
  border-top: none !important; /* B·ªè vi·ªÅn th·ª´a */
}

.rbc-time-gutter .rbc-timeslot-group {
  border-bottom: none !important; /* C·ªôt gi·ªù b√™n tr√°i s·∫°ch s·∫Ω */
}

/* 3. S·ª± ki·ªán (Event Box) */
.rbc-event {
  border: none !important;
  padding: 0 !important;
  margin: 1px 2px !important; /* C√°ch l·ªÅ m·ªôt ch√∫t cho ƒë·∫πp */
  border-radius: 4px !important;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  transition: transform 0.1s, z-index 0.1s;
  z-index: 50 !important;
}

.rbc-event:hover {
  transform: scale(1.02); /* Ph√≥ng to nh·∫π khi hover s·ª± ki·ªán */
  z-index: 50 !important;
  box-shadow: 0 4px 8px rgba(0,0,0,0.15);
}

/* 4. Current Time Indicator (V·∫°ch ƒë·ªè ch·ªâ gi·ªù) */
.rbc-current-time-indicator {
  background-color: #ea4335 !important;
  height: 2px !important;
}

/* 5. ·∫®n c√°c ph·∫ßn th·ª´a */
.rbc-header {
  /* ·∫®n header ng√†y th√°ng m·∫∑c ƒë·ªãnh v√¨ trong Resource View ta quan t√¢m t√™n ph√≤ng h∆°n */
  /* Ho·∫∑c gi·ªØ l·∫°i n·∫øu mu·ªën hi·ªán c·∫£ Th·ª© ng√†y + T√™n ph√≤ng */
  border-bottom: none !important; 
}
.rbc-allday-cell {
  /* T√πy ch·ªçn: ·∫®n d√≤ng All Day n·∫øu √≠t d√πng ƒë·ªÉ ti·∫øt ki·ªám di·ªán t√≠ch */
  display: none; 
}
.rbc-time-view-resources .rbc-time-gutter, .rbc-time-view-resources .rbc-time-header-gutter {
  background-color: var(--admin-card) !important;
}

.rbc-today {
  background-color: var(--admin-card) !important;
}



.rbc-time-view{
  border: none !important;
}

.rbc-day-slot .rbc-time-slot{
  border: none !important;
}

.rbc-timeslot-group{
  border-top: 1px solid var(--admin-border);
}



/* 1. ·∫®n label c·ªßa √¥ ƒë·∫ßu ti√™n (00:00) */
.rbc-time-gutter .rbc-timeslot-group:first-child .rbc-label {
    display: none; /* Ho·∫∑c visibility: hidden; */
}

.rbc-time-slot .rbc-label {
  position: relative;
}

.rbc-label .rbc-time-header-gutter{
  min-width: 37.55px;
}
.rbc-label {
  width: 100%;
  position: absolute;
  top: -14px;
  background-color: var(--admin-card);
  font-size: 0.65em; 
  font-weight: 700;
  z-index: 10;
}

.rbc-time-view-resources .rbc-time-gutter, .rbc-time-view-resources .rbc-time-header-gutter{
  border-right: 1px solid var(--admin-border) !important;
}
.rbc-time-header-content > .rbc-row.rbc-row-resources {
  border-bottom: 1px solid var(--admin-border) !important;
}
.rbc-time-content > * + * > * {
  border-left: 1px solid var(--admin-border) !important;
}
.rbc-time-header-content > .rbc-row.rbc-row-resource {
  border-bottom: 1px solid var(--admin-border) !important;
}
.rbc-time-header.rbc-overflowing {
  border-right: none !important;
}


/* 1. Target v√†o container ch·ª©a n·ªôi dung l·ªãch */
.rbc-time-content::-webkit-scrollbar {
    width: 3px; /* ƒê·ªô r·ªông thanh cu·ªôn (nh·ªè g·ªçn) */
    height: 3px; /* ƒê·ªô cao thanh cu·ªôn ngang (n·∫øu c√≥) */
}

/* 2. Ph·∫ßn r√£nh (Track) - N·ªÅn c·ªßa thanh cu·ªôn */
.rbc-time-content::-webkit-scrollbar-track {
    background: transparent; /* ƒê·ªÉ trong su·ªët cho ƒë·∫πp */
    /* Ho·∫∑c d√πng m√†u: background: var(--admin-bg); */
}

/* 3. Ph·∫ßn tay c·∫ßm (Thumb) - C√°i c·ª•c ƒë·ªÉ k√©o */
.rbc-time-content::-webkit-scrollbar-thumb {
    background-color: var(--admin-border); /* M√†u x√°m nh·∫π */
    border-radius: 10px; /* Bo tr√≤n 2 ƒë·∫ßu */
}

/* 4. Hi·ªáu ·ª©ng khi di chu·ªôt v√†o tay c·∫ßm */
.rbc-time-content::-webkit-scrollbar-thumb:hover {
    background-color: var(--admin-sub); /* ƒê·∫≠m h∆°n ch√∫t khi hover */
}
```
